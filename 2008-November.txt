From ml at jvh.net  Sat Nov  1 20:59:13 2008
From: ml at jvh.net (Jorge Van Hemelryck)
Date: Sat, 1 Nov 2008 20:59:13 +0100
Subject: repeated rfkill events on ASUS L5800C bcm4303 without rfkill switch
Message-ID: <20081101205913.28258800.ml@jvh.net>

Hello,

Since I switched to the b43legacy driver, after ndiswrapper stopped
working, I've managed to make wireless work again, but it seems to be
quite slow, or connections sometimes fail, and messages are issued
about once every second (see attachment enabled-disabled.txt).

It also prevents me from using keyboard repetition, as if each event
acted as pressing a key, stopping the repetition sequence.

The output of uname, lspci and dmesg is in attachment info.txt.

I have tried to have a look at the driver code, and all I found was
where the message was. But I couldn't find where the event comes from.
Or I didn't have the courage to look for it, as I don't have any kernel
programming experience.

Anyway, my Asus L5800C has no hardware rfkill switch, at least none of
the buttons acted like one when I used ndiswrapper. I'm wondering what
the state change every second (with each polling) means.

Could you please help me ? I'd be glad to try a patch if you tell me
what to change.

-- 
Jorge Van Hemelryck


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: enabled-disabled.txt
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081101/e38aed28/attachment.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: info.txt
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081101/e38aed28/attachment-0001.txt>

From peterskurt at msn.com  Sat Nov  1 22:04:14 2008
From: peterskurt at msn.com (KURT PETERS)
Date: Sat, 01 Nov 2008 14:04:14 -0700
Subject: B43 STILL randomly and silently dropping connections...
In-Reply-To: <200810231940.15231.mb@bu3sch.de>
Message-ID: <BAY103-F3505CCF9E2F035A21A3CCCD8230@phx.gbl>

Haven't heard from you... I looked through wireshark and can't see how I'd 
use it to monitor the wireless airwaves like you suggested.  I'm still 
looking forward to SOME kind of directions for use from you.
Kurt

----Original Message Follows----
From: Michael Buesch <mb at bu3sch.de>
To: "KURT PETERS" <peterskurt at msn.com>
CC: bcm43xx-dev at lists.berlios.de, gavron at wetwork.net
Subject: Re: B43 STILL randomly and silently dropping connections...
Date: Thu, 23 Oct 2008 19:40:15 +0200

On Thursday 23 October 2008 19:36:32 KURT PETERS wrote:
 > If you wanted to go over the specific suggested setup for wireshark, I'd 
be
 > happy to implement it.  I don't know wireshark, so if you could eliminate
 > the learning curve, I'd be happy to take the data.

Just setup your testbed like the time you noticed the bug.
Now add an additional machine, put it into monitor mode and
let wireshark listen on the channels where the bug happens.
Reproduce the bug now.

--
Greetings Michael.




From solca at guug.org  Sun Nov  2 16:24:46 2008
From: solca at guug.org (Otto Solares)
Date: Sun, 2 Nov 2008 09:24:46 -0600
Subject: B43 STILL randomly and silently dropping connections...
In-Reply-To: <BAY103-F3505CCF9E2F035A21A3CCCD8230@phx.gbl>
References: <200810231940.15231.mb@bu3sch.de>
	<BAY103-F3505CCF9E2F035A21A3CCCD8230@phx.gbl>
Message-ID: <20081102152446.GG5398@guug.org>

On Sat, Nov 01, 2008 at 02:04:14PM -0700, KURT PETERS wrote:
> Haven't heard from you... I looked through wireshark and can't see how I'd 
> use it to monitor the wireless airwaves like you suggested.  I'm still 
> looking forward to SOME kind of directions for use from you.

Kurt,

What Michael was suggesting you is that _you_ intercept the packets as
they travel in the air when the bug is being reproduced.

It can be done in several ways, I suggest you:

1. Find another box (laptop) with WLAN adapter supported under Linux.
2. Put the above WLAN adapter in monitor mode, same channel as your
network:
   # iwconfig <iface> mode monitor channel <channel>
3. Capture the packets:
   # tshark -n -i <mon_iface> -s 65536 -w /tmp/capture.dmp
4. Reproduce the bug or error in the original box.
5. Upload the capture.dmp file somewhere and post the URL here.

If you can't do this simple steps please find your way somewhere else
and come back when you're ready with a capture file.

-otto


From peterskurt at msn.com  Mon Nov  3 15:05:07 2008
From: peterskurt at msn.com (KURT PETERS)
Date: Mon, 03 Nov 2008 07:05:07 -0700
Subject: Bcm43xx-dev Digest, Vol 29, Issue 3
In-Reply-To: <mailman.41.1225710085.4713.bcm43xx-dev@lists.berlios.de>
Message-ID: <BAY103-F36EB0A2EA6186ADE70E572D81D0@phx.gbl>

Otto, Thanks for the response.  Unfortunately, my only other available 
machine is a windows XP machine.  Therefore, I am not able to do an ifconfig 
to monitor the interface. Sorry, I should have emphasized that more in 
previous emails (although I did mention it was a windows machine).  So... 
you're right, I'm better off not trying to help out and let you developers 
continue to do what you're doing.  Good luck.

Kurt


Subject: Re: B43 STILL randomly and silently dropping connections...


On Sat, Nov 01, 2008 at 02:04:14PM -0700, KURT PETERS wrote:
 > Haven't heard from you... I looked through wireshark and can't see how 
I'd
 > use it to monitor the wireless airwaves like you suggested.  I'm still
 > looking forward to SOME kind of directions for use from you.

Kurt,

What Michael was suggesting you is that _you_ intercept the packets as
they travel in the air when the bug is being reproduced.

It can be done in several ways, I suggest you:

1. Find another box (laptop) with WLAN adapter supported under Linux.
2. Put the above WLAN adapter in monitor mode, same channel as your
network:
    # iwconfig <iface> mode monitor channel <channel>
3. Capture the packets:
    # tshark -n -i <mon_iface> -s 65536 -w /tmp/capture.dmp
4. Reproduce the bug or error in the original box.
5. Upload the capture.dmp file somewhere and post the URL here.

If you can't do this simple steps please find your way somewhere else
and come back when you're ready with a capture file.

-otto




From johannes at sipsolutions.net  Thu Nov  6 13:16:13 2008
From: johannes at sipsolutions.net (Johannes Berg)
Date: Thu, 06 Nov 2008 13:16:13 +0100
Subject: b43: Everybody with PHY TX error, please try
In-Reply-To: <200810242032.04295.mb@bu3sch.de>
	(sfid-20081024_203730_616101_C9986446)
References: <200810242032.04295.mb@bu3sch.de>
	(sfid-20081024_203730_616101_C9986446)
Message-ID: <1225973773.3619.216.camel@johannes.berg>

On Fri, 2008-10-24 at 20:32 +0200, Michael Buesch wrote:

> Try to reproduce the PHY TX error with the new firmware.

This helped neither with the PHY TX errors nor with the RX errors where
I'm getting invalid frames passed up from the firmware and run into a
WARN_ON:

drivers/net/wireless/b43/xmit.c:49
(b43_plcp_get_bitrate_idx_cck)

johannes
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081106/d68d5e7a/attachment.pgp>

From przemekkulczycki at gmail.com  Thu Nov  6 13:46:55 2008
From: przemekkulczycki at gmail.com (Przemek Kulczycki)
Date: Thu, 6 Nov 2008 12:46:55 +0000
Subject: b43: Everybody with PHY TX error, please try
In-Reply-To: <200810242032.04295.mb@bu3sch.de>
References: <200810242032.04295.mb@bu3sch.de>
Message-ID: <fe1e5a8c0811060446u4d171283t4c6cda924abcc299@mail.gmail.com>

On Fri, Oct 24, 2008 at 6:32 PM, Michael Buesch <mb at bu3sch.de> wrote:
> Everybody with PHY TX error, please try updated firmware from
> ftp://ftp.linksys.com/opensourcecode/wrt610n/1.00.00.018/wrt610n_v1.00.00.018_us.tgz
> (Yeah, big tarball. It's 87MB)
>
> Extract the file wrt610n_v1.00.00.018_us/release/src/wl/linux/wl.o out of the archive.
> Get latest b43-tools:
> git clone http://git.bu3sch.de/git/b43-tools.git
>
> Build and install fwcutter from latest b43-tools.git
>
> Extract the firmware from the wl.o file:
> b43-fwcutter --unsupported -w /lib/firmware/DESTPATH  wl.o
>
> Try to reproduce the PHY TX error with the new firmware.

If this tarball is so large then maybe downloading latest ubuntu
restricted modules will be faster.
http://packages.ubuntu.com/intrepid/linux-restricted-modules-2.6.27-7-generic
AFAIK this package contains the proprietary Broadcom WL driver so the
latest firmware might be in it too.

-- 
## Przemys?aw Kulczycki >><< Azrael Nightwalker ##
# jabber: azrael[na]jabster.pl | tlen: azrael29a #
### www: http://reksio.ftj.agh.edu.pl/~azrael/ ###

From johannes at sipsolutions.net  Thu Nov  6 14:15:16 2008
From: johannes at sipsolutions.net (Johannes Berg)
Date: Thu, 06 Nov 2008 14:15:16 +0100
Subject: b43: Everybody with PHY TX error, please try
In-Reply-To: <fe1e5a8c0811060446u4d171283t4c6cda924abcc299@mail.gmail.com>
	(sfid-20081106_135434_305717_BB318651)
References: <200810242032.04295.mb@bu3sch.de>
	<fe1e5a8c0811060446u4d171283t4c6cda924abcc299@mail.gmail.com>
	(sfid-20081106_135434_305717_BB318651)
Message-ID: <1225977316.3619.221.camel@johannes.berg>

On Thu, 2008-11-06 at 12:46 +0000, Przemek Kulczycki wrote:
> On Fri, Oct 24, 2008 at 6:32 PM, Michael Buesch <mb at bu3sch.de> wrote:
> > Everybody with PHY TX error, please try updated firmware from
> > ftp://ftp.linksys.com/opensourcecode/wrt610n/1.00.00.018/wrt610n_v1.00.00.018_us.tgz
> > (Yeah, big tarball. It's 87MB)

> If this tarball is so large then maybe downloading latest ubuntu
> restricted modules will be faster.
> http://packages.ubuntu.com/intrepid/linux-restricted-modules-2.6.27-7-generic
> AFAIK this package contains the proprietary Broadcom WL driver so the
> latest firmware might be in it too.

No, not at all.

johannes
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081106/c4e39d5f/attachment.pgp>

From illth at gmx.de  Thu Nov  6 14:28:23 2008
From: illth at gmx.de (Thomas Ilnseher)
Date: Thu, 06 Nov 2008 14:28:23 +0100
Subject: b43: Everybody with PHY TX error, please try
In-Reply-To: <fe1e5a8c0811060446u4d171283t4c6cda924abcc299@mail.gmail.com>
References: <200810242032.04295.mb@bu3sch.de>
	<fe1e5a8c0811060446u4d171283t4c6cda924abcc299@mail.gmail.com>
Message-ID: <1225978104.6350.7.camel@pcmik05.zmk.uni-kl.de>


Am Donnerstag, den 06.11.2008, 12:46 +0000 schrieb Przemek Kulczycki:
> On Fri, Oct 24, 2008 at 6:32 PM, Michael Buesch <mb at bu3sch.de> wrote:
> > Everybody with PHY TX error, please try updated firmware from
> > ftp://ftp.linksys.com/opensourcecode/wrt610n/1.00.00.018/wrt610n_v1.00.00.018_us.tgz
> > (Yeah, big tarball. It's 87MB)
> >
This is some source code for a router with embedded mips cpu
> > Extract the file wrt610n_v1.00.00.018_us/release/src/wl/linux/wl.o out of the archive.
> > Get latest b43-tools:
> > git clone http://git.bu3sch.de/git/b43-tools.git
> >
> > Build and install fwcutter from latest b43-tools.git
> >
> > Extract the firmware from the wl.o file:
> > b43-fwcutter --unsupported -w /lib/firmware/DESTPATH  wl.o
> >
> > Try to reproduce the PHY TX error with the new firmware.
> 
> If this tarball is so large then maybe downloading latest ubuntu
> restricted modules will be faster.
> http://packages.ubuntu.com/intrepid/linux-restricted-modules-2.6.27-7-generic
> AFAIK this package contains the proprietary Broadcom WL driver
which is for x86. 
>  so the
> latest firmware might be in it too.
These are two totally different wl.o files. it will not work with x86
proprietary wl.(k)o driver.

> 
-- 
Thomas Ilnseher <illth at gmx.de>



From EforeZZ at gmail.com  Wed Nov 12 11:52:55 2008
From: EforeZZ at gmail.com (EforeZZ)
Date: Wed, 12 Nov 2008 12:52:55 +0200
Subject: chip settings
Message-ID: <cc2a6eec0811120252p3e8fb30eoe9a67e6b01d64a8c@mail.gmail.com>

Hi guys,

We're trying to write a broadcom WiFi driver for FreeBSD.
We looked at M$ Windows driver and found these structures..
We'd be very grateful if anyone tells the standard and/or description
of what these values may mean..

struct _locale_info_t
{
   unsigned char   valid_channels[28];
   struct radar_channels;
   struct restricted_channels;
   unsigned char   maxpwr[6];
   unsigned char   pub_maxpwr[5];
   unsigned char   flags;
};

struct _locale_info_t _locale_b = {
   { 254, 63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0},
   _chanvec_none,
   _chanvec_none,
   { 76, 76, 76, 76, 76, 76 },
   { 20, 20, 20, 0, 0 },
   1 };

struct _locale_info_t _locale_13 = {
   {0, 0, 0, 0, 16, 17, 17, 17, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0 }
   _radar_set1,
   _chanvec_none,
   { 84, 84, 84, 0, 0, 0 },
   { 23, 23, 0, 0, 0 },
   3 };

struct _locale_info_t _locale_15 = {
   { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0 },
   _chanvec_none,
   _chanvec_none,
   { 0, 0, 0, 0, 0, 0 },
   { 0, 0, 0, 0, 0 },
   0 };

struct _locale_mimo_info_t
{
   unsigned char   val[32];
};

struct _locale_mimo_info_t _locale_fn = {
   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 16, 0, 0, 0 };

struct _locale_mimo_info_t _locale_15n = {
   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 16, 0, 0, 0 };


struct _country_info_t
{
   unsigned char         abbrev[4];
   struct _locate_info_t      locale_2G;
   struct _locate_info_t      locale_5G;
   struct _locale_mimo_info_t   locale_mimo_2G;
   struct _locale_mimo_info_t   locale_mimo_5G;
} cntry_locales[] =
{
{'UA', _locale_b, _locale_15, _locale_fn, _locale_15n},
{'UA1', _locale_b, _locale_13, _locale_fn, _locale_15n},
};

-- 
Best regards,
EforeZZ


From celejar at gmail.com  Thu Nov 13 09:26:29 2008
From: celejar at gmail.com (Celejar)
Date: Thu, 13 Nov 2008 03:26:29 -0500
Subject: 4318 in AP mode
Message-ID: <20081113032629.467e6a01.celejar@gmail.com>

Hi,

AP mode is listed as working
(http://linuxwireless.org/en/users/Drivers/b43):

Working

...

# Access Point mode (not quite yet, blocked by proper support in mac80211 and hostapd) 

but I can't even put my 4318 into AP mode:

~# iwconfig eth0 mode master
Error for wireless request "Set Mode" (8B06) :
    SET failed on device eth0 ; Invalid argument.

The card works fine in managed and monitor mode.  Am I doing something
wrong, or is the webpage incorrect for the 4318?  What does "not quite
yet" mean anyway?

Celejar
--
mailmin.sourceforge.net - remote access via secure (OpenPGP) email
ssuds.sourceforge.net - A Simple Sudoku Solver and Generator



From ccmcphe at verizon.net  Thu Nov 13 20:10:01 2008
From: ccmcphe at verizon.net (Tex)
Date: Thu, 13 Nov 2008 14:10:01 -0500
Subject: Stack trace on a 4318 CF
Message-ID: <491C7B89.90109@verizon.net>

I am getting stack traces (see below) on my broadcom 4318 card, they are 
always started off at b43/xmit.c:76 (function  
b43_plcp_get_bitrate_idx_ofdm) and mac80211/rx.c:2183 (function 
__ieee80211_rx) both are hitting the WARN_ON macro references.  Does 
anyone know why this may be happening? It doesn't seem to cause any trouble.

The code blocks are:

__ieee802111_rx:
 if (!sband ||
            status->rate_idx < 0 ||
            status->rate_idx >= sband->n_bitrates) {
                WARN_ON(1);
                return;
        }

and

xmit.c:
        case 0xB:
                return base + 0;
        case 0xF:
                return base + 1;
        case 0xA:
                return base + 2;
        case 0xE:
                return base + 3;
        case 0x9:
                return base + 4;
        case 0xD:
                return base + 5;
        case 0x8:
                return base + 6;
        case 0xC:
                return base + 7;
        }
        B43_WARN_ON(1);
        return -1;

I am using Linux 2.6.26 on an ARM processor. The uname -m is armv5tel, 
uname -r is 2.6.26.
lspcmcia info is:
root at nomad:~$ pccardctl info
PRODID_1="Broadcom"
PRODID_2="802.11g SC CF"
PRODID_3="4.0"
PRODID_4=""
MANFID=02d0,0448
FUNCID=6





Nov 13 12:52:15 nomad user.warn kernel: WARNING: at 
drivers/net/wireless/b43/xmit.c:76 b43_rx+0x544/0x644 [b43]()
Nov 13 12:52:15 nomad user.warn kernel: Modules linked in: b43 arc4 ssb 
rng_core mac80211 cfg80211 pxa2xx_cs pxa2xx_core
Nov 13 12:52:15 nomad user.warn kernel: [<c002d250>] 
(dump_stack+0x0/0x14) from [<c00433ac>] (warn_on_slowpath+0x4c/0x68)
Nov 13 12:52:15 nomad user.warn kernel: [<c0043360>] 
(warn_on_slowpath+0x0/0x68) from [<bf11160c>] (b43_rx+0x544/0x644 [b
Nov 13 12:52:15 nomad user.warn kernel:  r6:00000002 r5:00000000 r4:00000001
Nov 13 12:52:15 nomad user.warn kernel: [<bf1110c8>] (b43_rx+0x0/0x644 
[b43]) from [<bf119520>] (b43_pio_rx_work+0x418/0x
Nov 13 12:52:15 nomad user.warn kernel: [<bf119108>] 
(b43_pio_rx_work+0x0/0x470 [b43]) from [<c0053fd8>] (run_workqueue+0
Nov 13 12:52:15 nomad user.warn kernel: [<c0053f2c>] 
(run_workqueue+0x0/0x160) from [<c0054afc>] (worker_thread+0xa4/0x12
Nov 13 12:52:15 nomad user.warn kernel:  r6:c7518e40 r5:c7518e48 r4:c62e8000
Nov 13 12:52:15 nomad user.warn kernel: [<c0054a58>] 
(worker_thread+0x0/0x128) from [<c0057b5c>] (kthread+0x50/0x7c)
Nov 13 12:52:15 nomad user.warn kernel:  r7:00000000 r6:00000000 
r5:c0054a58 r4:fffffffc
Nov 13 12:52:15 nomad user.warn kernel: [<c0057b0c>] (kthread+0x0/0x7c) 
from [<c0046a80>] (do_exit+0x0/0x6c8)
Nov 13 12:52:15 nomad user.warn kernel:  r5:00000000 r4:00000000
Nov 13 12:52:15 nomad user.warn kernel: ---[ end trace 2c396510d06afaac ]---
Nov 13 12:52:15 nomad user.warn kernel: ------------[ cut here ]------------
Nov 13 12:52:15 nomad user.warn kernel: WARNING: at 
net/mac80211/rx.c:2183 __ieee80211_rx+0x1a8/0x58c [mac80211]()
Nov 13 12:52:15 nomad user.warn kernel: Modules linked in: b43 arc4 ssb 
rng_core mac80211 cfg80211 pxa2xx_cs pxa2xx_core
Nov 13 12:52:15 nomad user.warn kernel: [<c002d250>] 
(dump_stack+0x0/0x14) from [<c00433ac>] (warn_on_slowpath+0x4c/0x68)
Nov 13 12:52:15 nomad user.warn kernel: [<c0043360>] 
(warn_on_slowpath+0x0/0x68) from [<bf0df114>] (__ieee80211_rx+0x1a8/
Nov 13 12:52:15 nomad user.warn kernel:  r6:c7c6ed80 r5:c7c6ed80 r4:c62e9e40
Nov 13 12:52:15 nomad user.warn kernel: [<bf0def6c>] 
(__ieee80211_rx+0x0/0x58c [mac80211]) from [<bf0ccb94>] (ieee80211_t
Nov 13 12:52:15 nomad user.warn kernel: [<bf0ccab8>] 
(ieee80211_tasklet_handler+0x0/0x14c [mac80211]) from [<c0048c6c>] (
Nov 13 12:52:15 nomad user.warn kernel: [<c0048bf4>] 
(tasklet_action+0x0/0xf4) from [<c0048b10>] (__do_softirq+0x70/0xe0)
Nov 13 12:52:15 nomad user.warn kernel:  r6:0000000a r5:c0346c0c r4:00000005
Nov 13 12:52:15 nomad user.warn kernel: [<c0048aa0>] 
(__do_softirq+0x0/0xe0) from [<c0048ec8>] (irq_exit+0x48/0x50)
Nov 13 12:52:15 nomad user.warn kernel: [<c0048e80>] (irq_exit+0x0/0x50) 
from [<c0028048>] (__exception_text_start+0x48/0
Nov 13 12:52:15 nomad user.warn kernel: [<c0028000>] 
(__exception_text_start+0x0/0x5c) from [<c0028710>] (__irq_svc+0x30/
Nov 13 12:52:15 nomad user.warn kernel: Exception stack(0xc62e9ef0 to 
0xc62e9f38)
Nov 13 12:52:15 nomad user.warn kernel: 
9ee0:                                     00000001 c62e8000 00000002 
60000013
Nov 13 12:52:15 nomad user.warn kernel: 9f00: 00000001 c62196e0 000005f2 
c7c6ed80 c62e6400 000005f4 00000026 c62e9f84
- messages 1/110 0%

Thanks much
Tex



From mb at bu3sch.de  Thu Nov 13 21:15:54 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Thu, 13 Nov 2008 21:15:54 +0100
Subject: Stack trace on a 4318 CF
In-Reply-To: <491C7B89.90109@verizon.net>
References: <491C7B89.90109@verizon.net>
Message-ID: <200811132115.55073.mb@bu3sch.de>

On Thursday 13 November 2008 20:10:01 Tex wrote:
> I am getting stack traces (see below) on my broadcom 4318 card, they are 
> always started off at b43/xmit.c:76 (function  
> b43_plcp_get_bitrate_idx_ofdm) and mac80211/rx.c:2183 (function 
> __ieee80211_rx) both are hitting the WARN_ON macro references.  Does 
> anyone know why this may be happening? It doesn't seem to cause any trouble.

A fix is merged into the current development kernel.
Please ignore the messages. They do not indicate any problem.


-- 
Greetings Michael.


From artem.v.antonov at gmail.com  Thu Nov 13 21:22:53 2008
From: artem.v.antonov at gmail.com (Artem Antonov)
Date: Thu, 13 Nov 2008 23:22:53 +0300
Subject: 4318 in AP mode
In-Reply-To: <20081113032629.467e6a01.celejar@gmail.com>
References: <20081113032629.467e6a01.celejar@gmail.com>
Message-ID: <6bc534830811131222t95b03c2u7901fa5a364753da@mail.gmail.com>

You need latest version of b43 & mac80211 (from wireless-testing.git)
and latest version of hostapd. And it'll be working %)

2008/11/13, Celejar <celejar at gmail.com>:
> Hi,
>
>  AP mode is listed as working
>  (http://linuxwireless.org/en/users/Drivers/b43):
>
>  Working
>
>  ...
>
>  # Access Point mode (not quite yet, blocked by proper support in mac80211 and hostapd)
>
>  but I can't even put my 4318 into AP mode:
>
>  ~# iwconfig eth0 mode master
>  Error for wireless request "Set Mode" (8B06) :
>     SET failed on device eth0 ; Invalid argument.
>
>  The card works fine in managed and monitor mode.  Am I doing something
>  wrong, or is the webpage incorrect for the 4318?  What does "not quite
>  yet" mean anyway?
>
>  Celejar
>
> --
>  mailmin.sourceforge.net - remote access via secure (OpenPGP) email
>  ssuds.sourceforge.net - A Simple Sudoku Solver and Generator
>
>  _______________________________________________
>  Bcm43xx-dev mailing list
>  Bcm43xx-dev at lists.berlios.de
>  https://lists.berlios.de/mailman/listinfo/bcm43xx-dev
>


From ccmcphe at verizon.net  Thu Nov 13 22:05:32 2008
From: ccmcphe at verizon.net (Tex)
Date: Thu, 13 Nov 2008 16:05:32 -0500
Subject: Stack trace on a 4318 CF
In-Reply-To: <200811132115.55073.mb@bu3sch.de>
References: <491C7B89.90109@verizon.net> <200811132115.55073.mb@bu3sch.de>
Message-ID: <491C969C.8030603@verizon.net>

Michael Buesch wrote:
> On Thursday 13 November 2008 20:10:01 Tex wrote:
>   
>> I am getting stack traces (see below) on my broadcom 4318 card, they are 
>> always started off at b43/xmit.c:76 (function  
>> b43_plcp_get_bitrate_idx_ofdm) and mac80211/rx.c:2183 (function 
>> __ieee80211_rx) both are hitting the WARN_ON macro references.  Does 
>> anyone know why this may be happening? It doesn't seem to cause any trouble.
>>     
>
> A fix is merged into the current development kernel.
> Please ignore the messages. They do not indicate any problem.
>
>
>   
Oh great, thanks. I didn't think it was a problem. I guess I can comment 
out the WARN_ON macro calls, because my logs after a few days gets filled?

Thanks again
Tex

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081113/cedaa339/attachment.html>

From celejar at gmail.com  Fri Nov 14 05:21:30 2008
From: celejar at gmail.com (Celejar)
Date: Thu, 13 Nov 2008 23:21:30 -0500
Subject: 4318 in AP mode
In-Reply-To: <873ahv7stg.fsf@litku.valot.fi>
References: <20081113032629.467e6a01.celejar@gmail.com>
	<873ahv7stg.fsf@litku.valot.fi>
Message-ID: <20081113232130.49985f93.celejar@gmail.com>

On Thu, 13 Nov 2008 13:45:31 +0200
Kalle Valo <kalle.valo at iki.fi> wrote:

> Celejar <celejar at gmail.com> writes:
> 
> > AP mode is listed as working
> > (http://linuxwireless.org/en/users/Drivers/b43):
> >
> > Working
> >
> > ...
> >
> > # Access Point mode (not quite yet, blocked by proper support in mac80211 and hostapd) 
> >
> > but I can't even put my 4318 into AP mode:
> >
> > ~# iwconfig eth0 mode master
> > Error for wireless request "Set Mode" (8B06) :
> >     SET failed on device eth0 ; Invalid argument.
> >
> > The card works fine in managed and monitor mode.  Am I doing something
> > wrong, or is the webpage incorrect for the 4318?  What does "not quite
> > yet" mean anyway?
> 
> You have to use hostapd. I have succesfully used b43 in Master mode
> with latest wireless-testing and hostapd git trees.

Thank you (and Artem).  I've built hostapd, and it seems to be running
fine, but I'm having trouble connecting to it with my client.  I'm not
sure whether the problem is on the hostapd box, or at the client end,
since I'm experimenting with openwrt, and trying to use a wireless
router as a client, something that I haven't tried before.

This is the hostapd output:

$ sudo ./hostapd hostapd.conf 
Configuration file: hostapd.conf
Failed to update rate sets in kernel module
Could not set passive scanning: Unknown error 4294967295
Mode: IEEE 802.11g  Channel: 5  Frequency: 2432 MHz
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
Using interface eth0 with hwaddr 3e:90:0e:0d:46:d0 and ssid 'test'
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
eth0: STA 00:22:15:53:42:17 IEEE 802.11: authenticated
eth0: STA 00:22:15:53:42:17 IEEE 802.11: associated (aid 1, accounting session 491CF261-00000000)

Does this look right?

The client scans and sees the AP, and it sends arp requests.  Using
tcpdump on the hostapd box, I see the incoming arp requests and
outgoing replies, but they don't seem to be received on the client.

On the hostapd box:

22:46:02.917415 arp who-has 192.168.4.2 tell 192.168.4.1
22:46:02.918551 CF +QoS arp reply 192.168.4.2 is-at 3e:90:0e:0d:46:d0 (oui Unknown)
22:46:04.118528 arp who-has 192.168.4.2 tell 192.168.4.1
22:46:04.118559 CF +QoS arp reply 192.168.4.2 is-at 3e:90:0e:0d:46:d0 (oui Unknown)
22:46:05.317371 arp who-has 192.168.4.2 tell 192.168.4.1
22:46:05.317403 CF +QoS arp reply 192.168.4.2 is-at 3e:90:0e:0d:46:d0 (oui Unknown)
22:46:06.517367 arp who-has 192.168.4.2 tell 192.168.4.1
22:46:06.517398 CF +QoS arp reply 192.168.4.2 is-at 3e:90:0e:0d:46:d0 (oui Unknown)

etc ...

On the client, I get no responses, and the arp table shows that the
address of the hostapd box has not been resolved (it shows as all 0s),
although ifconfig shows that some data is indeed passing through the
interface (I don't yet have tcpdump installed on the router):

wl0       Link encap:Ethernet  HWaddr 00:22:15:53:42:17  
          inet addr:192.168.4.1  Bcast:192.168.4.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:391 errors:0 dropped:0 overruns:0 frame:23049
          TX packets:231 errors:37 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:37339 (36.4 KiB)  TX bytes:17514 (17.1 KiB)
          Interrupt:2 Base address:0x5000

[Incidentally, this is a Broadcom system with Broadcom wireless, but I
haven't yet managed to boot a 2.6 version of openwrt, to test b43 on
it.]

I have no idea whether I'm doing something wrong on the hostapd box or
at the client side.  When I gain access to some more of my hardware,
I'll try mixing and matching clients and aps to pin down the location
of the problem.  Any suggestions are of course appreciated.

Thanks again.

> Kalle Valo

Celejar
--
mailmin.sourceforge.net - remote access via secure (OpenPGP) email
ssuds.sourceforge.net - A Simple Sudoku Solver and Generator



From celejar at gmail.com  Fri Nov 14 08:22:46 2008
From: celejar at gmail.com (Celejar)
Date: Fri, 14 Nov 2008 02:22:46 -0500
Subject: Problems with b43 and ath5k when used together
Message-ID: <20081114022246.ddd36609.celejar@gmail.com>

This may not be the most useful bug report, but I'm just going to put
this out there for the record.  My 4318 occasionally goes fubar; it
fails to function, with the syslog showing continual association
followed by immediate disassociation:

Nov 14 01:36:09 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:09 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:09 lizzie kernel: eth0: authenticated
Nov 14 01:36:09 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
Nov 14 01:36:09 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
Nov 14 01:36:09 lizzie kernel: eth0: associated
Nov 14 01:36:09 lizzie kernel: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
Nov 14 01:36:09 lizzie kernel: eth0: disassociating by local choice (reason=3)
Nov 14 01:36:10 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:10 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:10 lizzie kernel: eth0: authenticated
Nov 14 01:36:10 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
Nov 14 01:36:10 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
Nov 14 01:36:10 lizzie kernel: eth0: associated
Nov 14 01:36:10 lizzie kernel: eth0: disassociating by local choice (reason=3)
Nov 14 01:36:11 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:11 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:11 lizzie kernel: eth0: authenticated
Nov 14 01:36:11 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
Nov 14 01:36:11 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
Nov 14 01:36:11 lizzie kernel: eth0: associated
Nov 14 01:36:11 lizzie kernel: eth0: disassociating by local choice (reason=3)
Nov 14 01:36:12 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:12 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
Nov 14 01:36:12 lizzie kernel: eth0: authenticated
Nov 14 01:36:12 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
Nov 14 01:36:12 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
Nov 14 01:36:12 lizzie kernel: eth0: associated
Nov 14 01:36:12 lizzie kernel: eth0: disassociating by local choice (reason=3)

etc.

Eventually, the interface vanished entirely; ifconfig showed the
wmaster0, but no eth0.

I'm not sure that this is relevant, but my system has two mac80211
cards, both an internal 4318, which works with b43, and a PCMCIA
Atheros card, which works (somewhat) with ath5k.  The above problems
occurred when I was using both of them simultaneously, and repeatedly
bringing them up and down, connecting to several different APs.

Celejar
--
mailmin.sourceforge.net - remote access via secure (OpenPGP) email
ssuds.sourceforge.net - A Simple Sudoku Solver and Generator



From netrolller.3d at gmail.com  Fri Nov 14 14:50:48 2008
From: netrolller.3d at gmail.com (=?ISO-8859-1?Q?Stefanik_G=E1bor?=)
Date: Fri, 14 Nov 2008 14:50:48 +0100
Subject: Problems with b43 and ath5k when used together
In-Reply-To: <20081114022246.ddd36609.celejar@gmail.com>
References: <20081114022246.ddd36609.celejar@gmail.com>
Message-ID: <69e28c910811140550u1b1c80a2s1141ef934abad89e@mail.gmail.com>

On Fri, Nov 14, 2008 at 8:22 AM, Celejar <celejar at gmail.com> wrote:
> This may not be the most useful bug report, but I'm just going to put
> this out there for the record.  My 4318 occasionally goes fubar; it
> fails to function, with the syslog showing continual association
> followed by immediate disassociation:
>
> Nov 14 01:36:09 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:09 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:09 lizzie kernel: eth0: authenticated
> Nov 14 01:36:09 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
> Nov 14 01:36:09 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
> Nov 14 01:36:09 lizzie kernel: eth0: associated
> Nov 14 01:36:09 lizzie kernel: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
> Nov 14 01:36:09 lizzie kernel: eth0: disassociating by local choice (reason=3)
> Nov 14 01:36:10 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:10 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:10 lizzie kernel: eth0: authenticated
> Nov 14 01:36:10 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
> Nov 14 01:36:10 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
> Nov 14 01:36:10 lizzie kernel: eth0: associated
> Nov 14 01:36:10 lizzie kernel: eth0: disassociating by local choice (reason=3)
> Nov 14 01:36:11 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:11 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:11 lizzie kernel: eth0: authenticated
> Nov 14 01:36:11 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
> Nov 14 01:36:11 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
> Nov 14 01:36:11 lizzie kernel: eth0: associated
> Nov 14 01:36:11 lizzie kernel: eth0: disassociating by local choice (reason=3)
> Nov 14 01:36:12 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:12 lizzie kernel: eth0: authenticate with AP 00:22:15:53:42:17
> Nov 14 01:36:12 lizzie kernel: eth0: authenticated
> Nov 14 01:36:12 lizzie kernel: eth0: associate with AP 00:22:15:53:42:17
> Nov 14 01:36:12 lizzie kernel: eth0: RX ReassocResp from 00:22:15:53:42:17 (capab=0x411 status=0 aid=1)
> Nov 14 01:36:12 lizzie kernel: eth0: associated
> Nov 14 01:36:12 lizzie kernel: eth0: disassociating by local choice (reason=3)
>
> etc.
>
> Eventually, the interface vanished entirely; ifconfig showed the
> wmaster0, but no eth0.
>
> I'm not sure that this is relevant, but my system has two mac80211
> cards, both an internal 4318, which works with b43, and a PCMCIA
> Atheros card, which works (somewhat) with ath5k.  The above problems
> occurred when I was using both of them simultaneously, and repeatedly
> bringing them up and down, connecting to several different APs.
>
> Celejar
> --
> mailmin.sourceforge.net - remote access via secure (OpenPGP) email
> ssuds.sourceforge.net - A Simple Sudoku Solver and Generator
>
> _______________________________________________
> Bcm43xx-dev mailing list
> Bcm43xx-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/bcm43xx-dev
>

This looks like something on your end - b43 should never get
ethX-style IDs, they should be wlanX.

-- 
Vista: [V]iruses, [I]ntruders, [S]pyware, [T]rojans and [A]dware. :-)


From Larry.Finger at lwfinger.net  Fri Nov 14 15:35:36 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Fri, 14 Nov 2008 08:35:36 -0600
Subject: Problems with b43 and ath5k when used together
In-Reply-To: <69e28c910811140550u1b1c80a2s1141ef934abad89e@mail.gmail.com>
References: <20081114022246.ddd36609.celejar@gmail.com>
	<69e28c910811140550u1b1c80a2s1141ef934abad89e@mail.gmail.com>
Message-ID: <491D8CB8.8040807@lwfinger.net>

Stefanik G?bor wrote:
>
> 
> This looks like something on your end - b43 should never get
> ethX-style IDs, they should be wlanX.

That would be the renaming rules in /etc/udev/rules.d/. All of my systems name
the b43 hardware to eth1, and use wlanX for my USB devices.

Larry


From celejar at gmail.com  Fri Nov 14 16:35:25 2008
From: celejar at gmail.com (Celejar)
Date: Fri, 14 Nov 2008 10:35:25 -0500
Subject: Problems with b43 and ath5k when used together
In-Reply-To: <491D8CB8.8040807@lwfinger.net>
References: <20081114022246.ddd36609.celejar@gmail.com>
	<69e28c910811140550u1b1c80a2s1141ef934abad89e@mail.gmail.com>
	<491D8CB8.8040807@lwfinger.net>
Message-ID: <20081114103525.6e30d27e.celejar@gmail.com>

On Fri, 14 Nov 2008 08:35:36 -0600
Larry Finger <Larry.Finger at lwfinger.net> wrote:

> Stefanik G?bor wrote:
> >
> > 
> > This looks like something on your end - b43 should never get
> > ethX-style IDs, they should be wlanX.
> 
> That would be the renaming rules in /etc/udev/rules.d/. All of my systems name
> the b43 hardware to eth1, and use wlanX for my USB devices.

Yes.  I learned this the hard way, when I switched from bcm43xx to
b43.  The posts of you and others on this list and elsewhere helped me
figure it out.

> Larry

Celejar
--
mailmin.sourceforge.net - remote access via secure (OpenPGP) email
ssuds.sourceforge.net - A Simple Sudoku Solver and Generator



From yuval at avramzon.net  Sat Nov 15 17:00:57 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sat, 15 Nov 2008 18:00:57 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
Message-ID: <200811151801.02369.yuval@avramzon.net>

Hi,

I am having the following situation:
System starts fine, b43 module loaded (firmware installed instructions), and 
wireless works fine. After I start X, I get:
b43-phy0: Radio hardware status changed to DISABLED
wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range

and wireless just stops. All future attempts to start it (rmmod/modprobe) 
fails.

See below the workflow, let me know if there is any info missing, or something 
you think I should try to debug this issue.
I'll be yhager on #bcm-users as well.

Thanks!

Versions info:
-------------
# uname -a
Linux happy 2.6.27-gentoo-r2 #3 SMP Sat Nov 15 15:00:40 IST 2008 i686 VIA C7-M 
Processor 1600MHz CentaurHauls GNU/Linux

# lspci -vvn|grep 43 -A7
00:00.4 0600: 1106:4364
        Subsystem: 103c:3030
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- 
Stepping- SERR- FastB2B- DisINTx-
        Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- 
<TAbort- <MAbort- >SERR- <PERR- INTx-
        Latency: 0

00:00.5 0800: 1106:5364 (prog-if 20 [IO(X)-APIC])
        Subsystem: 103c:3030
--
02:00.0 0280: 14e4:4312 (rev ff) (prog-if ff)
        !!! Unknown header type 7f
        Kernel driver in use: b43-pci-bridge
        Kernel modules: ssb

07:03.0 0200: 14e4:169c (rev 03)
        Subsystem: 14e4:969c
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- 
Stepping- SERR+ FastB2B- DisINTx-
        Status: Cap+ 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- 
<TAbort- <MAbort- >SERR- <PERR- INTx-
        Latency: 64 (16000ns min), Cache Line Size: 32 bytes

Before running X:
----------------

# lsmod|grep b43
b43                   117660  0
rfkill                 16536  3 rfkill_input,b43
mac80211              122896  1 b43
led_class              12036  1 b43
input_polldev          11912  1 b43
ssb                    42500  1 b43
pcmcia                 38316  2 b43,ssb
pcmcia_core            39316  3 b43,ssb,pcmcia
firmware_class         15112  3 b43,pcmcia,qla2xxx

# iwconfig wlan0
wlan0     IEEE 802.11bg  ESSID:"NETGEAR"
          Mode:Managed  Frequency:2.412 GHz  Access Point: 00:22:3F:18:89:5E
          Bit Rate=54 Mb/s   Tx-Power=27 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality=83/100  Signal level:-52 dBm  Noise level=-73 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

# cat /proc/interrupts

           CPU0
  0:     271998   IO-APIC-edge      timer
  1:          8   IO-APIC-edge      i8042
  8:          2   IO-APIC-edge      rtc
  9:       2796   IO-APIC-fasteoi   acpi
 12:        132   IO-APIC-edge      i8042
 14:          0   IO-APIC-edge      ide0
 15:          0   IO-APIC-edge      ide1
 16:      29161   IO-APIC-fasteoi   eth0
 17:        503   IO-APIC-fasteoi   HDA Intel
 20:          0   IO-APIC-fasteoi   uhci_hcd:usb2
 21:      11085   IO-APIC-fasteoi   sata_via, ehci_hcd:usb1, uhci_hcd:usb3
 23:          0   IO-APIC-fasteoi   uhci_hcd:usb4
 24:      28003   IO-APIC-fasteoi   b43
NMI:          0   Non-maskable interrupts
LOC:       2098   Local timer interrupts
RES:          0   Rescheduling interrupts
CAL:          0   function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
SPU:          0   Spurious interrupts
ERR:          0
MIS:          0

relevant portion of dmesg:

b43-pci-bridge 0000:02:00.0: PCI INT A -> GSI 24 (level, low) -> IRQ 24
b43-pci-bridge 0000:02:00.0: setting latency timer to 64
b43-phy0: Broadcom 4311 WLAN found
input: b43-phy0 as /class/input/input8
firmware: requesting b43/ucode13.fw
firmware: requesting b43/b0g0initvals13.fw
b43-phy0: Loading firmware version 410.2160 (2007-05-26 15:32:10)
b43-pci-bridge 0000:02:00.0: PCI: Disallowing DAC for device
b43-phy0: DMA mask fallback from 64-bit to 32-bit
Registered led device: b43-phy0::tx
Registered led device: b43-phy0::rx
Registered led device: b43-phy0::radio
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticated
wlan0: associate with AP 00:22:3f:18:89:5e
wlan0: RX AssocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
wlan0: associated
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticated
wlan0: associate with AP 00:22:3f:18:89:5e
wlan0: RX ReassocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
wlan0: associated


After running X:
---------------

b43-phy0: Radio hardware status changed to DISABLED
wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range

and:

# iwconfig wlan0
wlan0     IEEE 802.11bg  ESSID:"NETGEAR"
          Mode:Managed  Frequency:2.412 GHz  Access Point: Not-Associated
          Tx-Power=27 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality:0  Signal level:0  Noise level:0
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

so I try:

# /etc/init.d/net.wlan0 restart
 * Caching service dependencies ...                                                                                   
[ ok ]
 * Stopping wlan0
 *   Bringing down wlan0
 *     Stopping dhcpcd on wlan0 ...                                                                                   
[ ok ]
 *     Shutting down wlan0 ...                                                                                        
[ ok ]
 * Starting wlan0
SIOCSIFFLAGS: No such device
SIOCSIFFLAGS: No such device
SIOCSIFFLAGS: No such device
 *   Configuring wireless network for wlan0
 *   Failed to configure wireless for wlan0                                                                           
[ !! ]

something is different in /proc/interrupts:

# cat /proc/interrupts
           CPU0
  0:     370543   IO-APIC-edge      timer
  1:         70   IO-APIC-edge      i8042
  8:          2   IO-APIC-edge      rtc
  9:       3720   IO-APIC-fasteoi   acpi
 12:        132   IO-APIC-edge      i8042
 14:          0   IO-APIC-edge      ide0
 15:          0   IO-APIC-edge      ide1
 16:      42430   IO-APIC-fasteoi   eth0
 17:        503   IO-APIC-fasteoi   HDA Intel
 20:          0   IO-APIC-fasteoi   uhci_hcd:usb2
 21:      11736   IO-APIC-fasteoi   sata_via, ehci_hcd:usb1, uhci_hcd:usb3
 23:          0   IO-APIC-fasteoi   uhci_hcd:usb4
 24:      34154   IO-APIC-fasteoi
NMI:          0   Non-maskable interrupts
LOC:       2098   Local timer interrupts
RES:          0   Rescheduling interrupts
CAL:          0   function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
SPU:          0   Spurious interrupts
ERR:          0
MIS:          0

full dmesg output below:

# dmesg
gsi_base[0])
IOAPIC[0]: apic_id 1, version 3, address 0xfec00000, GSI 0-23
ACPI: IOAPIC (id[0x02] address[0xfecc0000] gsi_base[24])
IOAPIC[1]: apic_id 2, version 3, address 0xfecc0000, GSI 24-47
ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)
ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 low level)
ACPI: IRQ0 used by override.
ACPI: IRQ2 used by override.
ACPI: IRQ9 used by override.
Enabling APIC mode:  Flat.  Using 2 I/O APICs
Using ACPI (MADT) for SMP configuration information
SMP: Allowing 1 CPUs, 0 hotplug CPUs
mapped APIC to ffffb000 (fee00000)
mapped IOAPIC to ffffa000 (fec00000)
mapped IOAPIC to ffff9000 (fecc0000)
PM: Registered nosave memory: 000000000009f000 - 00000000000a0000
PM: Registered nosave memory: 00000000000a0000 - 00000000000e3000
PM: Registered nosave memory: 00000000000e3000 - 0000000000100000
Allocating PCI resources starting at 70000000 (gap: 6ff00000:8ed00000)
PERCPU: Allocating 36892 bytes of per cpu data
NR_CPUS: 64, nr_cpu_ids: 1, nr_node_ids 1
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 454737
Kernel command line: root=/dev/ram0 init=/linuxrc ramdisk=8192 
real_root=/dev/sda3 irqpoll video=vesafb vga=791
Misrouted IRQ fixup and polling support enabled
This may significantly impact system performance
Enabling fast FPU save and restore... done.
Enabling unmasked SIMD FPU exception support... done.
Initializing CPU#0
PID hash table entries: 4096 (order: 12, 16384 bytes)
Extended CMOS year: 2000
TSC: Using PIT calibration value
Detected 1595.960 MHz processor.
Console: colour VGA+ 80x25
console [tty0] enabled
Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)
Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)
Memory: 1810056k/1833664k available (2993k kernel code, 22440k reserved, 1165k 
data, 272k init, 916160k highmem)
virtual kernel memory layout:
    fixmap  : 0xffc78000 - 0xfffff000   (3612 kB)
    pkmap   : 0xff400000 - 0xff800000   (4096 kB)
    vmalloc : 0xf8800000 - 0xff3fe000   ( 107 MB)
    lowmem  : 0xc0000000 - 0xf8000000   ( 896 MB)
      .init : 0xc0519000 - 0xc055d000   ( 272 kB)
      .data : 0xc03ec759 - 0xc050fd38   (1165 kB)
      .text : 0xc0100000 - 0xc03ec759   (2993 kB)
Checking if this processor honours the WP bit even in supervisor mode...Ok.
CPA: page pool initialized 1 of 1 pages preallocated
Calibrating delay loop (skipped), value calculated using timer frequency.. 
3191.92 BogoMIPS (lpj=15959600)
Mount-cache hash table entries: 512
CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (64 bytes/line)
CPU: L2 Cache: 128K (64 bytes/line)
Checking 'hlt' instruction... OK.
SMP alternatives: switching to UP code
Freeing SMP alternatives: 25k freed
ACPI: Core revision 20080609
ENABLING IO-APIC IRQs
..TIMER: vector=0x31 apic1=0 pin1=2 apic2=-1 pin2=-1
CPU0: Centaur VIA C7-M Processor 1600MHz stepping 00
Brought up 1 CPUs
Total of 1 processors activated (3191.92 BogoMIPS).
CPU0 attaching sched-domain:
 domain 0: span 0 level CPU
  groups: 0
net_namespace: 448 bytes
NET: Registered protocol family 16
EISA bus registered
ACPI: bus type pci registered
PCI: MCFG configuration 0: base e0000000 segment 0 buses 0 - 255
PCI: Not using MMCONFIG.
PCI: PCI BIOS revision 3.00 entry at 0xf0031, last bus=7
PCI: Using configuration type 1 for base access
ACPI: EC: Look up EC in DSDT
ACPI: Interpreter enabled
ACPI: (supports S0 S3 S4 S5)
ACPI: Using IOAPIC for interrupt routing
PCI: MCFG configuration 0: base e0000000 segment 0 buses 0 - 255
PCI: MCFG area at e0000000 reserved in ACPI motherboard resources
PCI: Using MMCONFIG for extended config space
ACPI: EC: non-query interrupt received, switching to interrupt mode
ACPI: EC: GPE = 0x11, I/O: command/status = 0x66, data = 0x62
ACPI: EC: driver started in interrupt mode
ACPI: PCI Root Bridge [PCI0] (0000:00)
PCI: 0000:00:00.0 reg 10 32bit mmio: [f0000000, f7ffffff]
pci 0000:00:02.0: PME# supported from D0 D3hot D3cold
pci 0000:00:02.0: PME# disabled
pci 0000:00:03.0: PME# supported from D0 D3hot D3cold
pci 0000:00:03.0: PME# disabled
PCI: 0000:00:0f.0 reg 10 io port: [cc00, cc07]
PCI: 0000:00:0f.0 reg 14 io port: [c880, c883]
PCI: 0000:00:0f.0 reg 18 io port: [c800, c807]
PCI: 0000:00:0f.0 reg 1c io port: [c480, c483]
PCI: 0000:00:0f.0 reg 20 io port: [c400, c40f]
PCI: 0000:00:0f.0 reg 24 io port: [c000, c0ff]
PCI: 0000:00:10.0 reg 20 io port: [b800, b81f]
pci 0000:00:10.0: supports D1
pci 0000:00:10.0: supports D2
pci 0000:00:10.0: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:10.0: PME# disabled
PCI: 0000:00:10.2 reg 20 io port: [b880, b89f]
pci 0000:00:10.2: supports D1
pci 0000:00:10.2: supports D2
pci 0000:00:10.2: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:10.2: PME# disabled
PCI: 0000:00:10.3 reg 20 io port: [bc00, bc1f]
pci 0000:00:10.3: supports D1
pci 0000:00:10.3: supports D2
pci 0000:00:10.3: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:10.3: PME# disabled
PCI: 0000:00:10.4 reg 10 32bit mmio: [fbeffc00, fbeffcff]
pci 0000:00:10.4: supports D1
pci 0000:00:10.4: supports D2
pci 0000:00:10.4: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:10.4: PME# disabled
PCI: 0000:01:00.0 reg 10 32bit mmio: [c0000000, cfffffff]
PCI: 0000:01:00.0 reg 14 32bit mmio: [fc000000, fcffffff]
PCI: 0000:01:00.0 reg 30 32bit mmio: [fbff0000, fbffffff]
pci 0000:01:00.0: supports D1
pci 0000:01:00.0: supports D2
PCI: bridge 0000:00:01.0 32bit mmio: [fbf00000, fcffffff]
PCI: bridge 0000:00:01.0 32bit mmio pref: [c0000000, cfffffff]
PCI: 0000:02:00.0 reg 10 64bit mmio: [fdffc000, fdffffff]
pci 0000:02:00.0: supports D1
pci 0000:02:00.0: supports D2
PCI: bridge 0000:00:02.0 io port: [d000, dfff]
PCI: bridge 0000:00:02.0 32bit mmio: [fd000000, fdffffff]
PCI: bridge 0000:00:02.0 64bit mmio pref: [de000000, dfffffff]
PCI: bridge 0000:00:03.0 io port: [e000, efff]
PCI: bridge 0000:00:03.0 32bit mmio: [fe000000, fe9fffff]
PCI: bridge 0000:00:03.0 64bit mmio pref: [f8000000, faffffff]
PCI: 0000:07:03.0 reg 10 32bit mmio: [feaf0000, feafffff]
pci 0000:07:03.0: PME# supported from D3hot D3cold
pci 0000:07:03.0: PME# disabled
pci 0000:00:13.1: transparent bridge
PCI: bridge 0000:00:13.1 32bit mmio: [fea00000, feafffff]
bus 00 -> node 0
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P0P1._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.NBPG._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P0P9._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P0PA._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.NBP0._PRT]
ACPI: PCI Root Bridge [PCI1] (0000:80)
PCI: 0000:80:01.0 reg 10 64bit mmio: [febfc000, febfffff]
pci 0000:80:01.0: PME# supported from D0 D3hot D3cold
pci 0000:80:01.0: PME# disabled
bus 80 -> node 0
ACPI: PCI Interrupt Routing Table [\_SB_.PCI1._PRT]
ACPI: PCI Interrupt Link [LNKA] (IRQs 3 4 5 6 7 10 *11 12 14 15)
ACPI: PCI Interrupt Link [LNKB] (IRQs 3 4 *5 6 7 10 11 12 14 15)
ACPI: PCI Interrupt Link [LNKC] (IRQs *3 4 5 6 7 10 11 12 14 15)
ACPI: PCI Interrupt Link [LNKD] (IRQs 3 4 5 6 *7 10 11 12 14 15)
ACPI: PCI Interrupt Link [LNKE] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
ACPI: PCI Interrupt Link [LNKF] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
ACPI: PCI Interrupt Link [LNKG] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
ACPI: PCI Interrupt Link [LNKH] (IRQs 3 4 5 6 7 *10 11 12 14 15)
ACPI: Power Resource [APMF] (off)
Linux Plug and Play Support v0.97 (c) Adam Belay
pnp: PnP ACPI init
ACPI: bus type pnp registered
pnp: PnP ACPI: found 14 devices
ACPI: ACPI bus type pnp unregistered
SCSI subsystem initialized
PCI: Using ACPI for IRQ routing
system 00:05: ioport range 0x3e0-0x3e7 has been reserved
system 00:05: ioport range 0x4d0-0x4d1 has been reserved
system 00:05: ioport range 0x500-0x501 has been reserved
system 00:05: ioport range 0x800-0x87f has been reserved
system 00:05: ioport range 0x400-0x41f has been reserved
system 00:05: iomem range 0xfecc0000-0xfecc0fff could not be reserved
system 00:05: iomem range 0xfed02000-0xfed02fff has been reserved
system 00:08: iomem range 0xfec00000-0xfec00fff could not be reserved
system 00:08: iomem range 0xfee00000-0xfee00fff could not be reserved
system 00:0a: iomem range 0xe0000000-0xefffffff has been reserved
system 00:0c: iomem range 0x0-0x9ffff could not be reserved
system 00:0c: iomem range 0xc0000-0xcffff could not be reserved
system 00:0c: iomem range 0xe0000-0xfffff could not be reserved
system 00:0c: iomem range 0x100000-0x6fefffff could not be reserved
system 00:0c: iomem range 0xfec00000-0xffffffff could not be reserved
pci 0000:00:01.0: PCI bridge, secondary bus 0000:01
pci 0000:00:01.0:   IO window: disabled
pci 0000:00:01.0:   MEM window: 0xfbf00000-0xfcffffff
pci 0000:00:01.0:   PREFETCH window: 0x000000c0000000-0x000000cfffffff
pci 0000:00:02.0: PCI bridge, secondary bus 0000:02
pci 0000:00:02.0:   IO window: 0xd000-0xdfff
pci 0000:00:02.0:   MEM window: 0xfd000000-0xfdffffff
pci 0000:00:02.0:   PREFETCH window: 0x000000de000000-0x000000dfffffff
pci 0000:00:03.0: PCI bridge, secondary bus 0000:05
pci 0000:00:03.0:   IO window: 0xe000-0xefff
pci 0000:00:03.0:   MEM window: 0xfe000000-0xfe9fffff
pci 0000:00:03.0:   PREFETCH window: 0x000000f8000000-0x000000faffffff
pci 0000:00:13.1: PCI bridge, secondary bus 0000:07
pci 0000:00:13.1:   IO window: disabled
pci 0000:00:13.1:   MEM window: 0xfea00000-0xfeafffff
pci 0000:00:13.1:   PREFETCH window: disabled
pci 0000:00:01.0: setting latency timer to 64
pci 0000:00:02.0: PCI INT A -> GSI 27 (level, low) -> IRQ 27
pci 0000:00:02.0: setting latency timer to 64
pci 0000:00:03.0: PCI INT A -> GSI 31 (level, low) -> IRQ 31
pci 0000:00:03.0: setting latency timer to 64
pci 0000:00:13.1: setting latency timer to 64
bus: 00 index 0 io port: [0, ffff]
bus: 00 index 1 mmio: [0, ffffffffffffffff]
bus: 01 index 0 mmio: [0, 0]
bus: 01 index 1 mmio: [fbf00000, fcffffff]
bus: 01 index 2 mmio: [c0000000, cfffffff]
bus: 01 index 3 mmio: [0, 0]
bus: 02 index 0 io port: [d000, dfff]
bus: 02 index 1 mmio: [fd000000, fdffffff]
bus: 02 index 2 mmio: [de000000, dfffffff]
bus: 02 index 3 mmio: [0, 0]
bus: 05 index 0 io port: [e000, efff]
bus: 05 index 1 mmio: [fe000000, fe9fffff]
bus: 05 index 2 mmio: [f8000000, faffffff]
bus: 05 index 3 mmio: [0, 0]
bus: 07 index 0 mmio: [0, 0]
bus: 07 index 1 mmio: [fea00000, feafffff]
bus: 07 index 2 mmio: [0, 0]
bus: 07 index 3 io port: [0, ffff]
bus: 07 index 4 mmio: [0, ffffffffffffffff]
bus: 80 index 0 io port: [0, ffff]
bus: 80 index 1 mmio: [0, ffffffffffffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 32768 (order: 5, 131072 bytes)
TCP established hash table entries: 131072 (order: 8, 1048576 bytes)
TCP bind hash table entries: 65536 (order: 7, 524288 bytes)
TCP: Hash tables configured (established 131072 bind 65536)
TCP reno registered
NET: Registered protocol family 1
checking if image is initramfs... it is
Freeing initrd memory: 2489k freed
highmem bounce pool size: 64 pages
squashfs: version 3.4 (2008/08/26) Phillip Lougher
NTFS driver 2.1.29 [Flags: R/O].
SGI XFS with ACLs, security attributes, realtime, large block numbers, no 
debug enabled
SGI XFS Quota Management subsystem
msgmni has been set to 1752
Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)
io scheduler noop registered
io scheduler deadline registered (default)
PCI: VIA PCI bridge detected.Disabling DAC.
pci 0000:01:00.0: Boot video device
pcieport-driver 0000:00:02.0: setting latency timer to 64
pcieport-driver 0000:00:02.0: found MSI capability
pci_express 0000:00:02.0:pcie00: allocate port service
pci_express 0000:00:02.0:pcie01: allocate port service
pci_express 0000:00:02.0:pcie02: allocate port service
pci_express 0000:00:02.0:pcie03: allocate port service
pcieport-driver 0000:00:03.0: setting latency timer to 64
pcieport-driver 0000:00:03.0: found MSI capability
pci_express 0000:00:03.0:pcie00: allocate port service
pci_express 0000:00:03.0:pcie01: allocate port service
pci_express 0000:00:03.0:pcie02: allocate port service
pci_express 0000:00:03.0:pcie03: allocate port service
aer 0000:00:02.0:pcie01: AER service couldn't init device: no _OSC support
aer 0000:00:03.0:pcie01: AER service couldn't init device: no _OSC support
VIA RNG detected
isapnp: Scanning for PnP cards...
isapnp: No Plug & Play device found
Serial: 8250/16550 driver4 ports, IRQ sharing enabled
brd: module loaded
loop: module loaded
input: Macintosh mouse button emulation as /class/input/input0
Uniform Multi-Platform E-IDE driver
ide_generic: please use "probe_mask=0x3f" module parameter for probing all 
legacy ISA IDE ports
Probing IDE interface ide0...
Probing IDE interface ide1...
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
ide1 at 0x170-0x177,0x376 on irq 15
Loading iSCSI transport class v2.0-870.
iscsi: registered transport (tcp)
Driver 'sd' needs updating - please use bus_type methods
Driver 'sr' needs updating - please use bus_type methods
SCSI Media Changer driver v0.25
Driver 'ch' needs updating - please use bus_type methods
aoe: AoE v47 initialised.
PNP: PS/2 Controller [PNP0303:PS2K,PNP0f12:PS2M] at 0x60,0x64 irq 1,12
i8042.c: Detected active multiplexing controller, rev 1.1.
serio: i8042 KBD port at 0x60,0x64 irq 1
serio: i8042 AUX0 port at 0x60,0x64 irq 12
serio: i8042 AUX1 port at 0x60,0x64 irq 12
serio: i8042 AUX2 port at 0x60,0x64 irq 12
serio: i8042 AUX3 port at 0x60,0x64 irq 12
mice: PS/2 mouse device common for all mice
EISA: Probing bus 0 at eisa.0
EISA: Detected 0 cards.
cpuidle: using governor ladder
dca service started, version 1.4
TCP cubic registered
NET: Registered protocol family 17
RPC: Registered udp transport module.
RPC: Registered tcp transport module.
Using IPI No-Shortcut mode
Freeing unused kernel memory: 272k freed
input: AT Translated Set 2 keyboard as /class/input/input1
No dock devices found.
libata version 3.00 loaded.
Synaptics Touchpad, model: 1, fw: 6.5, id: 0x1c0b1, caps: 0xa04711/0xa00000
input: SynPS/2 Synaptics TouchPad as /class/input/input2
sata_via 0000:00:0f.0: version 2.3
sata_via 0000:00:0f.0: power state changed by ACPI to D0
sata_via 0000:00:0f.0: PCI INT B -> GSI 21 (level, low) -> IRQ 21
sata_via 0000:00:0f.0: routed to hard irq line 5
scsi0 : sata_via
scsi1 : sata_via
ata1: SATA max UDMA/133 cmd 0xcc00 ctl 0xc880 bmdma 0xc400 irq 21
ata2: SATA max UDMA/133 cmd 0xc800 ctl 0xc480 bmdma 0xc408 irq 21
ata1: SATA link up 1.5 Gbps (SStatus 123 SControl 300)
ata1.00: ATA-8: ST9120817AS, 3.AHC, max UDMA/100
ata1.00: 234441648 sectors, multi 16: LBA48 NCQ (depth 0/32)
ata1.00: configured for UDMA/100
ata2: SATA link down 1.5 Gbps (SStatus 0 SControl 300)
scsi 0:0:0:0: Direct-Access     ATA      ST9120817AS      3.AH PQ: 0 ANSI: 5
sd 0:0:0:0: [sda] 234441648 512-byte hardware sectors (120034 MB)
sd 0:0:0:0: [sda] Write Protect is off
sd 0:0:0:0: [sda] Mode Sense: 00 3a 00 00
sd 0:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support 
DPO or FUA
sd 0:0:0:0: [sda] 234441648 512-byte hardware sectors (120034 MB)
sd 0:0:0:0: [sda] Write Protect is off
sd 0:0:0:0: [sda] Mode Sense: 00 3a 00 00
sd 0:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support 
DPO or FUA
 sda: sda1 sda2 sda3
sd 0:0:0:0: [sda] Attached SCSI disk
sd 0:0:0:0: Attached scsi generic sg0 type 0
NCR53c406a: no available ports found
scsi: <fdomain> Detection failed (no card)
GDT-HA: Storage RAID Controller Driver. Version: 3.05
qlogicfas: no cards were found, please specify I/O address and IRQ using 
iobase= and irq= optionsFailed initialization of WD-7000 SCSI card!
NCR53c406a: no available ports found
sym53c416.c: Version 1.0.0-ac
Fusion MPT base driver 3.04.07
Copyright (c) 1999-2008 LSI Corporation
Fusion MPT SPI Host driver 3.04.07
Fusion MPT FC Host driver 3.04.07
Fusion MPT SAS Host driver 3.04.07
3ware Storage Controller device driver for Linux v1.26.02.002.
3ware 9000 Storage Controller device driver for Linux v2.26.02.011.
Compaq SMART2 Driver (v 2.6.0)
HP CISS Driver (v 3.6.20)
Adaptec aacraid driver 1.1-5[2456]-ms
megaraid cmm: 2.20.2.7 (Release Date: Sun Jul 16 00:01:03 EST 2006)
megaraid: 2.20.5.1 (Release Date: Thu Nov 16 15:32:35 EST 2006)
megasas: 00.00.04.01 Thu July 24 11:41:51 PST 2008
QLogic Fibre Channel HBA Driver: 8.02.01-k7
Emulex LightPulse Fibre Channel SCSI driver 8.2.7
Copyright(c) 2004-2008 Emulex.  All rights reserved.
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
ehci_hcd 0000:00:10.4: PCI INT C -> GSI 21 (level, low) -> IRQ 21
ehci_hcd 0000:00:10.4: EHCI Host Controller
ehci_hcd 0000:00:10.4: new USB bus registered, assigned bus number 1
ehci_hcd 0000:00:10.4: debug port 1
ehci_hcd 0000:00:10.4: irq 21, io mem 0xfbeffc00
ehci_hcd 0000:00:10.4: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 8 ports detected
Initializing USB Mass Storage driver...
usb 1-8: new high speed USB device using ehci_hcd and address 3
usb 1-8: configuration #1 chosen from 1 choice
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
USB Universal Host Controller Interface driver v3.0
uhci_hcd 0000:00:10.0: PCI INT A -> GSI 20 (level, low) -> IRQ 20
uhci_hcd 0000:00:10.0: UHCI Host Controller
uhci_hcd 0000:00:10.0: new USB bus registered, assigned bus number 2
uhci_hcd 0000:00:10.0: irq 20, io base 0x0000b800
usb usb2: configuration #1 chosen from 1 choice
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
uhci_hcd 0000:00:10.2: PCI INT C -> GSI 21 (level, low) -> IRQ 21
uhci_hcd 0000:00:10.2: UHCI Host Controller
uhci_hcd 0000:00:10.2: new USB bus registered, assigned bus number 3
uhci_hcd 0000:00:10.2: irq 21, io base 0x0000b880
usb usb3: configuration #1 chosen from 1 choice
hub 3-0:1.0: USB hub found
hub 3-0:1.0: 2 ports detected
uhci_hcd 0000:00:10.3: PCI INT D -> GSI 23 (level, low) -> IRQ 23
uhci_hcd 0000:00:10.3: UHCI Host Controller
uhci_hcd 0000:00:10.3: new USB bus registered, assigned bus number 4
uhci_hcd 0000:00:10.3: irq 23, io base 0x0000bc00
usb usb4: configuration #1 chosen from 1 choice
hub 4-0:1.0: USB hub found
hub 4-0:1.0: 2 ports detected
usb 3-1: new full speed USB device using uhci_hcd and address 2
usb 3-1: configuration #1 chosen from 1 choice
ohci_hcd: 2006 August 04 USB 1.1 'Open' Host Controller (OHCI) Driver
usbcore: registered new interface driver hiddev
usbcore: registered new interface driver usbhid
usbhid: v2.6:USB HID core driver
sl811: driver sl811-hcd, 19 May 2005
device-mapper: uevent: version 1.0.3
device-mapper: ioctl: 4.14.0-ioctl (2008-04-23) initialised: 
dm-devel at redhat.com
md: raid0 personality registered for level 0
md: raid1 personality registered for level 1
async_tx: api initialized (async)
xor: automatically using best checksumming function: pIII_sse
   pIII_sse  :  3463.200 MB/sec
xor: using function: pIII_sse (3463.200 MB/sec)
raid6: int32x1    245 MB/s
raid6: int32x2    271 MB/s
raid6: int32x4    251 MB/s
raid6: int32x8    184 MB/s
raid6: mmxx1      579 MB/s
raid6: mmxx2      783 MB/s
raid6: sse1x1     486 MB/s
raid6: sse1x2     726 MB/s
raid6: sse2x1     894 MB/s
raid6: sse2x2    1124 MB/s
raid6: using algorithm sse2x2 (1124 MB/s)
md: raid6 personality registered for level 6
md: raid5 personality registered for level 5
md: raid4 personality registered for level 4
md: raid10 personality registered for level 10
JFS: nTxBlock = 8192, nTxLock = 65536
Intel(R) PRO/1000 Network Driver - version 7.3.20-k3-NAPI
Copyright (c) 1999-2006 Intel Corporation.
tg3.c:v3.94 (August 14, 2008)
tg3 0000:07:03.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16
eth0: Tigon3 [partno(BCM95788) rev 3003 PHY(5705)] (PCI:33MHz:32-bit) 
10/100/1000Base-T Ethernet 00:22:64:4b:aa:20
eth0: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[0] WireSpeed[0] TSOcap[1]
eth0: dma_rwctrl[763f0000] dma_mask[32-bit]
EXT3-fs: INFO: recovery required on readonly filesystem.
EXT3-fs: write access will be enabled during recovery.
kjournald starting.  Commit interval 5 seconds
EXT3-fs: recovery complete.
EXT3-fs: mounted filesystem with ordered data mode.
input: Power Button (FF) as /class/input/input3
ACPI: Power Button (FF) [PWRF]
input: Lid Switch as /class/input/input4
ACPI: CPU0 (power states: C1[C1] C2[C2] C3[C3])
processor ACPI0007:00: registered as cooling_device0
ACPI: Processor [P001] (supports 16 throttling states)
ACPI: Lid Switch [LID]
input: Sleep Button (CM) as /class/input/input5
ACPI: Sleep Button (CM) [SLPB]
input: Power Button (CM) as /class/input/input6
ACPI: Power Button (CM) [PWRB]
ACPI: AC Adapter [AC0] (on-line)
thermal LNXTHERM:01: registered as thermal_zone0
ACPI: Thermal Zone [THRM] (59 C)
ACPI: Battery Slot [BAT1] (battery present)
acpi device:0a: registered as cooling_device1
input: Video Bus as /class/input/input7
ACPI: Video Device [VGA] (multi-head: yes  rom: no  post: no)
b43-pci-bridge 0000:02:00.0: PCI INT A -> GSI 24 (level, low) -> IRQ 24
b43-pci-bridge 0000:02:00.0: setting latency timer to 64
Bluetooth: Core ver 2.13
NET: Registered protocol family 31
Bluetooth: HCI device and connection manager initialized
Bluetooth: HCI socket layer initialized
Bluetooth: HCI USB driver ver 2.10
usbcore: registered new interface driver hci_usb
ssb: Sonics Silicon Backplane found on PCI device 0000:02:00.0
Real Time Clock Driver v1.12ac
HDA Intel 0000:80:01.0: power state changed by ACPI to D0
HDA Intel 0000:80:01.0: PCI INT A -> GSI 17 (level, low) -> IRQ 17
HDA Intel 0000:80:01.0: setting latency timer to 64
HDA Intel 0000:80:01.0: PCI: Disallowing DAC for device
Marking TSC unstable due to TSC halts in idle
b43-phy0: Broadcom 4311 WLAN found
Clocksource tsc unstable (delta = -172616486 ns)
phy0: Selected rate control algorithm 'pid'
Broadcom 43xx driver loaded [ Features: PMLR, Firmware-ID: FW13 ]
EXT3 FS on sda3, internal journal
Unable to find swap-space signature
tg3: eth0: Link is up at 100 Mbps, full duplex.
tg3: eth0: Flow control is on for TX and on for RX.
input: b43-phy0 as /class/input/input8
firmware: requesting b43/ucode13.fw
firmware: requesting b43/b0g0initvals13.fw
b43-phy0: Loading firmware version 410.2160 (2007-05-26 15:32:10)
b43-pci-bridge 0000:02:00.0: PCI: Disallowing DAC for device
b43-phy0: DMA mask fallback from 64-bit to 32-bit
Registered led device: b43-phy0::tx
Registered led device: b43-phy0::rx
Registered led device: b43-phy0::radio
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticated
wlan0: associate with AP 00:22:3f:18:89:5e
wlan0: RX AssocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
wlan0: associated
wlan0: authenticate with AP 00:22:3f:18:89:5e
wlan0: authenticated
wlan0: associate with AP 00:22:3f:18:89:5e
wlan0: RX ReassocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
wlan0: associated
evdev.c(EVIOCGBIT): Suspicious buffer size 511, limiting output to 64 bytes. 
See http://userweb.kernel.org/~dtor/eviocgbit-bug.html
b43-phy0: Radio hardware status changed to DISABLED
wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range
b43-phy0 ERROR: DMA RX reset timed out
b43-phy0 ERROR: DMA TX reset timed out
b43-phy0 ERROR: DMA TX reset timed out
b43-phy0 ERROR: DMA TX reset timed out
b43-phy0 ERROR: DMA TX reset timed out
b43-phy0 ERROR: DMA TX reset timed out
input: b43-phy0 as /class/input/input9
ssb: Backplane Revision 0xF0000000
------------[ cut here ]------------
WARNING: at drivers/ssb/main.c:1042 ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
()
Modules linked in: rfkill_input arc4 ecb b43 rfkill mac80211 cfg80211 
led_class input_polldev snd_hda_intel rtc snd_pcm snd_timer snd_page_alloc 
snd_hwdep snd soundcore hci_usb bluetooth ssb pcmcia pcmcia_core video 
backlight output battery thermal ac processor button thermal_sys tg3 libphy 
e1000 jfs raid10 raid456 async_memcpy async_xor xor async_tx raid1 raid0 
dm_bbr dm_snapshot dm_mirror dm_log dm_mod sbp2 ohci1394 ieee1394 sl811_hcd 
usbhid ohci_hcd uhci_hcd usb_storage ehci_hcd usbcore lpfc qla2xxx 
firmware_class megaraid_sas megaraid_mbox megaraid_mm megaraid aacraid sx8 
DAC960 cciss cpqarray 3w_9xxx 3w_xxxx mptsas scsi_transport_sas mptfc 
scsi_transport_fc scsi_tgt mptspi mptscsih mptbase atp870u dc395x sim710 
53c700 qla1280 dmx3191d sym53c8xx qlogicfas408 gdth aha1740 advansys initio 
BusLogic arcmsr aic7xxx aic79xx scsi_transport_spi sg pdc_adma sata_inic162x 
sata_mv ata_piix ahci sata_qstor sata_vsc sata_uli sata_sis sata_sx4 sata_nv 
sata_via sata_svw sata_sil24 sata_sil sata_promise scsi_wait_scan pata_sis 
libata dock
Pid: 15229, comm: ifconfig Not tainted 2.6.27-gentoo-r2 #3
 [<c011dce6>] warn_on_slowpath+0x40/0x63
 [<c01148b7>] __wake_up_common+0x2e/0x58
 [<c0115180>] __wake_up+0x29/0x39
 [<c011e07a>] wake_up_klogd+0x2b/0x2d
 [<c0376aff>] pci_write+0x1c/0x21
 [<c02cd1d1>] pci_bus_write_config_word+0x50/0x5b
 [<c011e61e>] printk+0x14/0x18
 [<f9181810>] ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
 [<f9181f5a>] ssb_device_is_enabled+0x9/0x2d [ssb]
 [<f92496d5>] b43_wireless_core_init+0x37/0x64e [b43]
 [<f924a324>] b43_op_start+0x8d/0xd6 [b43]
 [<f9269bc1>] ieee80211_open+0x21a/0x4ad [mac80211]
 [<c013fb3b>] find_lock_page+0x10/0x43
 [<c0383229>] dev_open+0x63/0x93
 [<c03819c6>] dev_change_flags+0x92/0x140
 [<c03b24a8>] devinet_ioctl+0x23b/0x524
 [<c0377980>] sock_ioctl+0x1ad/0x1d1
 [<c03777d3>] sock_ioctl+0x0/0x1d1
 [<c0164164>] vfs_ioctl+0x1c/0x5e
 [<c01643f8>] do_vfs_ioctl+0x252/0x26c
 [<c0111c9e>] do_page_fault+0x22d/0x573
 [<c016443e>] sys_ioctl+0x2c/0x42
 [<c0102ba1>] sysenter_do_call+0x12/0x25
 =======================
---[ end trace fdafa518d2ffde63 ]---
b43-phy0 ERROR: Microcode not responding
b43-phy0 ERROR: You must go to 
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and download the 
latest firmware (version 4).
input: b43-phy0 as /class/input/input10
ssb: Backplane Revision 0xF0000000
------------[ cut here ]------------
WARNING: at drivers/ssb/main.c:1042 ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
()
Modules linked in: rfkill_input arc4 ecb b43 rfkill mac80211 cfg80211 
led_class input_polldev snd_hda_intel rtc snd_pcm snd_timer snd_page_alloc 
snd_hwdep snd soundcore hci_usb bluetooth ssb pcmcia pcmcia_core video 
backlight output battery thermal ac processor button thermal_sys tg3 libphy 
e1000 jfs raid10 raid456 async_memcpy async_xor xor async_tx raid1 raid0 
dm_bbr dm_snapshot dm_mirror dm_log dm_mod sbp2 ohci1394 ieee1394 sl811_hcd 
usbhid ohci_hcd uhci_hcd usb_storage ehci_hcd usbcore lpfc qla2xxx 
firmware_class megaraid_sas megaraid_mbox megaraid_mm megaraid aacraid sx8 
DAC960 cciss cpqarray 3w_9xxx 3w_xxxx mptsas scsi_transport_sas mptfc 
scsi_transport_fc scsi_tgt mptspi mptscsih mptbase atp870u dc395x sim710 
53c700 qla1280 dmx3191d sym53c8xx qlogicfas408 gdth aha1740 advansys initio 
BusLogic arcmsr aic7xxx aic79xx scsi_transport_spi sg pdc_adma sata_inic162x 
sata_mv ata_piix ahci sata_qstor sata_vsc sata_uli sata_sis sata_sx4 sata_nv 
sata_via sata_svw sata_sil24 sata_sil sata_promise scsi_wait_scan pata_sis 
libata dock
Pid: 15255, comm: ifconfig Tainted: G        W 2.6.27-gentoo-r2 #3
 [<c011dce6>] warn_on_slowpath+0x40/0x63
 [<c01148b7>] __wake_up_common+0x2e/0x58
 [<c0115180>] __wake_up+0x29/0x39
 [<c011e07a>] wake_up_klogd+0x2b/0x2d
 [<c0376aff>] pci_write+0x1c/0x21
 [<c02cd1d1>] pci_bus_write_config_word+0x50/0x5b
 [<c011e61e>] printk+0x14/0x18
 [<f9181810>] ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
 [<f9181f5a>] ssb_device_is_enabled+0x9/0x2d [ssb]
 [<f92496d5>] b43_wireless_core_init+0x37/0x64e [b43]
 [<f924a324>] b43_op_start+0x8d/0xd6 [b43]
 [<f9269bc1>] ieee80211_open+0x21a/0x4ad [mac80211]
 [<c013fb3b>] find_lock_page+0x10/0x43
 [<c0383229>] dev_open+0x63/0x93
 [<c03819c6>] dev_change_flags+0x92/0x140
 [<c03b24a8>] devinet_ioctl+0x23b/0x524
 [<c0377980>] sock_ioctl+0x1ad/0x1d1
 [<c03777d3>] sock_ioctl+0x0/0x1d1
 [<c0164164>] vfs_ioctl+0x1c/0x5e
 [<c01643f8>] do_vfs_ioctl+0x252/0x26c
 [<c0111c9e>] do_page_fault+0x22d/0x573
 [<c016443e>] sys_ioctl+0x2c/0x42
 [<c0102ba1>] sysenter_do_call+0x12/0x25
 =======================
---[ end trace fdafa518d2ffde63 ]---
b43-phy0 ERROR: Microcode not responding
b43-phy0 ERROR: You must go to 
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and download the 
latest firmware (version 4).
input: b43-phy0 as /class/input/input11
ssb: Backplane Revision 0xF0000000
------------[ cut here ]------------
WARNING: at drivers/ssb/main.c:1042 ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
()
Modules linked in: rfkill_input arc4 ecb b43 rfkill mac80211 cfg80211 
led_class input_polldev snd_hda_intel rtc snd_pcm snd_timer snd_page_alloc 
snd_hwdep snd soundcore hci_usb bluetooth ssb pcmcia pcmcia_core video 
backlight output battery thermal ac processor button thermal_sys tg3 libphy 
e1000 jfs raid10 raid456 async_memcpy async_xor xor async_tx raid1 raid0 
dm_bbr dm_snapshot dm_mirror dm_log dm_mod sbp2 ohci1394 ieee1394 sl811_hcd 
usbhid ohci_hcd uhci_hcd usb_storage ehci_hcd usbcore lpfc qla2xxx 
firmware_class megaraid_sas megaraid_mbox megaraid_mm megaraid aacraid sx8 
DAC960 cciss cpqarray 3w_9xxx 3w_xxxx mptsas scsi_transport_sas mptfc 
scsi_transport_fc scsi_tgt mptspi mptscsih mptbase atp870u dc395x sim710 
53c700 qla1280 dmx3191d sym53c8xx qlogicfas408 gdth aha1740 advansys initio 
BusLogic arcmsr aic7xxx aic79xx scsi_transport_spi sg pdc_adma sata_inic162x 
sata_mv ata_piix ahci sata_qstor sata_vsc sata_uli sata_sis sata_sx4 sata_nv 
sata_via sata_svw sata_sil24 sata_sil sata_promise scsi_wait_scan pata_sis 
libata dock
Pid: 15310, comm: ifconfig Tainted: G        W 2.6.27-gentoo-r2 #3
 [<c011dce6>] warn_on_slowpath+0x40/0x63
 [<c01148b7>] __wake_up_common+0x2e/0x58
 [<c0115180>] __wake_up+0x29/0x39
 [<c011e07a>] wake_up_klogd+0x2b/0x2d
 [<c0376aff>] pci_write+0x1c/0x21
 [<c02cd1d1>] pci_bus_write_config_word+0x50/0x5b
 [<c011e61e>] printk+0x14/0x18
 [<f9181810>] ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
 [<f9181f5a>] ssb_device_is_enabled+0x9/0x2d [ssb]
 [<f92496d5>] b43_wireless_core_init+0x37/0x64e [b43]
 [<f924a324>] b43_op_start+0x8d/0xd6 [b43]
 [<f9269bc1>] ieee80211_open+0x21a/0x4ad [mac80211]
 [<c013fb3b>] find_lock_page+0x10/0x43
 [<c0383229>] dev_open+0x63/0x93
 [<c03819c6>] dev_change_flags+0x92/0x140
 [<c03b24a8>] devinet_ioctl+0x23b/0x524
 [<c0377980>] sock_ioctl+0x1ad/0x1d1
 [<c03777d3>] sock_ioctl+0x0/0x1d1
 [<c0164164>] vfs_ioctl+0x1c/0x5e
 [<c01643f8>] do_vfs_ioctl+0x252/0x26c
 [<c0111c9e>] do_page_fault+0x22d/0x573
 [<c016443e>] sys_ioctl+0x2c/0x42
 [<c0102ba1>] sysenter_do_call+0x12/0x25
 =======================
---[ end trace fdafa518d2ffde63 ]---
b43-phy0 ERROR: Microcode not responding
b43-phy0 ERROR: You must go to 
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and download the 
latest firmware (version 4).
evdev.c(EVIOCGBIT): Suspicious buffer size 511, limiting output to 64 bytes. 
See http://userweb.kernel.org/~dtor/eviocgbit-bug.html
hda-intel: Invalid position buffer, using LPIB read method instead.

-- 
Yuval Hager
[T] +972-77-341-4155
[@] yuval at avramzon.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081115/f159f297/attachment.pgp>

From Larry.Finger at lwfinger.net  Sat Nov 15 17:41:01 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sat, 15 Nov 2008 10:41:01 -0600
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <200811151801.02369.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
Message-ID: <491EFB9D.3040002@lwfinger.net>

Yuval Hager wrote:
> Hi,
> 
> I am having the following situation:
> System starts fine, b43 module loaded (firmware installed instructions), and 
> wireless works fine. After I start X, I get:
> b43-phy0: Radio hardware status changed to DISABLED
> wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range
> 
> and wireless just stops. All future attempts to start it (rmmod/modprobe) 
> fails.
> 
> See below the workflow, let me know if there is any info missing, or something 
> you think I should try to debug this issue.
> I'll be yhager on #bcm-users as well.
--snip--

> After running X:
> ---------------
> 
> b43-phy0: Radio hardware status changed to DISABLED
> wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range

Normally, this message means that your radio-enable switch has been turned off.
The driver cannot control this switch - it can only read the state. In your
case, it looks to me as if something has taken your ssb device off-line. We are
no longer getting useful info from the registers, but it is as if the reads are
returning all ones.

--snip--

> b43-pci-bridge 0000:02:00.0: PCI INT A -> GSI 24 (level, low) -> IRQ 24
> b43-pci-bridge 0000:02:00.0: setting latency timer to 64
> Bluetooth: Core ver 2.13
> NET: Registered protocol family 31
> Bluetooth: HCI device and connection manager initialized
> Bluetooth: HCI socket layer initialized
> Bluetooth: HCI USB driver ver 2.10
> usbcore: registered new interface driver hci_usb
> ssb: Sonics Silicon Backplane found on PCI device 0000:02:00.0
> Real Time Clock Driver v1.12ac
> HDA Intel 0000:80:01.0: power state changed by ACPI to D0
> HDA Intel 0000:80:01.0: PCI INT A -> GSI 17 (level, low) -> IRQ 17
> HDA Intel 0000:80:01.0: setting latency timer to 64
> HDA Intel 0000:80:01.0: PCI: Disallowing DAC for device
> Marking TSC unstable due to TSC halts in idle
> b43-phy0: Broadcom 4311 WLAN found
> Clocksource tsc unstable (delta = -172616486 ns)
> phy0: Selected rate control algorithm 'pid'
> Broadcom 43xx driver loaded [ Features: PMLR, Firmware-ID: FW13 ]
> EXT3 FS on sda3, internal journal
> Unable to find swap-space signature
> tg3: eth0: Link is up at 100 Mbps, full duplex.
> tg3: eth0: Flow control is on for TX and on for RX.
> input: b43-phy0 as /class/input/input8
> firmware: requesting b43/ucode13.fw
> firmware: requesting b43/b0g0initvals13.fw
> b43-phy0: Loading firmware version 410.2160 (2007-05-26 15:32:10)
> b43-pci-bridge 0000:02:00.0: PCI: Disallowing DAC for device
> b43-phy0: DMA mask fallback from 64-bit to 32-bit
> Registered led device: b43-phy0::tx
> Registered led device: b43-phy0::rx
> Registered led device: b43-phy0::radio
> wlan0: authenticate with AP 00:22:3f:18:89:5e
> wlan0: authenticate with AP 00:22:3f:18:89:5e
> wlan0: authenticated
> wlan0: associate with AP 00:22:3f:18:89:5e
> wlan0: RX AssocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
> wlan0: associated
> wlan0: authenticate with AP 00:22:3f:18:89:5e
> wlan0: authenticated
> wlan0: associate with AP 00:22:3f:18:89:5e
> wlan0: RX ReassocResp from 00:22:3f:18:89:5e (capab=0x401 status=0 aid=2)
> wlan0: associated

At this point, all is normal and you are connected. Below here, the entire
ssb/b43 subsystem has been compromised. In particular, the code that issues the
warning on an unknown backplane revision has been executed previously without a
problem. Suddenly the returned value of the appropriate register has 0xF in the
most significant position instead of 0x6 or 0x7 that was previously found. That
is why I think that the read is returning all ones.

> evdev.c(EVIOCGBIT): Suspicious buffer size 511, limiting output to 64 bytes. 
> See http://userweb.kernel.org/~dtor/eviocgbit-bug.html
> b43-phy0: Radio hardware status changed to DISABLED
> wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range
> b43-phy0 ERROR: DMA RX reset timed out
> b43-phy0 ERROR: DMA TX reset timed out
> b43-phy0 ERROR: DMA TX reset timed out
> b43-phy0 ERROR: DMA TX reset timed out
> b43-phy0 ERROR: DMA TX reset timed out
> b43-phy0 ERROR: DMA TX reset timed out
> input: b43-phy0 as /class/input/input9
> ssb: Backplane Revision 0xF0000000
> ------------[ cut here ]------------
> WARNING: at drivers/ssb/main.c:1042 ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
> ()

Unfortunately, I have no idea what part of X might be causing this. Perhaps
Michael might have a suggestion.

Is this a new machine, or has this problem just started? Can you rule out a
hardware problem? Perhaps the power supply is flaky.

Larry



From yuval at avramzon.net  Sat Nov 15 18:07:04 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sat, 15 Nov 2008 19:07:04 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <491EFB9D.3040002@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<491EFB9D.3040002@lwfinger.net>
Message-ID: <200811151907.05636.yuval@avramzon.net>

Wow! thanks for the prompt response. 

On Saturday 15 November 2008, you wrote:
> Is this a new machine, or has this problem just started? Can you rule out a
> hardware problem? Perhaps the power supply is flaky.

Yes, It's a brand new HP Mini 2133 (HP product number FU346EA).
the power supply is ok, and this problem is recreated exactly the same every 
time. wireless works correctly as long as I don't start X (or maybe it's KDE 
trying to reset something when it loads?)
I booted Vista once (that came with the machine) and everything was working 
fine, so I assume the hardware is ok (but I don't have vista anymore).

-- 
Yuval Hager
[T] +972-77-341-4155
[@] yuval at avramzon.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081115/85f17840/attachment.pgp>

From peter at stuge.se  Sat Nov 15 18:46:23 2008
From: peter at stuge.se (Peter Stuge)
Date: Sat, 15 Nov 2008 18:46:23 +0100
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <200811151907.05636.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<491EFB9D.3040002@lwfinger.net>
	<200811151907.05636.yuval@avramzon.net>
Message-ID: <20081115174623.27321.qmail@stuge.se>

Yuval Hager wrote:
> HP Mini 2133

I posted about the wifi in this guy a while back. It has ABG b43
which isn't really properly supported, at least not the A part but
the reaction I got from mentioning the chipset made me not expect too
much. I don't know if the ABG can be expected to behave exactly like
the BG when not using .11a. I doubt it.


> (HP product number FU346EA).

I just now noticed that the wifi seems to be a miniPCI card. If I
was you I would just replace it. :)


> this problem is recreated exactly the same every time. wireless
> works correctly as long as I don't start X (or maybe it's KDE
> trying to reset something when it loads?)

You can test this by starting only the X server and nothing else,
simply run the command X (one capital X) instead of startx or an init
script for kdm or anything else. You will get only the X server
running (black/white dots background) and you have to kill it with
Ctrl-Alt-Backspace. It would be interesting to know the results.


> I booted Vista once (that came with the machine) and everything was
> working fine, so I assume the hardware is ok (but I don't have
> vista anymore).

Yes. I expect it's the ABG causing problems because it isn't so well
known.

I'm looking to get one of those machines too. RSN.. :)


//Peter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081115/e0339a79/attachment.pgp>

From Larry.Finger at lwfinger.net  Sat Nov 15 19:14:08 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sat, 15 Nov 2008 12:14:08 -0600
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <20081115174623.27321.qmail@stuge.se>
References: <200811151801.02369.yuval@avramzon.net>	<491EFB9D.3040002@lwfinger.net>	<200811151907.05636.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
Message-ID: <491F1170.2010803@lwfinger.net>

Peter Stuge wrote:
> Yuval Hager wrote:
>> HP Mini 2133
> 
> I posted about the wifi in this guy a while back. It has ABG b43
> which isn't really properly supported, at least not the A part but
> the reaction I got from mentioning the chipset made me not expect too
> much. I don't know if the ABG can be expected to behave exactly like
> the BG when not using .11a. I doubt it.

Wrong - if does. The B/G part of this BCM4312 is the same as the BCM4311. I
think the card you asked about (also called the BCM4312) has an LP PHY, which is
not supported.

>> (HP product number FU346EA).
> 
> I just now noticed that the wifi seems to be a miniPCI card. If I
> was you I would just replace it. :)

One problemn is the HP BIOS whitelists PCI cards. If you plug the wrong one in,
the BIOS refuses to boot.

> You can test this by starting only the X server and nothing else,
> simply run the command X (one capital X) instead of startx or an init
> script for kdm or anything else. You will get only the X server
> running (black/white dots background) and you have to kill it with
> Ctrl-Alt-Backspace. It would be interesting to know the results.

That is a good idea.
> 
> Yes. I expect it's the ABG causing problems because it isn't so well
> known.

No, I have one of these and it works perfectly in B/G mode - even with X. Of
course, the A part doesn't work, but no problem.

Larry



From gavron at wetwork.net  Sat Nov 15 20:14:36 2008
From: gavron at wetwork.net (gavron at wetwork.net)
Date: Sat, 15 Nov 2008 12:14:36 -0700
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <200811151907.05636.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<491EFB9D.3040002@lwfinger.net> <200811151907.05636.yuval@avramzon.net>
Message-ID: <491F1F9C.7000407@wetwork.net>



Yuval Hager wrote:
> Yes, It's a brand new HP Mini 2133 (HP product number FU346EA).
> the power supply is ok, and this problem is recreated exactly the same every 
> time. wireless works correctly as long as I don't start X (or maybe it's KDE 
> trying to reset something when it loads?)
> I booted Vista once (that came with the machine) and everything was working 
> fine, so I assume the hardware is ok (but I don't have vista anymore).
>
>   
Yuval, what happens if you
# modprobe -r b43 && sleep 1 && modprobe b43

?

Ehud

-- 
Legal Disclaimer that you are now contractually bound to under all laws with no recourse:
http://attrition.org/security/rants/z/disclaimers.html



From pietia.gr at gmail.com  Sat Nov 15 21:46:09 2008
From: pietia.gr at gmail.com (pietia)
Date: Sat, 15 Nov 2008 21:46:09 +0100
Subject: unsuscribe
Message-ID: <491F3511.9090203@gmail.com>



From galanom at gmail.com  Sat Nov 15 23:54:55 2008
From: galanom at gmail.com (=?UTF-8?B?zpPOsc67zrHOvc6/zrzOrM+EzrfPgiDOmc+JzqzOvc69zrfPgg==?=)
Date: Sun, 16 Nov 2008 00:54:55 +0200
Subject: BCM4312: interface does not show up
Message-ID: <5b21e64e0811151454o13a0282fy511c7cfc32637339@mail.gmail.com>

Hi!

My problem is that upon b43 module load, no interface shows up.
I would expect an eth1 or something from iwconfig but there are only
lo and eth0 (wired).

I followed the instructions from the page
http://linuxwireless.org/en/users/Drivers/b43
I "cut" the firmware and install it to the proposed directory,
exported the env var and then compiled the kernel.

I do not know how to tell kernel to look for the extracted firmware,
there ware no instructions for such a thing.

When I "modprobe b43" the following modules are pulled automatically:
b43                   134832  0
ssb                    31364  1 b43
rng_core                4744  1 b43
mac80211              135692  1 b43
cfg80211               25488  1 mac80211

The following *single* line is added to dmesg:
Broadcom 43xx driver loaded [ Features: P, Firmware-ID: FW13 ]

File versions:
b43-fwcutter-011
broadcom-wl-4.150.10.5.tar.bz2

I have disabled "Select only drivers that don't need compile time
external firmware" and "Prevent firmware from being built" (did not
have effect)

I have a HP 550 (64bit celeron) laptop with the gentoo distribution.
My kernel: 2.6.27-gentoo-r2
Drivers I tried: b43, b43legacy
I compile everything as a module, so if something is not listed with
lsmod, it probably is not compiled at all.

Output from lspci:
10:00.0 Network controller: Broadcom Corporation BCM4312 802.11b/g (rev 01)
	Subsystem: Hewlett-Packard Company BCM4312 802.11b/g Wireless LAN Controller
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B- DisINTx-
	Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort-
<TAbort- <MAbort- >SERR- <PERR- INTx-
	Latency: 0, Cache Line Size: 64 bytes
	Interrupt: pin A routed to IRQ 10
	Region 0: Memory at e4000000 (64-bit, non-prefetchable) [size=16K]
	Capabilities: [40] Power Management version 3
		Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
		Status: D0 PME-Enable- DSel=0 DScale=2 PME-
	Capabilities: [58] Vendor Specific Information <?>
	Capabilities: [e8] Message Signalled Interrupts: Mask- 64bit+ Count=1/1 Enable-
		Address: 0000000000000000  Data: 0000
	Capabilities: [d0] Express (v1) Endpoint, MSI 00
		DevCap:	MaxPayload 128 bytes, PhantFunc 0, Latency L0s <4us, L1 unlimited
			ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-
		DevCtl:	Report errors: Correctable- Non-Fatal- Fatal- Unsupported-
			RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop-
			MaxPayload 128 bytes, MaxReadReq 128 bytes
		DevSta:	CorrErr+ UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
		LnkCap:	Port #0, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0
<4us, L1 <64us
			ClockPM- Suprise- LLActRep- BwNot-
		LnkCtl:	ASPM L0s L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+
			ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
		LnkSta:	Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive-
BWMgmt- ABWMgmt-
	Capabilities: [100] Advanced Error Reporting
		UESta:	DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF-
MalfTLP- ECRC- UnsupReq- ACSVoil-
		UEMsk:	DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF-
MalfTLP- ECRC- UnsupReq- ACSVoil-
		UESvrt:	DLP+ SDES- TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+
MalfTLP+ ECRC- UnsupReq- ACSVoil-
		CESta:	RxErr+ BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+
		CESta:	RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+
		AERCap:	First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn-
	Capabilities: [13c] Virtual Channel <?>
	Capabilities: [160] Device Serial Number 21-00-5a-ff-ff-00-c2-fa
	Capabilities: [16c] Power Budgeting <?>

lsmod:
b43                   134832  0
ssb                    31364  1 b43
rng_core                4744  1 b43
mac80211              135692  1 b43
cfg80211               25488  1 mac80211
snd_seq                46848  0
snd_seq_device          6932  1 snd_seq
ipv6                  238952  16
i915                   33536  0
drm                    85704  1 i915
usb_storage            46976  0
fan                     4096  0
snd_hda_intel         451788  1
sr_mod                 14372  0
snd_pcm                63628  1 snd_hda_intel
ehci_hcd               33292  0
cdrom                  35752  1 sr_mod
uhci_hcd               22168  0
snd_timer              19848  2 snd_seq,snd_pcm
snd_page_alloc          8336  2 snd_hda_intel,snd_pcm
usbcore               135632  4 usb_storage,ehci_hcd,uhci_hcd
snd_hwdep               7560  1 snd_hda_intel
thermal                18464  0
psmouse                39196  0

Thank you very much for your attention.
Have a nice day!


From yuval at avramzon.net  Sun Nov 16 01:39:11 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sun, 16 Nov 2008 02:39:11 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <491F1170.2010803@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
	<491F1170.2010803@lwfinger.net>
Message-ID: <200811160239.16147.yuval@avramzon.net>

On Saturday 15 November 2008, Larry Finger wrote:
> > You can test this by starting only the X server and nothing else,
> > simply run the command X (one capital X) instead of startx or an init
> > script for kdm or anything else. You will get only the X server
> > running (black/white dots background) and you have to kill it with
> > Ctrl-Alt-Backspace. It would be interesting to know the results.
>
> That is a good idea.
>

When I just run 'X' - nothing happens, all works fine.
When I start xdm/kdm - it dies in the same way as before.

> > Yes. I expect it's the ABG causing problems because it isn't so well
> > known.
>
> No, I have one of these and it works perfectly in B/G mode - even with X.
> Of course, the A part doesn't work, but no problem.

Any idea how do I go about debugging this?

--y
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081116/bf3b5435/attachment.pgp>

From yuval at avramzon.net  Sun Nov 16 01:39:19 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sun, 16 Nov 2008 02:39:19 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <491F1F9C.7000407@wetwork.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811151907.05636.yuval@avramzon.net>
	<491F1F9C.7000407@wetwork.net>
Message-ID: <200811160239.20370.yuval@avramzon.net>

On Saturday 15 November 2008, you wrote:
> Yuval Hager wrote:
> > Yes, It's a brand new HP Mini 2133 (HP product number FU346EA).
> > the power supply is ok, and this problem is recreated exactly the same
> > every time. wireless works correctly as long as I don't start X (or maybe
> > it's KDE trying to reset something when it loads?)
> > I booted Vista once (that came with the machine) and everything was
> > working fine, so I assume the hardware is ok (but I don't have vista
> > anymore).
>
> Yuval, what happens if you
> # modprobe -r b43 && sleep 1 && modprobe b43
>
> ?

I can run the above command fine before I start xdm/kdm, and after that, it 
simply doesn't work (b43 gets loaded, but wlan0 is not identified).


--y
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081116/7338abe1/attachment.pgp>

From yuval at avramzon.net  Sun Nov 16 02:26:08 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sun, 16 Nov 2008 03:26:08 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <200811160239.16147.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<491F1170.2010803@lwfinger.net>
	<200811160239.16147.yuval@avramzon.net>
Message-ID: <200811160326.09597.yuval@avramzon.net>

On Sunday 16 November 2008, Yuval Hager wrote:
> On Saturday 15 November 2008, Larry Finger wrote:
> > > You can test this by starting only the X server and nothing else,
> > > simply run the command X (one capital X) instead of startx or an init
> > > script for kdm or anything else. You will get only the X server
> > > running (black/white dots background) and you have to kill it with
> > > Ctrl-Alt-Backspace. It would be interesting to know the results.
> >
> > That is a good idea.
>
> When I just run 'X' - nothing happens, all works fine.
> When I start xdm/kdm - it dies in the same way as before.
>

Don't know how much helpful this is, but I also tried to run 'startx' 
directly, bypassing xdm/kdm. In this case, I got:
Nov 16 03:07:19 happy b43-phy0: Controller RESET (DMA error) ...
Nov 16 03:07:20 happy b43-phy0 ERROR: DMA RX reset timed out
Nov 16 03:07:20 happy b43-phy0 ERROR: DMA TX reset timed out
Nov 16 03:07:20 happy b43-phy0 ERROR: DMA TX reset timed out
Nov 16 03:07:21 happy b43-phy0 ERROR: DMA TX reset timed out
Nov 16 03:07:21 happy b43-phy0 ERROR: DMA TX reset timed out
Nov 16 03:07:22 happy b43-phy0 ERROR: DMA TX reset timed out
Nov 16 03:07:22 happy ssb: Backplane Revision 0xF0000000
Nov 16 03:07:22 happy ------------[ cut here ]------------
Nov 16 03:07:22 happy WARNING: at drivers/ssb/main.c:1042 
ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]()
Nov 16 03:07:22 happy Modules linked in: rfkill_input arc4 ecb b43 rfkill 
mac80211 cfg80211 led_class input_polldev snd_hda_intel rtc snd_pcm snd_timer 
snd_page_alloc snd_hwdep snd soundcore hci_usb bluetooth ssb pcmcia 
pcmcia_core video backlight output battery thermal ac processor button 
thermal_sys tg3 libphy e1000 jfs raid10 raid456 async_memcpy async_xor xor 
async_tx raid1 raid0 dm_bbr dm_snapshot dm_mirror dm_log dm_mod sbp2 ohci1394 
ieee1394 sl811_hcd usbhid ohci_hcd uhci_hcd usb_storage ehci_hcd usbcore lpfc 
qla2xxx firmware_class megaraid_sas megaraid_mbox megaraid_mm megaraid 
aacraid sx8 DAC960 cciss cpqarray 3w_9xxx 3w_xxxx mptsas scsi_transport_sas 
mptfc scsi_transport_fc scsi_tgt mptspi mptscsih mptbase atp870u dc395x 
sim710 53c700 qla1280 dmx3191d sym53c8xx qlogicfas408 gdth aha1740 advansys 
initio BusLogic arcmsr aic7xxx aic79xx scsi_transport_spi sg pdc_adma 
sata_inic162x sata_mv ata_piix ahci sata_qstor sata_vsc sata_uli sata_sis 
sata_sx4 sata_nv sata_via sata_svw sata_sil24 sata_sil sata_promise 
scsi_wait_scan pata_sis libata dock
Nov 16 03:07:22 happy Pid: 10704, comm: b43 Not tainted 2.6.27-gentoo-r2 #3
Nov 16 03:07:22 happy [<c011dce6>] warn_on_slowpath+0x40/0x63
Nov 16 03:07:22 happy [<c01148b7>] __wake_up_common+0x2e/0x58
Nov 16 03:07:22 happy [<c0115180>] __wake_up+0x29/0x39
Nov 16 03:07:22 happy [<c011e07a>] wake_up_klogd+0x2b/0x2d
Nov 16 03:07:22 happy [<c0376aff>] pci_write+0x1c/0x21
Nov 16 03:07:22 happy [<c02cd1d1>] pci_bus_write_config_word+0x50/0x5b
Nov 16 03:07:22 happy [<c011e61e>] printk+0x14/0x18
Nov 16 03:07:22 happy [<f93d5810>] ssb_tmslow_reject_bitmask+0x5e/0x68 [ssb]
Nov 16 03:07:22 happy [<f93d5f5a>] ssb_device_is_enabled+0x9/0x2d [ssb]
Nov 16 03:07:22 happy [<f94a96d5>] b43_wireless_core_init+0x37/0x64e [b43]
Nov 16 03:07:22 happy [<f94a9d9c>] b43_chip_reset+0x38/0x84 [b43]
Nov 16 03:07:22 happy [<f94a9d64>] b43_chip_reset+0x0/0x84 [b43]
Nov 16 03:07:22 happy [<c0129b9d>] run_workqueue+0x6d/0xe0
Nov 16 03:07:22 happy [<c012a27f>] worker_thread+0x0/0xbd
Nov 16 03:07:22 happy [<c012a332>] worker_thread+0xb3/0xbd
Nov 16 03:07:22 happy [<c012c4bc>] autoremove_wake_function+0x0/0x2d
Nov 16 03:07:22 happy [<c012c3fb>] kthread+0x38/0x5d
Nov 16 03:07:22 happy [<c012c3c3>] kthread+0x0/0x5d
Nov 16 03:07:22 happy [<c0103e17>] kernel_thread_helper+0x7/0x10
Nov 16 03:07:22 happy =======================
Nov 16 03:07:22 happy ---[ end trace 9156cfca767d0e87 ]---
Nov 16 03:07:23 happy b43-phy0 ERROR: Microcode not responding
Nov 16 03:07:23 happy b43-phy0 ERROR: You must go to 
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and download the 
latest firmware (version 4).
Nov 16 03:07:23 happy b43-phy0 ERROR: Controller restart FAILED
Nov 16 03:07:25 happy wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - 
assume out of range
Nov 16 03:07:25 happy dhcpcd[12900]: wlan0: carrier lost

--y
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081116/f40a6c11/attachment.pgp>

From Larry.Finger at lwfinger.net  Sun Nov 16 06:24:14 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sat, 15 Nov 2008 23:24:14 -0600
Subject: BCM4312: interface does not show up
In-Reply-To: <5b21e64e0811151454o13a0282fy511c7cfc32637339@mail.gmail.com>
References: <5b21e64e0811151454o13a0282fy511c7cfc32637339@mail.gmail.com>
Message-ID: <491FAE7E.8090906@lwfinger.net>

??????????? ??????? wrote:
> Hi!
> 
> My problem is that upon b43 module load, no interface shows up.
> I would expect an eth1 or something from iwconfig but there are only
> lo and eth0 (wired).
> 
> I followed the instructions from the page
> http://linuxwireless.org/en/users/Drivers/b43
> I "cut" the firmware and install it to the proposed directory,
> exported the env var and then compiled the kernel.
> 
> I do not know how to tell kernel to look for the extracted firmware,
> there ware no instructions for such a thing.
> 
> When I "modprobe b43" the following modules are pulled automatically:
> b43                   134832  0
> ssb                    31364  1 b43
> rng_core                4744  1 b43
> mac80211              135692  1 b43
> cfg80211               25488  1 mac80211

If you have to modprobe b43 to get it to load, your device is not supported. You
can verify that with an '/sbin/lspci -nnv' command, and compare the codes in the
first line of the wireless device with the list of supported interfaces. For
example, my unit reports "[14e4:4311]".

If the device were supported, the driver would load the firmware from
/lib/modules/b43 with no further input by you.

Larry




From nicolas.2p.debian at free.fr  Sun Nov 16 19:23:47 2008
From: nicolas.2p.debian at free.fr (=?ISO-8859-1?Q?Nicolas_de_Peslo=FCan?=)
Date: Sun, 16 Nov 2008 19:23:47 +0100
Subject: ethtool / miitool / netif_carrier support in b43 ?
Message-ID: <49206533.8010406@free.fr>

Hi !

I'm currently using the following Wifi adapter :

06:00.0 Network controller [0280]: Broadcom Corporation BCM4306 
802.11b/g Wireless LAN Controller [14e4:4320] (rev 03)
         Subsystem: Device [17f9:0009]
         Flags: bus master, fast devsel, latency 64, IRQ 9
         Memory at 1c000000 (32-bit, non-prefetchable) [size=8K]
         Kernel driver in use: b43-pci-bridge
         Kernel modules: ssb

The adapter work properly when used directly (as wlan0).

Now, I want to bond this adapter with an Ethernet adapter, to be able to 
  switch from Ethernet to Wifi when I unplug the Ethernet wire, then 
switch back from Wifi to Ethernet when I plug the Ethernet wire back.

The AP and the Ethernet switch are the same box, so both Wifi and 
Ethernet are seen as a single L2.

I tried to setup a bonding configuration, having eth0 and wlan0 as the 
slaves of bond0. eth0 was setup as the primary slave, to take precedence 
when connected. The bond0 hardware address was set to the hardware 
address of wlan0, for obvious reasons.

Unfortunately, the test failed, because the bonding driver is apparently 
unable to retrieve the state of wlan0 (associated and hearing AP or not).

For as far as I understand, b43 does not support ethtool, nor miitool, 
not netif_carrier to retrieve the "carrier" state.

Can someone confirm ? Do I miss something ? Am I the only one trying 
such a stupid thing ?

Thanks,

	Nicolas.


From yuval at avramzon.net  Mon Nov 17 22:00:35 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Mon, 17 Nov 2008 23:00:35 +0200
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <491F1170.2010803@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
	<491F1170.2010803@lwfinger.net>
Message-ID: <200811172300.41873.yuval@avramzon.net>

On Saturday 15 November 2008, Larry Finger wrote:
> Peter Stuge wrote:
> > Yuval Hager wrote:
> >> HP Mini 2133
> >
> > I posted about the wifi in this guy a while back. It has ABG b43
> > which isn't really properly supported, at least not the A part but
> > the reaction I got from mentioning the chipset made me not expect too
> > much. I don't know if the ABG can be expected to behave exactly like
> > the BG when not using .11a. I doubt it.
>
> Wrong - if does. The B/G part of this BCM4312 is the same as the BCM4311. I
> think the card you asked about (also called the BCM4312) has an LP PHY,
> which is not supported.
>

How do I check that?

> > Yes. I expect it's the ABG causing problems because it isn't so well
> > known.
>
> No, I have one of these and it works perfectly in B/G mode - even with X.
> Of course, the A part doesn't work, but no problem.
>

I am eager to make it work. 
I've done numerous testing - changed xorg drivers, changed kernels (even tried 
ndis), but it still does not work satisfactory.
My current situation is with 2.6.28-r5 (the latest), and wifi works until it 
stops, and then I need to reboot. I am not sure what is the pattern - it is 
definitely not X nor KDE - I am not even sure if there is a pattern to it. 
I've enabled debug flags on the b43 and ssb, but I can't make anything 
sensible out of the logs.

Please let me know if you think there is something I can do in order to help 
you find the problem. I can give you ssh access to the machine if it helps.
Or maybe I should just give up? (I hate to give up!)

Thanks!

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081117/0baf76a5/attachment.pgp>

From Larry.Finger at lwfinger.net  Tue Nov 18 15:49:23 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Tue, 18 Nov 2008 08:49:23 -0600
Subject: [BCM4312][kernel 2.6.27] - wireless fails after X starts
In-Reply-To: <200811172300.41873.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
	<491F1170.2010803@lwfinger.net>
	<200811172300.41873.yuval@avramzon.net>
Message-ID: <4922D5F3.4030105@lwfinger.net>

Yuval Hager wrote:
> On Saturday 15 November 2008, Larry Finger wrote:
>> Peter Stuge wrote:
>>> Yuval Hager wrote:
>>>> HP Mini 2133
>>> I posted about the wifi in this guy a while back. It has ABG b43
>>> which isn't really properly supported, at least not the A part but
>>> the reaction I got from mentioning the chipset made me not expect too
>>> much. I don't know if the ABG can be expected to behave exactly like
>>> the BG when not using .11a. I doubt it.
>> Wrong - if does. The B/G part of this BCM4312 is the same as the BCM4311. I
>> think the card you asked about (also called the BCM4312) has an LP PHY,
>> which is not supported.
>>
> 
> How do I check that?

The critical part is the PCI ID, which is shown by the command '/sbin/lspci
-nnv'. From what you posted earlier, your device has a 0x4312 code, which is
fully supported. My statement above was wrong. Please post the complete output
of '/sbin/lspci'.

In thinking about your problem, it seems to me as if the memory mapping is being
set up wrong. It looks as if the routing to the registers of the BCM43XX device
are suddenly changed when X is started so that it references some completely new
region. Unfortunately, your dmesg buffer has wrapped around and that part of the
output has been lost. Please repost the dmesg output without starting X. The
output should start with something like:

BIOS EBDA/lowmem at: 0009e000/0009e000
Linux version 2.6.28-rc5-wl (finger at larrylap) (gcc version 4.3.1 20080507
(prerelease) [gcc-4_3-branch revision 135036] (SUSE Linux) ) #24 SMP Mon Nov 17
18:41:45 CST 2008

Are you generating your own kernel? If so, please send me your .config file.

As the amount of data I'm asking you to send is getting large, it might be best
if you reply privately to me. No need to pollute everyone's mailbox. Once I have
collected more information, I plan to post this problem on the Linux Kernel
Mailing List. I don't think this is a problem with the b43 driver, but some kind
of fatal interaction with memory management, probably due to some undetected
quirk in your system.

Larry


From richie at coderworld.net  Tue Nov 18 22:11:29 2008
From: richie at coderworld.net (Richard Jonsson)
Date: Tue, 18 Nov 2008 22:11:29 +0100
Subject: radio LED says active when radio disabled after resume
Message-ID: <1227042689.11225.47.camel@richie-laptop>

Hi!

I recently made a fresh install of ubuntu hardy, upgraded weeks later to
intrepid. I have not had a working suspend for some time, but now this
works. Including b43.

However, after every other suspend (to ram) the status led indicates
that rf-kill switch is in wlan enabled state, although it is not. No
matter if I switch it on and off will it change the LED status. The
system log says that hw status changed, and indeed wlan0 will show AP's
in enabled state, but not in disabled state.

I compared the dmesg outputs (posted below), and the only thing that
differs is the last lines:

Working:
wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
b43-phy0: Radio hardware status changed to DISABLED

Non-working (order changed):
b43-phy0: Radio hardware status changed to DISABLED
wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out

Also, when LED is working, I get these messages a few seconds after each
DISABLE, but not when LED is stuck:
[86215.196059] b43-phy0: Radio turned on by software
[86215.196078] b43-phy0: The hardware RF-kill button still turns the
radio physically off. Press the button to turn it on.

The LED used to work fine, but that was with an older ubuntu version,
and I believe it doesn't have to be a change in b43 that cause this
issue.

$ uname -a
Linux richie-laptop 2.6.27-7-generic #1 SMP Tue Nov 4 19:33:06 UTC 2008
x86_64 GNU/Linux

$ lspci -nnv -s 01:00.0
01:00.0 Network controller [0280]: Broadcom Corporation BCM4312
802.11a/b/g [14e4:4312] (rev 01)
	Subsystem: Hewlett-Packard Company Device [103c:1361]
	Flags: bus master, fast devsel, latency 0, IRQ 19
	Memory at b3000000 (32-bit, non-prefetchable) [size=16K]
	Capabilities: <access denied>
	Kernel driver in use: b43-pci-bridge
	Kernel modules: ssb, wl

Computer is a HP dv2140eu (dv2000) laptop.

Suspend-resume cycle after which LED is working:
$ dmesg
[86186.424108] PM: Syncing filesystems ... done.
[86186.424170] PM: Preparing system for mem sleep
[86186.424174] Freezing user space processes ... (elapsed 0.05 seconds)
done.
[86186.476709] Freezing remaining freezable tasks ... (elapsed 0.00
seconds) done.
[86186.476816] PM: Entering mem sleep
[86186.476819] Suspending console(s) (use no_console_suspend to debug)
[86186.477279] sd 2:0:0:0: [sda] Synchronizing SCSI cache
[86186.801333] sd 2:0:0:0: [sda] Stopping disk
[86187.773538] ACPI handle has no context!
[86187.773547] sdhci-pci 0000:05:09.1: PCI INT B disabled
[86187.773552] ACPI handle has no context!
[86187.792067] ACPI handle has no context!
[86187.808090] b43-pci-bridge 0000:01:00.0: PCI INT A disabled
[86187.824284] forcedeth 0000:00:14.0: wake-up capability disabled by
ACPI
[86187.824288] forcedeth 0000:00:14.0: PME# disabled
[86187.856294] HDA Intel 0000:00:10.1: PCI INT B disabled
[86187.872145] sata_nv 0000:00:0e.0: PCI INT A disabled
[86187.904075] ehci_hcd 0000:00:0b.1: PCI INT B disabled
[86187.920066] ohci_hcd 0000:00:0b.0: PCI INT A disabled
[86187.936051] ohci_hcd 0000:00:0b.0: PME# enabled
[86187.936056] ohci_hcd 0000:00:0b.0: PME# enabled
[86187.936227] NVRM: RmPowerManagement: 4
[86189.254369] PM: suspend devices took 2.776 seconds
[86189.332103] ACPI: Preparing to enter system sleep state S3
[86189.452347] Disabling non-boot CPUs ...
[86189.452524] kvm: disabling virtualization on CPU1
[86189.454755] CPU 1 is now offline
[86189.454757] SMP alternatives: switching to UP code
[86189.470859] CPU0 attaching NULL sched-domain.
[86189.470863] CPU1 attaching NULL sched-domain.
[86189.484044] CPU0 attaching sched-domain:
[86189.484047]  domain 0: span 0 level NODE
[86189.484050]   groups: 0
[86189.484355] CPU1 is down
[86189.484491] Extended CMOS year: 2000
[86189.484491] Back to C!
[86189.484491] Extended CMOS year: 2000
[86189.488346] Enabling non-boot CPUs ...
[86189.488637] SMP alternatives: switching to SMP code
[86189.504900] Booting processor 1/1 ip 6000
[86189.456517] Initializing CPU#1
[86189.456517] Calibrating delay using timer specific routine.. 3214.72
BogoMIPS (lpj=6429457)
[86189.456517] CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (64
bytes/line)
[86189.456517] CPU: L2 Cache: 512K (64 bytes/line)
[86189.456517] CPU 1/1 -> Node 0
[86189.456517] CPU: Physical Processor ID: 0
[86189.456517] CPU: Processor Core ID: 1
[86189.456517] Switch to broadcast mode on CPU1
[86189.592230] CPU1: AMD Turion(tm) 64 X2  stepping 02
[86189.592237] kvm: enabling virtualization on CPU1
[86189.592272] CPU0 attaching NULL sched-domain.
[86189.596039] Switched to high resolution mode on CPU 1
[86189.604050] CPU0 attaching sched-domain:
[86189.604054]  domain 0: span 0-1 level MC
[86189.604056]   groups: 0 1
[86189.604059]   domain 1: span 0-1 level CPU
[86189.604061]    groups: 0-1
[86189.604064]    domain 2: span 0-1 level NODE
[86189.604066]     groups: 0-1
[86189.604069] CPU1 attaching sched-domain:
[86189.604071]  domain 0: span 0-1 level MC
[86189.604073]   groups: 1 0
[86189.604076]   domain 1: span 0-1 level CPU
[86189.604077]    groups: 0-1
[86189.604080]    domain 2: span 0-1 level NODE
[86189.604081]     groups: 0-1
[86189.604721] CPU1 is up
[86189.604724] ACPI: Waking up from system sleep state S3
[86190.844709] ACPI: EC: non-query interrupt received, switching to
interrupt mode
[86190.948437] pcieport-driver 0000:00:02.0: restoring config space at
offset 0xf (was 0x0, writing 0x400ff)
[86190.948443] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x9 (was 0x10011, writing 0x1fff1)
[86190.948447] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x8 (was 0x10, writing 0xb300b300)
[86190.948451] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x7 (was 0x101, writing 0x1f1)
[86190.948455] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x6 (was 0x0, writing 0x20100)
[86190.948459] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x3 (was 0x10000, writing 0x10010)
[86190.948463] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x1 (was 0x100000, writing 0x100407)
[86190.948480] pcieport-driver 0000:00:02.0: setting latency timer to 64
[86190.948493] pcieport-driver 0000:00:03.0: restoring config space at
offset 0xf (was 0x0, writing 0x400ff)
[86190.948498] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x9 (was 0x10011, writing 0xd011d001)
[86190.948502] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x8 (was 0x10, writing 0xb7f0b400)
[86190.948506] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x7 (was 0x101, writing 0x4141)
[86190.948509] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x6 (was 0x0, writing 0x40300)
[86190.948514] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x3 (was 0x10000, writing 0x10010)
[86190.948518] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x1 (was 0x100000, writing 0x100407)
[86190.948533] pcieport-driver 0000:00:03.0: setting latency timer to 64
[86190.948554] NVRM: RmPowerManagement: 5
[86191.496957] pci 0000:00:0a.3: restoring config space at offset 0xf
(was 0x1030200, writing 0x103020b)
[86191.497017] ohci_hcd 0000:00:0b.0: PME# disabled
[86191.497022] ohci_hcd 0000:00:0b.0: PME# disabled
[86191.512058] ohci_hcd 0000:00:0b.0: PCI INT A -> Link[LUS0] -> GSI 23
(level, high) -> IRQ 23
[86191.512063] ohci_hcd 0000:00:0b.0: setting latency timer to 64
[86191.552046] ehci_hcd 0000:00:0b.1: PCI INT B -> Link[LUS2] -> GSI 22
(level, high) -> IRQ 22
[86191.552050] ehci_hcd 0000:00:0b.1: setting latency timer to 64
[86191.568046] pata_amd 0000:00:0d.0: setting latency timer to 64
[86191.584055] sata_nv 0000:00:0e.0: restoring config space at offset
0x1 (was 0xb00005, writing 0xb00007)
[86191.584070] sata_nv 0000:00:0e.0: PCI INT A -> Link[LTID] -> GSI 18
(level, high) -> IRQ 18
[86191.584074] sata_nv 0000:00:0e.0: setting latency timer to 64
[86191.584305] pci 0000:00:10.0: setting latency timer to 64
[86191.600037] HDA Intel 0000:00:10.1: restoring config space at offset
0xf (was 0x5020200, writing 0x502020a)
[86191.600048] HDA Intel 0000:00:10.1: restoring config space at offset
0x4 (was 0x0, writing 0xb0000000)
[86191.600054] HDA Intel 0000:00:10.1: restoring config space at offset
0x1 (was 0xb00000, writing 0xb00002)
[86191.600068] HDA Intel 0000:00:10.1: PCI INT B -> Link[LAZA] -> GSI 22
(level, high) -> IRQ 22
[86191.600074] HDA Intel 0000:00:10.1: setting latency timer to 64
[86191.616050] forcedeth 0000:00:14.0: wake-up capability disabled by
ACPI
[86191.616054] forcedeth 0000:00:14.0: PME# disabled
[86191.632037] b43-pci-bridge 0000:01:00.0: enabling device (0000 ->
0002)
[86191.632043] b43-pci-bridge 0000:01:00.0: PCI INT A -> Link[LK2E] ->
GSI 19 (level, high) -> IRQ 19
[86191.632058] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0xf (was 0x100, writing 0x10a)
[86191.632073] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x4 (was 0x0, writing 0xb3000000)
[86191.632077] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x3 (was 0x0, writing 0x10)
[86191.632083] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x1 (was 0x100002, writing 0x100007)
[86191.668047] ohci1394 0000:05:09.0: restoring config space at offset
0xf (was 0x4020100, writing 0x402010a)
[86191.668061] ohci1394 0000:05:09.0: restoring config space at offset
0x4 (was 0xc3100000, writing 0xb8000000)
[86191.668065] ohci1394 0000:05:09.0: restoring config space at offset
0x3 (was 0x800000, writing 0x804000)
[86191.668071] ohci1394 0000:05:09.0: restoring config space at offset
0x1 (was 0x2100000, writing 0x2100006)
[86191.719688] ohci1394: fw-host0: OHCI-1394 1.1 (PCI): IRQ=[16]
MMIO=[b8000000-b80007ff]  Max Packet=[2048]  IR/IT contexts=[4/4]
[86191.737367] ata2.00: ACPI cmd ef/03:42:00:00:00:a0 filtered out
[86191.737370] ata2.00: ACPI cmd ef/03:08:00:00:00:a0 filtered out
[86191.737389] ata2: nv_mode_filter: 0x1&0x7001->0x1, BIOS=0x0 (0x0)
ACPI=0x7001 (60:600:0x11)
[86191.752338] ata2.00: configured for PIO0
[86191.752353] sdhci-pci 0000:05:09.1: restoring config space at offset
0xf (was 0x200, writing 0x20b)
[86191.752368] sdhci-pci 0000:05:09.1: restoring config space at offset
0x4 (was 0x0, writing 0xb8000800)
[86191.752372] sdhci-pci 0000:05:09.1: restoring config space at offset
0x3 (was 0x800000, writing 0x804000)
[86191.752378] sdhci-pci 0000:05:09.1: restoring config space at offset
0x1 (was 0x2100000, writing 0x2100006)
[86191.752391] sdhci-pci 0000:05:09.1: PCI INT B -> Link[LNK2] -> GSI 23
(level, high) -> IRQ 23
[86191.753399] pci 0000:05:09.2: restoring config space at offset 0xf
(was 0x200, writing 0x20b)
[86191.753414] pci 0000:05:09.2: restoring config space at offset 0x4
(was 0x0, writing 0xb8000c00)
[86191.753420] pci 0000:05:09.2: restoring config space at offset 0x1
(was 0x2100000, writing 0x2100002)
[86191.753434] pci 0000:05:09.3: restoring config space at offset 0xf
(was 0x200, writing 0x20b)
[86191.753449] pci 0000:05:09.3: restoring config space at offset 0x4
(was 0x0, writing 0xb8001000)
[86191.753455] pci 0000:05:09.3: restoring config space at offset 0x1
(was 0x2100000, writing 0x2100002)
[86191.918698] ata4: SATA link down (SStatus 0 SControl 300)
[86192.016044] usb 2-8: reset high speed USB device using ehci_hcd and
address 2
[86192.076079] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 300)
[86192.084240] ata3.00: ACPI cmd ef/03:46:00:00:00:a0 filtered out
[86192.100405] ata3.00: configured for UDMA/100
[86192.100470] sd 2:0:0:0: [sda] 312581808 512-byte hardware sectors
(160042 MB)
[86192.100493] sd 2:0:0:0: [sda] Write Protect is off
[86192.100495] sd 2:0:0:0: [sda] Mode Sense: 00 3a 00 00
[86192.100533] sd 2:0:0:0: [sda] Write cache: enabled, read cache:
enabled, doesn't support DPO or FUA
[86192.157332] uvcvideo 2-8:1.0: no reset_resume for driver uvcvideo?
[86192.157335] uvcvideo 2-8:1.1: no reset_resume for driver uvcvideo?
[86192.168102] sd 2:0:0:0: [sda] Starting disk
[86192.211482] uvcvideo: Found UVC 1.00 device USB 2.0 Camera
(0c45:62c0)
[86192.212934] input: USB 2.0 Camera
as /devices/pci0000:00/0000:00:0b.1/usb2/2-8/2-8:1.0/input/input21
[86192.224455] PM: resume devices took 1.700 seconds
[86192.224488] PM: Finishing wakeup.
[86192.224490] Restarting tasks ... done.
[86192.879844] eth0: no link during initialization.
[86192.880421] ADDRCONF(NETDEV_UP): eth0: link is not ready
[86194.576660] input: b43-phy0 as /devices/virtual/input/input22
[86194.781050] b43-phy0: Loading firmware version 351.126 (2006-07-29
05:54:02)
[86194.781061] b43-phy0 warning: You are using an old firmware image.
Support for old firmware will be removed in July 2008.
[86194.781067] b43-phy0 warning: You must go to
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and
download the latest firmware (version 4).
[86194.920587] Registered led device: b43-phy0::tx
[86194.920618] Registered led device: b43-phy0::rx
[86194.920642] Registered led device: b43-phy0::radio
[86194.945153] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86194.945602] ADDRCONF(NETDEV_UP): wlan0: link is not ready
[86194.956228] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86195.156058] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86195.356053] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86195.552042] wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
[86195.585048] b43-phy0: Radio hardware status changed to DISABLED
[86215.196059] b43-phy0: Radio turned on by software
[86215.196078] b43-phy0: The hardware RF-kill button still turns the
radio physically off. Press the button to turn it on.

After flicking switch on and off:
[86369.816069] b43-phy0: Radio hardware status changed to ENABLED
[86374.860057] b43-phy0: Radio hardware status changed to DISABLED


Suspend-resume cycle after which LED is stuck in ON mode:
[86820.319695] PM: Syncing filesystems ... done.
[86820.319766] PM: Preparing system for mem sleep
[86820.319770] Freezing user space processes ... (elapsed 0.00 seconds)
done.
[86820.321963] Freezing remaining freezable tasks ... (elapsed 0.00
seconds) done.
[86820.322082] PM: Entering mem sleep
[86820.322085] Suspending console(s) (use no_console_suspend to debug)
[86820.322541] sd 2:0:0:0: [sda] Synchronizing SCSI cache
[86820.545229] sd 2:0:0:0: [sda] Stopping disk
[86821.517541] ACPI handle has no context!
[86821.517550] sdhci-pci 0000:05:09.1: PCI INT B disabled
[86821.517555] ACPI handle has no context!
[86821.536081] ACPI handle has no context!
[86821.552084] b43-pci-bridge 0000:01:00.0: PCI INT A disabled
[86821.568279] forcedeth 0000:00:14.0: wake-up capability disabled by
ACPI
[86821.568282] forcedeth 0000:00:14.0: PME# disabled
[86821.584051] HDA Intel 0000:00:10.1: PCI INT B disabled
[86821.600140] sata_nv 0000:00:0e.0: PCI INT A disabled
[86821.632074] ehci_hcd 0000:00:0b.1: PCI INT B disabled
[86821.648075] ohci_hcd 0000:00:0b.0: PCI INT A disabled
[86821.664036] ohci_hcd 0000:00:0b.0: PME# enabled
[86821.664041] ohci_hcd 0000:00:0b.0: PME# enabled
[86821.664212] NVRM: RmPowerManagement: 4
[86822.981893] PM: suspend devices took 2.660 seconds
[86823.060098] ACPI: Preparing to enter system sleep state S3
[86823.180351] Disabling non-boot CPUs ...
[86823.180530] kvm: disabling virtualization on CPU1
[86823.284026] CPU 1 is now offline
[86823.284029] SMP alternatives: switching to UP code
[86823.300083] CPU0 attaching NULL sched-domain.
[86823.300088] CPU1 attaching NULL sched-domain.
[86823.316050] CPU0 attaching sched-domain:
[86823.316053]  domain 0: span 0 level NODE
[86823.316056]   groups: 0
[86823.316374] CPU1 is down
[86823.316509] Extended CMOS year: 2000
[86823.316509] Back to C!
[86823.316509] Extended CMOS year: 2000
[86823.320367] Enabling non-boot CPUs ...
[86823.320657] SMP alternatives: switching to SMP code
[86823.336870] Booting processor 1/1 ip 6000
[86823.184523] Initializing CPU#1
[86823.184523] Calibrating delay using timer specific routine.. 3214.71
BogoMIPS (lpj=6429439)
[86823.184523] CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (64
bytes/line)
[86823.184523] CPU: L2 Cache: 512K (64 bytes/line)
[86823.184523] CPU 1/1 -> Node 0
[86823.184523] CPU: Physical Processor ID: 0
[86823.184523] CPU: Processor Core ID: 1
[86823.184523] Switch to broadcast mode on CPU1
[86823.424208] CPU1: AMD Turion(tm) 64 X2  stepping 02
[86823.424215] kvm: enabling virtualization on CPU1
[86823.424250] CPU0 attaching NULL sched-domain.
[86823.428041] Switched to high resolution mode on CPU 1
[86823.436040] CPU0 attaching sched-domain:
[86823.436043]  domain 0: span 0-1 level MC
[86823.436045]   groups: 0 1
[86823.436049]   domain 1: span 0-1 level CPU
[86823.436051]    groups: 0-1
[86823.436053]    domain 2: span 0-1 level NODE
[86823.436055]     groups: 0-1
[86823.436059] CPU1 attaching sched-domain:
[86823.436060]  domain 0: span 0-1 level MC
[86823.436062]   groups: 1 0
[86823.436065]   domain 1: span 0-1 level CPU
[86823.436066]    groups: 0-1
[86823.436068]    domain 2: span 0-1 level NODE
[86823.436071]     groups: 0-1
[86823.436723] CPU1 is up
[86823.436725] ACPI: Waking up from system sleep state S3
[86824.676831] ACPI: EC: non-query interrupt received, switching to
interrupt mode
[86824.780257] pcieport-driver 0000:00:02.0: restoring config space at
offset 0xf (was 0x0, writing 0x400ff)
[86824.780264] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x9 (was 0x10011, writing 0x1fff1)
[86824.780267] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x8 (was 0x10, writing 0xb300b300)
[86824.780271] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x7 (was 0x101, writing 0x1f1)
[86824.780275] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x6 (was 0x0, writing 0x20100)
[86824.780279] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x3 (was 0x10000, writing 0x10010)
[86824.780284] pcieport-driver 0000:00:02.0: restoring config space at
offset 0x1 (was 0x100000, writing 0x100407)
[86824.780300] pcieport-driver 0000:00:02.0: setting latency timer to 64
[86824.780313] pcieport-driver 0000:00:03.0: restoring config space at
offset 0xf (was 0x0, writing 0x400ff)
[86824.780318] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x9 (was 0x10011, writing 0xd011d001)
[86824.780322] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x8 (was 0x10, writing 0xb7f0b400)
[86824.780326] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x7 (was 0x101, writing 0x4141)
[86824.780330] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x6 (was 0x0, writing 0x40300)
[86824.780334] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x3 (was 0x10000, writing 0x10010)
[86824.780338] pcieport-driver 0000:00:03.0: restoring config space at
offset 0x1 (was 0x100000, writing 0x100407)
[86824.780353] pcieport-driver 0000:00:03.0: setting latency timer to 64
[86824.780374] NVRM: RmPowerManagement: 5
[86825.328719] pci 0000:00:0a.3: restoring config space at offset 0xf
(was 0x1030200, writing 0x103020b)
[86825.328771] ohci_hcd 0000:00:0b.0: PME# disabled
[86825.328776] ohci_hcd 0000:00:0b.0: PME# disabled
[86825.344054] ohci_hcd 0000:00:0b.0: PCI INT A -> Link[LUS0] -> GSI 23
(level, high) -> IRQ 23
[86825.344059] ohci_hcd 0000:00:0b.0: setting latency timer to 64
[86825.384044] ehci_hcd 0000:00:0b.1: PCI INT B -> Link[LUS2] -> GSI 22
(level, high) -> IRQ 22
[86825.384048] ehci_hcd 0000:00:0b.1: setting latency timer to 64
[86825.400051] pata_amd 0000:00:0d.0: setting latency timer to 64
[86825.416061] sata_nv 0000:00:0e.0: restoring config space at offset
0x1 (was 0xb00005, writing 0xb00007)
[86825.416076] sata_nv 0000:00:0e.0: PCI INT A -> Link[LTID] -> GSI 18
(level, high) -> IRQ 18
[86825.416080] sata_nv 0000:00:0e.0: setting latency timer to 64
[86825.416311] pci 0000:00:10.0: setting latency timer to 64
[86825.432047] HDA Intel 0000:00:10.1: restoring config space at offset
0xf (was 0x5020200, writing 0x502020a)
[86825.432059] HDA Intel 0000:00:10.1: restoring config space at offset
0x4 (was 0x0, writing 0xb0000000)
[86825.432064] HDA Intel 0000:00:10.1: restoring config space at offset
0x1 (was 0xb00000, writing 0xb00002)
[86825.432078] HDA Intel 0000:00:10.1: PCI INT B -> Link[LAZA] -> GSI 22
(level, high) -> IRQ 22
[86825.432083] HDA Intel 0000:00:10.1: setting latency timer to 64
[86825.448058] forcedeth 0000:00:14.0: wake-up capability disabled by
ACPI
[86825.448062] forcedeth 0000:00:14.0: PME# disabled
[86825.464042] b43-pci-bridge 0000:01:00.0: enabling device (0000 ->
0002)
[86825.464048] b43-pci-bridge 0000:01:00.0: PCI INT A -> Link[LK2E] ->
GSI 19 (level, high) -> IRQ 19
[86825.464063] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0xf (was 0x100, writing 0x10a)
[86825.464077] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x4 (was 0x0, writing 0xb3000000)
[86825.464082] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x3 (was 0x0, writing 0x10)
[86825.464088] b43-pci-bridge 0000:01:00.0: restoring config space at
offset 0x1 (was 0x100002, writing 0x100007)
[86825.500026] ohci1394 0000:05:09.0: restoring config space at offset
0xf (was 0x4020100, writing 0x402010a)
[86825.500040] ohci1394 0000:05:09.0: restoring config space at offset
0x4 (was 0xc3100000, writing 0xb8000000)
[86825.500045] ohci1394 0000:05:09.0: restoring config space at offset
0x3 (was 0x800000, writing 0x804000)
[86825.500051] ohci1394 0000:05:09.0: restoring config space at offset
0x1 (was 0x2100000, writing 0x2100006)
[86825.551668] ohci1394: fw-host0: OHCI-1394 1.1 (PCI): IRQ=[16]
MMIO=[b8000000-b80007ff]  Max Packet=[2048]  IR/IT contexts=[4/4]
[86825.569352] ata2.00: ACPI cmd ef/03:42:00:00:00:a0 filtered out
[86825.569355] ata2.00: ACPI cmd ef/03:08:00:00:00:a0 filtered out
[86825.569374] ata2: nv_mode_filter: 0x1&0x7001->0x1, BIOS=0x0 (0x0)
ACPI=0x7001 (60:600:0x11)
[86825.584348] ata2.00: configured for PIO0
[86825.584362] sdhci-pci 0000:05:09.1: restoring config space at offset
0xf (was 0x200, writing 0x20b)
[86825.584377] sdhci-pci 0000:05:09.1: restoring config space at offset
0x4 (was 0x0, writing 0xb8000800)
[86825.584382] sdhci-pci 0000:05:09.1: restoring config space at offset
0x3 (was 0x800000, writing 0x804000)
[86825.584388] sdhci-pci 0000:05:09.1: restoring config space at offset
0x1 (was 0x2100000, writing 0x2100006)
[86825.584400] sdhci-pci 0000:05:09.1: PCI INT B -> Link[LNK2] -> GSI 23
(level, high) -> IRQ 23
[86825.585409] pci 0000:05:09.2: restoring config space at offset 0xf
(was 0x200, writing 0x20b)
[86825.585423] pci 0000:05:09.2: restoring config space at offset 0x4
(was 0x0, writing 0xb8000c00)
[86825.585430] pci 0000:05:09.2: restoring config space at offset 0x1
(was 0x2100000, writing 0x2100002)
[86825.585444] pci 0000:05:09.3: restoring config space at offset 0xf
(was 0x200, writing 0x20b)
[86825.585459] pci 0000:05:09.3: restoring config space at offset 0x4
(was 0x0, writing 0xb8001000)
[86825.585465] pci 0000:05:09.3: restoring config space at offset 0x1
(was 0x2100000, writing 0x2100002)
[86825.750684] ata4: SATA link down (SStatus 0 SControl 300)
[86825.848052] usb 2-8: reset high speed USB device using ehci_hcd and
address 2
[86825.908080] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 300)
[86825.916222] ata3.00: ACPI cmd ef/03:46:00:00:00:a0 filtered out
[86825.932402] ata3.00: configured for UDMA/100
[86825.932467] sd 2:0:0:0: [sda] 312581808 512-byte hardware sectors
(160042 MB)
[86825.932490] sd 2:0:0:0: [sda] Write Protect is off
[86825.932493] sd 2:0:0:0: [sda] Mode Sense: 00 3a 00 00
[86825.932530] sd 2:0:0:0: [sda] Write cache: enabled, read cache:
enabled, doesn't support DPO or FUA
[86825.989332] uvcvideo 2-8:1.0: no reset_resume for driver uvcvideo?
[86825.989335] uvcvideo 2-8:1.1: no reset_resume for driver uvcvideo?
[86826.000131] sd 2:0:0:0: [sda] Starting disk
[86826.039476] uvcvideo: Found UVC 1.00 device USB 2.0 Camera
(0c45:62c0)
[86826.040935] input: USB 2.0 Camera
as /devices/pci0000:00/0000:00:0b.1/usb2/2-8/2-8:1.0/input/input23
[86826.052449] PM: resume devices took 1.696 seconds
[86826.052481] PM: Finishing wakeup.
[86826.052483] Restarting tasks ... done.
[86826.383938] eth0: no link during initialization.
[86826.384566] ADDRCONF(NETDEV_UP): eth0: link is not ready
[86826.397250] input: b43-phy0 as /devices/virtual/input/input24
[86828.024071] b43-phy0: Loading firmware version 351.126 (2006-07-29
05:54:02)
[86828.024082] b43-phy0 warning: You are using an old firmware image.
Support for old firmware will be removed in July 2008.
[86828.024087] b43-phy0 warning: You must go to
http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and
download the latest firmware (version 4).
[86828.164378] Registered led device: b43-phy0::tx
[86828.164438] Registered led device: b43-phy0::rx
[86828.164462] Registered led device: b43-phy0::radio
[86828.216338] ADDRCONF(NETDEV_UP): wlan0: link is not ready
[86828.217508] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86828.416031] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86828.616039] wlan0: authenticate with AP 00:14:c1:1d:19:f0
[86828.800101] b43-phy0: Radio hardware status changed to DISABLED
[86828.816037] wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out

Again, after flicking the switch on and off:
[87068.805050] b43-phy0: Radio hardware status changed to ENABLED
[87072.804082] b43-phy0: Radio hardware status changed to DISABLED



From Larry.Finger at lwfinger.net  Wed Nov 19 01:33:26 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Tue, 18 Nov 2008 18:33:26 -0600
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <1227042689.11225.47.camel@richie-laptop>
References: <1227042689.11225.47.camel@richie-laptop>
Message-ID: <49235ED6.4010909@lwfinger.net>

Richard Jonsson wrote:
> Hi!
> 
> I recently made a fresh install of ubuntu hardy, upgraded weeks later to
> intrepid. I have not had a working suspend for some time, but now this
> works. Including b43.
> 
> However, after every other suspend (to ram) the status led indicates
> that rf-kill switch is in wlan enabled state, although it is not. No
> matter if I switch it on and off will it change the LED status. The
> system log says that hw status changed, and indeed wlan0 will show AP's
> in enabled state, but not in disabled state.
> 
> I compared the dmesg outputs (posted below), and the only thing that
> differs is the last lines:
> 
> Working:
> wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
> b43-phy0: Radio hardware status changed to DISABLED
> 
> Non-working (order changed):
> b43-phy0: Radio hardware status changed to DISABLED
> wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
> 
> Also, when LED is working, I get these messages a few seconds after each
> DISABLE, but not when LED is stuck:
> [86215.196059] b43-phy0: Radio turned on by software
> [86215.196078] b43-phy0: The hardware RF-kill button still turns the
> radio physically off. Press the button to turn it on.
> 
> The LED used to work fine, but that was with an older ubuntu version,
> and I believe it doesn't have to be a change in b43 that cause this
> issue.

I don't even try suspend/resume so I cannot help you there, but b43 cannot
control the radio hardware status enable/disable bit. It is read-only from the
driver. It must be the RFKILL or LED subsystems that are getting lost and/or
confused.

If you unload b43 using 'sudo /sbin/modprobe -r b43' before suspending and 'sudo
/sbin/modprobe b43' to load it after resuming, what happens?

Larry



From mark.hagger at m-spatial.com  Wed Nov 19 10:23:16 2008
From: mark.hagger at m-spatial.com (Mark Hagger)
Date: Wed, 19 Nov 2008 09:23:16 +0000
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <1227042689.11225.47.camel@richie-laptop>
References: <1227042689.11225.47.camel@richie-laptop>
Message-ID: <1227086596.22193.81.camel@giga.cambridge.m-spatial.com>

On Tue, 2008-11-18 at 22:11 +0100, Richard Jonsson wrote:

> [86826.397250] input: b43-phy0 as /devices/virtual/input/input24
> [86828.024071] b43-phy0: Loading firmware version 351.126 (2006-07-29
> 05:54:02)
> [86828.024082] b43-phy0 warning: You are using an old firmware image.
> Support for old firmware will be removed in July 2008.
> [86828.024087] b43-phy0 warning: You must go to
> http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and
> download the latest firmware (version 4).

I assume this has no impact at all on your particular problem, but is
there any reason why you are still using the old firmware version?  You
do know we're quite a long way past July 2008?

Mark



________________________________________________________________________
This email has been scanned for all known viruses by the MessageLabs SkyScan service.


From richie at coderworld.net  Wed Nov 19 18:03:01 2008
From: richie at coderworld.net (Richard Jonsson)
Date: Wed, 19 Nov 2008 18:03:01 +0100
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <49235ED6.4010909@lwfinger.net>
References: <1227042689.11225.47.camel@richie-laptop>
	<49235ED6.4010909@lwfinger.net>
Message-ID: <1227114181.11225.54.camel@richie-laptop>

tis 2008-11-18 klockan 18:33 -0600 skrev Larry Finger:
> Richard Jonsson wrote:
> > Hi!
> > 
> > I recently made a fresh install of ubuntu hardy, upgraded weeks later to
> > intrepid. I have not had a working suspend for some time, but now this
> > works. Including b43.
> > 
> > However, after every other suspend (to ram) the status led indicates
> > that rf-kill switch is in wlan enabled state, although it is not. No
> > matter if I switch it on and off will it change the LED status. The
> > system log says that hw status changed, and indeed wlan0 will show AP's
> > in enabled state, but not in disabled state.
> > 
> > I compared the dmesg outputs (posted below), and the only thing that
> > differs is the last lines:
> > 
> > Working:
> > wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
> > b43-phy0: Radio hardware status changed to DISABLED
> > 
> > Non-working (order changed):
> > b43-phy0: Radio hardware status changed to DISABLED
> > wlan0: authentication with AP 00:14:c1:1d:19:f0 timed out
> > 
> > Also, when LED is working, I get these messages a few seconds after each
> > DISABLE, but not when LED is stuck:
> > [86215.196059] b43-phy0: Radio turned on by software
> > [86215.196078] b43-phy0: The hardware RF-kill button still turns the
> > radio physically off. Press the button to turn it on.
> > 
> > The LED used to work fine, but that was with an older ubuntu version,
> > and I believe it doesn't have to be a change in b43 that cause this
> > issue.
> 
> I don't even try suspend/resume so I cannot help you there, but b43 cannot
> control the radio hardware status enable/disable bit. It is read-only from the
> driver. It must be the RFKILL or LED subsystems that are getting lost and/or
> confused.
> 
> If you unload b43 using 'sudo /sbin/modprobe -r b43' before suspending and 'sudo
> /sbin/modprobe b43' to load it after resuming, what happens?
> 
> Larry
> 
Thanks for the quick reply.

There is no difference, also I tested to unload and load b43 without
suspend. The same thing happens. Turns out suspend has nothing to do
with it.

To summarize, every other load of b43 causes the LED to be always
active.

/ Richard


From richie at coderworld.net  Wed Nov 19 18:08:51 2008
From: richie at coderworld.net (Richard Jonsson)
Date: Wed, 19 Nov 2008 18:08:51 +0100
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <1227086596.22193.81.camel@giga.cambridge.m-spatial.com>
References: <1227042689.11225.47.camel@richie-laptop>
	<1227086596.22193.81.camel@giga.cambridge.m-spatial.com>
Message-ID: <1227114531.11225.60.camel@richie-laptop>

ons 2008-11-19 klockan 09:23 +0000 skrev Mark Hagger:
> On Tue, 2008-11-18 at 22:11 +0100, Richard Jonsson wrote:
> 
> > [86826.397250] input: b43-phy0 as /devices/virtual/input/input24
> > [86828.024071] b43-phy0: Loading firmware version 351.126 (2006-07-29
> > 05:54:02)
> > [86828.024082] b43-phy0 warning: You are using an old firmware image.
> > Support for old firmware will be removed in July 2008.
> > [86828.024087] b43-phy0 warning: You must go to
> > http://linuxwireless.org/en/users/Drivers/b43#devicefirmware and
> > download the latest firmware (version 4).
> 
> I assume this has no impact at all on your particular problem, but is
> there any reason why you are still using the old firmware version?  You
> do know we're quite a long way past July 2008?
> 
> Mark
To be honest it's both laziness and ignorance. Ubuntu has a scripted
firmware install, which I used to get mine.
Since you mention it I will test just to be sure.

thanks, Richard


From richie at coderworld.net  Wed Nov 19 18:25:29 2008
From: richie at coderworld.net (Richard Jonsson)
Date: Wed, 19 Nov 2008 18:25:29 +0100
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <1227086596.22193.81.camel@giga.cambridge.m-spatial.com>
References: <1227042689.11225.47.camel@richie-laptop>
	<1227086596.22193.81.camel@giga.cambridge.m-spatial.com>
Message-ID: <1227115529.11225.63.camel@richie-laptop>

I've now upgraded the firmware, no difference. Also considering filing a
bug report about fw to ubuntu.

/ Richard


From Larry.Finger at lwfinger.net  Thu Nov 20 16:29:01 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Thu, 20 Nov 2008 09:29:01 -0600
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <1227114181.11225.54.camel@richie-laptop>
References: <1227042689.11225.47.camel@richie-laptop>	
	<49235ED6.4010909@lwfinger.net>
	<1227114181.11225.54.camel@richie-laptop>
Message-ID: <4925823D.5050208@lwfinger.net>

Richard Jonsson wrote:
> There is no difference, also I tested to unload and load b43 without
> suspend. The same thing happens. Turns out suspend has nothing to do
> with it.
> 
> To summarize, every other load of b43 causes the LED to be always
> active.

What format is your card - PCI, Cardbus, or what?

When you do an lsmod command, do the following modules appear?

b43, ssb, mac80211, cfg80211, led-class, input-polldev, rfkill_input, and rfkill

Thanks,

Larry



From richie at coderworld.net  Thu Nov 20 20:23:21 2008
From: richie at coderworld.net (Richard Jonsson)
Date: Thu, 20 Nov 2008 20:23:21 +0100
Subject: radio LED says active when radio disabled after resume
In-Reply-To: <4925823D.5050208@lwfinger.net>
References: <1227042689.11225.47.camel@richie-laptop>
	<49235ED6.4010909@lwfinger.net>
	<1227114181.11225.54.camel@richie-laptop>
	<4925823D.5050208@lwfinger.net>
Message-ID: <1227209001.11225.100.camel@richie-laptop>

tor 2008-11-20 klockan 09:29 -0600 skrev Larry Finger:
> Richard Jonsson wrote:
> > There is no difference, also I tested to unload and load b43 without
> > suspend. The same thing happens. Turns out suspend has nothing to do
> > with it.
> > 
> > To summarize, every other load of b43 causes the LED to be always
> > active.
> 
> What format is your card - PCI, Cardbus, or what?
> 
4311 on pci-express, lspci says "01:00.0 Network controller: Broadcom
Corporation BCM4312 802.11a/b/g (rev 01)"
I noticed the ubuntu kernel doesn't have debugging on. I tried to dig up
an old dmesg card id output to provide, but to no avail.

> When you do an lsmod command, do the following modules appear?
> 
> b43, ssb, mac80211, cfg80211, led-class, input-polldev, rfkill_input, and rfkill
> 
b43                   144424  0 
ssb                    46340  1 b43
mac80211              253440  1 b43
cfg80211               37136  1 mac80211
led_class              13192  1 b43
input_polldev          12816  1 b43
rfkill_input           14080  0 
rfkill                 19364  3 b43,rfkill_input

I diff'ed the output of lsmod in state "LED works" and "LED always on"
and they are identical.

> Thanks,
> 
> Larry
> 
regards, Richard


From Larry.Finger at lwfinger.net  Fri Nov 21 17:25:22 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Fri, 21 Nov 2008 10:25:22 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <20081115174623.27321.qmail@stuge.se>
References: <200811151801.02369.yuval@avramzon.net>	<491EFB9D.3040002@lwfinger.net>	<200811151907.05636.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
Message-ID: <4926E0F2.5060200@lwfinger.net>

A problem was recently posted to the bcm43xx mailing list that I am unable to
solve. The machine in question is an HP Mini 2133 (HP product number FU346EA)
with a BCM4312 PCIe wireless card. This card is known to work with the b43
driver (I have one.) and it does work on this machine - at least initially.

A problem occurs when xdm/kde is started. Suddenly a read operation on device
hardware returns all ones as though the register does not exist, or if it were
suddenly mismapped. If the OP doesn't try to run xdm, the same problem will
eventually occur, it just takes longer.

This is a 32-bit system running 2.6.28-rc5, but I don't think this is a
regression from some earlier version as the problem was first reported with
kernel 2.6.27-gentoo-r2.

I have complete logs, but before spamming the list with them, I have a question
about the "Zone PFN" settings. On the problem machine, the following list occurs:

[    0.000000] Zone PFN ranges:
[    0.000000]   DMA      0x00000000 -> 0x00001000
[    0.000000]   Normal   0x00001000 -> 0x000373fe
[    0.000000]   HighMem  0x000373fe -> 0x0006feb0

On my 64-bit HP machine, I see:

Zone PFN ranges:
  DMA      0x00000000 -> 0x00001000
  DMA32    0x00001000 -> 0x00100000
  Normal   0x00100000 -> 0x00100000

Is it "normal" for there not to be a DMA32 range with a 32-bit version of Linux?
Certainly all the memory is available to 32-bit DMA. This card does 64-bit DMA,
but the driver falls back to a 32-bit mask for this system.

Is there some kind of memory mapping problem in the PCIe system? Should the
entire log be posted?

Thanks,

Larry


From mb at bu3sch.de  Fri Nov 21 18:42:12 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Fri, 21 Nov 2008 18:42:12 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <4926E0F2.5060200@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
	<4926E0F2.5060200@lwfinger.net>
Message-ID: <200811211842.13099.mb@bu3sch.de>

On Friday 21 November 2008 17:25:22 Larry Finger wrote:
> A problem was recently posted to the bcm43xx mailing list that I am unable to
> solve. The machine in question is an HP Mini 2133 (HP product number FU346EA)
> with a BCM4312 PCIe wireless card. This card is known to work with the b43
> driver (I have one.) and it does work on this machine - at least initially.
> 
> A problem occurs when xdm/kde is started. Suddenly a read operation on device
> hardware returns all ones as though the register does not exist, or if it were
> suddenly mismapped. If the OP doesn't try to run xdm, the same problem will
> eventually occur, it just takes longer.

Can you dump PCI config space and SSB registers (TMSLOW, maybe others, too).
It looks like a random bus write disabled the device.

> [    0.000000] Zone PFN ranges:
> [    0.000000]   DMA      0x00000000 -> 0x00001000
> [    0.000000]   Normal   0x00001000 -> 0x000373fe
> [    0.000000]   HighMem  0x000373fe -> 0x0006feb0
> 
> On my 64-bit HP machine, I see:
> 
> Zone PFN ranges:
>   DMA      0x00000000 -> 0x00001000
>   DMA32    0x00001000 -> 0x00100000
>   Normal   0x00100000 -> 0x00100000
> 
> Is it "normal" for there not to be a DMA32 range with a 32-bit version of Linux?

Yeah, I think so.

-- 
Greetings Michael.


From Larry.Finger at lwfinger.net  Fri Nov 21 19:28:03 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Fri, 21 Nov 2008 12:28:03 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811211842.13099.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<20081115174623.27321.qmail@stuge.se>
	<4926E0F2.5060200@lwfinger.net> <200811211842.13099.mb@bu3sch.de>
Message-ID: <4926FDB3.2030701@lwfinger.net>

Yuval,

Michael Buesch wrote:
> 
> Can you dump PCI config space and SSB registers (TMSLOW, maybe others, too).
> It looks like a random bus write disabled the device.

Please incorporate the following patch and run your system. In addition, run the
following command when the wireless is working and after it fails:

sudo lspci -d 14e4:4312 -x

Post the results of the above commands and any entries in /var/log/messages that
dump registers. They should all be prefaced with ****


Index: linux-2.6/drivers/net/wireless/b43/phy_common.c
===================================================================
--- linux-2.6.orig/drivers/net/wireless/b43/phy_common.c
+++ linux-2.6/drivers/net/wireless/b43/phy_common.c
@@ -133,6 +133,11 @@ void b43_radio_lock(struct b43_wldev *de

 	macctl = b43_read32(dev, B43_MMIO_MACCTL);
 	B43_WARN_ON(macctl & B43_MACCTL_RADIOLOCK);
+	if (macctl & B43_MACCTL_RADIOLOCK) {
+		printk(KERN_INFO "****** b43: B43_MMIO_MACCTL 0x%X\n", macctl);
+		printk(KERN_INFO "****** b43: SSB_TMSLOW 0x%X\n",
+			ssb_read32(dev->dev, SSB_TMSLOW));
+	}
 	macctl |= B43_MACCTL_RADIOLOCK;
 	b43_write32(dev, B43_MMIO_MACCTL, macctl);
 	/* Commit the write and wait for the device
@@ -150,6 +155,11 @@ void b43_radio_unlock(struct b43_wldev *
 	/* unlock */
 	macctl = b43_read32(dev, B43_MMIO_MACCTL);
 	B43_WARN_ON(!(macctl & B43_MACCTL_RADIOLOCK));
+	if (macctl & B43_MACCTL_RADIOLOCK) {
+		printk(KERN_INFO "****** b43: B43_MMIO_MACCTL 0x%X\n", macctl);
+		printk(KERN_INFO "****** b43: SSB_TMSLOW 0x%X\n",
+			ssb_read32(dev->dev, SSB_TMSLOW));
+	}
 	macctl &= ~B43_MACCTL_RADIOLOCK;
 	b43_write32(dev, B43_MMIO_MACCTL, macctl);
 }
Index: linux-2.6/drivers/net/wireless/b43/rfkill.c
===================================================================
--- linux-2.6.orig/drivers/net/wireless/b43/rfkill.c
+++ linux-2.6/drivers/net/wireless/b43/rfkill.c
@@ -63,6 +63,8 @@ static void b43_rfkill_poll(struct input
 		report_change = 1;
 		b43info(wl, "Radio hardware status changed to %s\n",
 			enabled ? "ENABLED" : "DISABLED");
+		b43info(wl, "******** B43_B43_MMIO_RADIO_HWENABLED_HI 0x%X\n",
+			b43_read32(dev, B43_MMIO_RADIO_HWENABLED_HI));
 	}
 	mutex_unlock(&wl->mutex);





From yuval at avramzon.net  Sat Nov 22 07:39:24 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sat, 22 Nov 2008 08:39:24 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <4926FDB3.2030701@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811211842.13099.mb@bu3sch.de> <4926FDB3.2030701@lwfinger.net>
Message-ID: <200811220839.32674.yuval@avramzon.net>

On Friday 21 November 2008, Larry Finger wrote:
> Yuval,
>
> Michael Buesch wrote:
> > Can you dump PCI config space and SSB registers (TMSLOW, maybe others,
> > too). It looks like a random bus write disabled the device.
>
> Please incorporate the following patch and run your system. In addition,
> run the following command when the wireless is working and after it fails:
>
> sudo lspci -d 14e4:4312 -x
>

When the wireless is working:
$ lspci -d 14e4:4312 -x
02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00

After it fails:
$ lspci -d 14e4:4312 -x
02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
00: e4 14 12 43 00 00 10 00 02 00 80 02 00 00 00 00
10: 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
30: 00 00 00 00 40 00 00 00 00 00 00 00 00 01 00 00


> Post the results of the above commands and any entries in /var/log/messages
> that dump registers. They should all be prefaced with ****
>

Sorry for the long time to reply, it took a while to recreate the problem. 
According to the logs, it happened exactly when I checked the machine in the 
morning.
At the beginning, the register dumps look like this:

[   57.279984] ****** b43: B43_MMIO_MACCTL 0x840A0503
[   57.279992] ****** b43: SSB_TMSLOW 0x20150000
(these line repeat exactly the same. Skipping)

[31723.961262] ****** b43: B43_MMIO_MACCTL 0x840A0503
[31723.961275] ****** b43: SSB_TMSLOW 0x20150000
[31732.959490] b43-phy0: Radio hardware status changed to DISABLED
[31732.959505] b43-phy0: ******** B43_B43_MMIO_RADIO_HWENABLED_HI 0xFFFFFFFF
[31738.130551] wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume 
out of range
[31783.855931] ------------[ cut here ]------------
[31783.855944] WARNING: at drivers/net/wireless/b43/phy_common.c:135 
b43_radio_lock+0x29/0x7e [b43]()
[31783.855955] Modules linked in: via drm rfkill_input hci_usb b43 led_class 
input_polldev rtc snd_hda_intel snd_pcm snd_tim
er snd_page_alloc snd_hwdep snd soundcore ehci_hcd uhci_hcd usbcore sg ssb 
video output via_agp agpgart
[31783.856023] Pid: 1220, comm: b43 Not tainted 2.6.28-rc5 #13
[31783.856032] Call Trace:
[31783.856055]  [<c011f4e9>] warn_on_slowpath+0x40/0x59
[31783.856102]  [<f7d93da3>] b43_gphy_op_write+0x25/0x29 [b43]
[31783.856143]  [<f7d90735>] b43_calc_nrssi_slope+0x103e/0x105a [b43]
[31783.856180]  [<f7cba429>] ssb_pci_write32+0x15/0x3f [ssb]
[31783.856209]  [<f7cba545>] ssb_pci_read16+0x31/0x3f [ssb]
[31783.856244]  [<f7d8854c>] __b43_shm_read16+0x79/0x81 [b43]
[31783.856272]  [<f7cba545>] ssb_pci_read16+0x31/0x3f [ssb]
[31783.856306]  [<f7d8854c>] __b43_shm_read16+0x79/0x81 [b43]
[31783.856334]  [<f7cba4eb>] ssb_pci_read32+0x12/0x3b [ssb]
[31783.856370]  [<f7d8dc77>] b43_radio_lock+0x29/0x7e [b43]
[31783.856408]  [<f7d91e92>] b43_gphy_op_adjust_txpower+0x111/0x138 [b43]
[31783.856446]  [<f7d8da06>] b43_phy_txpower_adjust_work+0x0/0x39 [b43]
[31783.856483]  [<f7d8da36>] b43_phy_txpower_adjust_work+0x30/0x39 [b43]
[31783.856500]  [<c012b2a4>] run_workqueue+0x6a/0xdf
[31783.856515]  [<c012b9ba>] worker_thread+0x0/0xbd
[31783.856527]  [<c012ba6d>] worker_thread+0xb3/0xbd
[31783.856545]  [<c012dc8c>] autoremove_wake_function+0x0/0x2d
[31783.856560]  [<c012dbc9>] kthread+0x38/0x5f
[31783.856573]  [<c012db91>] kthread+0x0/0x5f
[31783.856588]  [<c01040a7>] kernel_thread_helper+0x7/0x10
[31783.856598] ---[ end trace 7548c7ede66fa0d3 ]---
[31783.856607] ****** b43: B43_MMIO_MACCTL 0xFFFFFFFF
[31783.856616] ****** b43: SSB_TMSLOW 0xFFFFFFFF

And from now on, all reads are ones. I have the full logs if you need.

Cheers,

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081122/9e92e5e1/attachment.pgp>

From peter at stuge.se  Sat Nov 22 11:06:15 2008
From: peter at stuge.se (Peter Stuge)
Date: Sat, 22 Nov 2008 11:06:15 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811220839.32674.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811211842.13099.mb@bu3sch.de> <4926FDB3.2030701@lwfinger.net>
	<200811220839.32674.yuval@avramzon.net>
Message-ID: <20081122100615.6833.qmail@stuge.se>

Yuval Hager wrote:
> When the wireless is working:
> 00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
> 10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
> 30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00
> 
> After it fails:
> 00: e4 14 12 43 00 00 10 00 02 00 80 02 00 00 00 00
> 10: 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 30: 00 00 00 00 40 00 00 00 00 00 00 00 00 01 00 00

Differences:

04h bit 1: A value of 1 allows the device to respond to Memory Space addresses.
04h bit 2: A value of 1 allows the device to behave as a bus master.
04h bit 8: A value of 1 enables the SERR# driver.

0ch bit 3: System cacheline size in units of DWORDs.

10h: BAR0 (memory mapped address for device)

3ch bits 7:0: Interrupt Line

Basically the card has been deconfigured. This should never happen.

Try the following (somewhat naive) command to see if it starts
working again:

setpci -d 14e4:4312 c.l=8 10.l=fdffc004 4.w=0106


//Peter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081122/3d204b97/attachment.pgp>

From yuval at avramzon.net  Sat Nov 22 12:59:27 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sat, 22 Nov 2008 13:59:27 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <20081122100615.6833.qmail@stuge.se>
References: <200811151801.02369.yuval@avramzon.net>
	<200811220839.32674.yuval@avramzon.net>
	<20081122100615.6833.qmail@stuge.se>
Message-ID: <200811221359.31979.yuval@avramzon.net>

On Saturday 22 November 2008, Peter Stuge wrote:
> Yuval Hager wrote:
> > When the wireless is working:
> > 00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
> > 10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
> > 30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00
> >
> > After it fails:
> > 00: e4 14 12 43 00 00 10 00 02 00 80 02 00 00 00 00
> > 10: 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> > 30: 00 00 00 00 40 00 00 00 00 00 00 00 00 01 00 00
>
> Differences:
>
> 04h bit 1: A value of 1 allows the device to respond to Memory Space
> addresses. 04h bit 2: A value of 1 allows the device to behave as a bus
> master. 04h bit 8: A value of 1 enables the SERR# driver.
>
> 0ch bit 3: System cacheline size in units of DWORDs.
>
> 10h: BAR0 (memory mapped address for device)
>
> 3ch bits 7:0: Interrupt Line
>
> Basically the card has been deconfigured. This should never happen.
>
> Try the following (somewhat naive) command to see if it starts
> working again:
>
> setpci -d 14e4:4312 c.l=8 10.l=fdffc004 4.w=0106
>

Nope, that doesn't work.
At first I get the same register reads as in the beginning, but no network 
access. When I try to restart the interface, I get "Fatal DMA error" 
and "Controller RESET (DMA error)". Trying to unload and reload the modules 
leads to a complete lockup.

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081122/8e6c3428/attachment.pgp>

From mb at bu3sch.de  Sat Nov 22 16:13:00 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sat, 22 Nov 2008 16:13:00 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811220839.32674.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<4926FDB3.2030701@lwfinger.net>
	<200811220839.32674.yuval@avramzon.net>
Message-ID: <200811221613.00303.mb@bu3sch.de>

On Saturday 22 November 2008 07:39:24 Yuval Hager wrote:
> On Friday 21 November 2008, Larry Finger wrote:
> > Yuval,
> >
> > Michael Buesch wrote:
> > > Can you dump PCI config space and SSB registers (TMSLOW, maybe others,
> > > too). It looks like a random bus write disabled the device.
> >
> > Please incorporate the following patch and run your system. In addition,
> > run the following command when the wireless is working and after it fails:
> >
> > sudo lspci -d 14e4:4312 -x
> >
> 
> When the wireless is working:
> $ lspci -d 14e4:4312 -x
> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
> 00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
> 10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
> 20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
> 30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00
> 
> After it fails:
> $ lspci -d 14e4:4312 -x
> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
> 00: e4 14 12 43 00 00 10 00 02 00 80 02 00 00 00 00
                  ^^                      ^^
Somebody disabled MMIO and busmastering.
And somebody cleared the CACHE_LINE_SIZE register.

> 10: 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
> 30: 00 00 00 00 40 00 00 00 00 00 00 00 00 01 00 00

-- 
Greetings Michael.


From mb at bu3sch.de  Sat Nov 22 16:15:47 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sat, 22 Nov 2008 16:15:47 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811221359.31979.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081122100615.6833.qmail@stuge.se>
	<200811221359.31979.yuval@avramzon.net>
Message-ID: <200811221615.48066.mb@bu3sch.de>

On Saturday 22 November 2008 12:59:27 Yuval Hager wrote:
> On Saturday 22 November 2008, Peter Stuge wrote:
> > Yuval Hager wrote:
> > > When the wireless is working:
> > > 00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
> > > 10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
> > > 30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00
> > >
> > > After it fails:
> > > 00: e4 14 12 43 00 00 10 00 02 00 80 02 00 00 00 00
> > > 10: 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> > > 30: 00 00 00 00 40 00 00 00 00 00 00 00 00 01 00 00
> >
> > Differences:
> >
> > 04h bit 1: A value of 1 allows the device to respond to Memory Space
> > addresses. 04h bit 2: A value of 1 allows the device to behave as a bus
> > master. 04h bit 8: A value of 1 enables the SERR# driver.
> >
> > 0ch bit 3: System cacheline size in units of DWORDs.
> >
> > 10h: BAR0 (memory mapped address for device)
> >
> > 3ch bits 7:0: Interrupt Line
> >
> > Basically the card has been deconfigured. This should never happen.
> >
> > Try the following (somewhat naive) command to see if it starts
> > working again:
> >
> > setpci -d 14e4:4312 c.l=8 10.l=fdffc004 4.w=0106
> >
> 
> Nope, that doesn't work.
> At first I get the same register reads as in the beginning, but no network 
> access. When I try to restart the interface, I get "Fatal DMA error" 
> and "Controller RESET (DMA error)". Trying to unload and reload the modules 
> leads to a complete lockup.

Ok, kind of expected.

Can you turn on _all_ kernel-hacking options for memory debugging?

-- 
Greetings Michael.


From Larry.Finger at lwfinger.net  Sat Nov 22 16:32:08 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sat, 22 Nov 2008 09:32:08 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811221613.00303.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<4926FDB3.2030701@lwfinger.net>
	<200811220839.32674.yuval@avramzon.net>
	<200811221613.00303.mb@bu3sch.de>
Message-ID: <492825F8.6020606@lwfinger.net>

Michael Buesch wrote:

> Somebody disabled MMIO and busmastering.
> And somebody cleared the CACHE_LINE_SIZE register.

Are these all the read/write bits in the configuration area? Should I conclude
that someone zeroed this area?

In case the kernel memory diagnostics don't help, is there any way to trap
writes to the configuration registers?

Larry


From mb at bu3sch.de  Sat Nov 22 16:54:09 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sat, 22 Nov 2008 16:54:09 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <492825F8.6020606@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221613.00303.mb@bu3sch.de> <492825F8.6020606@lwfinger.net>
Message-ID: <200811221654.09399.mb@bu3sch.de>

On Saturday 22 November 2008 16:32:08 Larry Finger wrote:
> Michael Buesch wrote:
> 
> > Somebody disabled MMIO and busmastering.
> > And somebody cleared the CACHE_LINE_SIZE register.
> 
> Are these all the read/write bits in the configuration area? Should I conclude
> that someone zeroed this area?

Yeah well. I'm not sure. It _looks_ like someone completely cut the physical
power line to the card and it reset its complete PCI config.
So well, X does poke with the PCI devices. But as you said it also happens if
X doesn't run, I'd rule that out.
But I would not rule out a fucked BIOS, yet.
Does the BIOS have any powersave options and/or spread-spectrum options for
the PCI-bus? Can you try to turn them all off?
I have a machine that has PCI-slot autodetect and turns of the PCI clock, if
it doesn't detect a card on that slot. Also turn that off, if you have it, too.

> In case the kernel memory diagnostics don't help, is there any way to trap
> writes to the configuration registers?

Well, if we have random memory corruption, that can hit memory and MMIO.
It doesn't hurt to turn on all debugging options. Often you get some hint
by doing so.

-- 
Greetings Michael.


From peter at stuge.se  Sat Nov 22 19:21:02 2008
From: peter at stuge.se (Peter Stuge)
Date: Sat, 22 Nov 2008 19:21:02 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811221654.09399.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221613.00303.mb@bu3sch.de> <492825F8.6020606@lwfinger.net>
	<200811221654.09399.mb@bu3sch.de>
Message-ID: <20081122182102.5353.qmail@stuge.se>

Michael Buesch wrote:
> > Are these all the read/write bits in the configuration area?

No, there are more of them. Most bytes in config space are rw, except
the first four.


> > Should I conclude that someone zeroed this area?

No, because there are still valid bytes. Especially the first byte in
the BAR being non-zero (maybe even unchanged) is peculiar.


> Yeah well. I'm not sure. It _looks_ like someone completely cut the
> physical power line to the card and it reset its complete PCI
> config.

PCIe maps config space into MMIO IIRC. It might be clobbered that
way.


> So well, X does poke with the PCI devices. But as you said it also
> happens if X doesn't run, I'd rule that out.

Agree.


> But I would not rule out a fucked BIOS, yet.

Possibly.


> Does the BIOS have any powersave options and/or spread-spectrum
> options for the PCI-bus? Can you try to turn them all off?

Being a HP I don't expect there are many options in the BIOS. :\


> > In case the kernel memory diagnostics don't help, is there any
> > way to trap writes to the configuration registers?
> 
> Well, if we have random memory corruption, that can hit memory and MMIO.
> It doesn't hurt to turn on all debugging options. Often you get some hint
> by doing so.

I hope this will give some more info. I think it will.


//Peter


From yuval at avramzon.net  Sun Nov 23 08:26:25 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sun, 23 Nov 2008 09:26:25 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811221654.09399.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<492825F8.6020606@lwfinger.net> <200811221654.09399.mb@bu3sch.de>
Message-ID: <200811230926.28948.yuval@avramzon.net>

On Saturday 22 November 2008, Michael Buesch wrote:
> On Saturday 22 November 2008 16:32:08 Larry Finger wrote:
> > Michael Buesch wrote:
> > > Somebody disabled MMIO and busmastering.
> > > And somebody cleared the CACHE_LINE_SIZE register.
> >
> > Are these all the read/write bits in the configuration area? Should I
> > conclude that someone zeroed this area?
>
> Yeah well. I'm not sure. It _looks_ like someone completely cut the
> physical power line to the card and it reset its complete PCI config.
> So well, X does poke with the PCI devices. But as you said it also happens
> if X doesn't run, I'd rule that out.
> But I would not rule out a fucked BIOS, yet.
> Does the BIOS have any powersave options and/or spread-spectrum options for
> the PCI-bus? Can you try to turn them all off?
> I have a machine that has PCI-slot autodetect and turns of the PCI clock,
> if it doesn't detect a card on that slot. Also turn that off, if you have
> it, too.
>
> > In case the kernel memory diagnostics don't help, is there any way to
> > trap writes to the configuration registers?
>
> Well, if we have random memory corruption, that can hit memory and MMIO.
> It doesn't hurt to turn on all debugging options. Often you get some hint
> by doing so.

I've enabled all CONFIG*DEBUG I could find relevant, and ran the system with:
'debug memory_corruption_check=1 devres.log=1 debug_objects debugpat 
acpi.debug_layer=0x00410002 acpi.debug_level=0xffffffff'
but no hint appears in the logs during the failure.

I did find that certain events recreate the problem immediately. if I 'xset 
dpms force standby' it happens on wakeup. 'xset -dpms' causes this 
immediately as well. If I load X without DPMS support, it still happens after 
the monitor is waken up from (hardware?) blackness.

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081123/922f2304/attachment.pgp>

From yuval at avramzon.net  Sun Nov 23 12:49:55 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Sun, 23 Nov 2008 13:49:55 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811221654.09399.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<492825F8.6020606@lwfinger.net> <200811221654.09399.mb@bu3sch.de>
Message-ID: <200811231350.00207.yuval@avramzon.net>

> It doesn't hurt to turn on all debugging options. Often you get some hint
> by doing so.

I booted with 'root=/dev/sda3 debug memory_corruption_check=1 devres.log=1 debug_objects debugpat 
acpi.debug_layer=0x00410002 acpi.debug_level=0xffffffff acpi=off noapic nolapic irqpoll pci=noacpi' and issued 'xset dpms force 
standby'. After touching the mouse the system locked for about a minute, and the wireless stopped working. 
Here's the log portion, I hope it provides a hint of some sort:

[  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
[  182.891409] ****** b43: SSB_TMSLOW 0x20150000
[  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)
[  258.299038] Pid: 0, comm: swapper Not tainted 2.6.28-rc5 #15
[  258.299043] Call Trace:
[  258.299062]  [<c0148d9a>] __report_bad_irq+0x24/0x69
[  258.299071]  [<c0148da1>] __report_bad_irq+0x2b/0x69
[  258.299080]  [<c0148ec8>] note_interrupt+0xe9/0x12d
[  258.299090]  [<c014976d>] handle_level_irq+0x87/0xba
[  258.299101]  [<c010564e>] do_IRQ+0x89/0x9f
[  258.299109]  [<c0103ea8>] common_interrupt+0x28/0x30
[  258.299119]  [<c0125406>] do_softirq+0x37/0x4d
[  258.299127]  [<c0125301>] __do_softirq+0x62/0x130
[  258.299135]  [<c0125406>] do_softirq+0x37/0x4d
[  258.299142]  [<c0105653>] do_IRQ+0x8e/0x9f
[  258.299150]  [<c0103ea8>] common_interrupt+0x28/0x30
[  258.299161]  [<c0108682>] default_idle+0x2f/0x4c
[  258.299168]  [<c0101a20>] cpu_idle+0x63/0x77
[  258.299173] handlers:
[  258.299176] [<f7906455>] (b43_interrupt_handler+0x0/0x1b7 [b43])
[  258.299212] Disabling IRQ #10
[  258.315148] b43-phy0: Radio hardware status changed to DISABLED
[  258.315160] b43-phy0: ******** B43_B43_MMIO_RADIO_HWENABLED_HI 0xFFFFFFFF
[  258.342341] kobject: 'rfkill0' (f43b7d78): kobject_uevent_env
[  258.342367] kobject: 'rfkill0' (f43b7d78): fill_kobj_path: path = '/class/rfkill/rfkill0'
[  258.342418] kobject: 'ssb0:0' (f40dfcd8): fill_kobj_path: path = '/devices/pci0000:00/0000:00:02.0/0000:02:00.0/ssb0:0'
[  258.391951] 
[  258.391956] =================================
[  258.391964] [ INFO: inconsistent lock state ]
[  258.391971] 2.6.28-rc5 #15
[  258.391975] ---------------------------------
[  258.391980] inconsistent {in-hardirq-W} -> {hardirq-on-W} usage.
[  258.391987] X/3965 [HC0[0]:SC1[1]:HE1:SE0] takes:
[  258.391993]  (&irq_desc_lock_class){++..}, at: [<c0148c60>] try_one_irq+0x15/0xe8
[  258.392016] {in-hardirq-W} state was registered at:
[  258.392021]   [<c013bc07>] __lock_acquire+0x490/0x6bc
[  258.392034]   [<c013be8d>] lock_acquire+0x5a/0x74
[  258.392043]   [<c01496f8>] handle_level_irq+0x12/0xba
[  258.392053]   [<c03c4842>] _spin_lock+0x1c/0x45
[  258.392066]   [<c01496f8>] handle_level_irq+0x12/0xba
[  258.392076]   [<c01496f8>] handle_level_irq+0x12/0xba
[  258.392085]   [<c010564e>] do_IRQ+0x89/0x9f
[  258.392096]   [<c0103ea8>] common_interrupt+0x28/0x30
[  258.392105]   [<c03c4cc2>] _spin_unlock_irqrestore+0x37/0x39
[  258.392115]   [<c01487e6>] __setup_irq+0x17a/0x1f3
[  258.392124]   [<c05ce79d>] start_kernel+0x285/0x2f1
[  258.392140]   [<ffffffff>] 0xffffffff
[  258.392159] irq event stamp: 1844456
[  258.392164] hardirqs last  enabled at (1844456): [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
[  258.392175] hardirqs last disabled at (1844455): [<c03c4ac3>] _spin_lock_irq+0xa/0x4b
[  258.392186] softirqs last  enabled at (1844310): [<c0125406>] do_softirq+0x37/0x4d
[  258.392198] softirqs last disabled at (1844447): [<c0125406>] do_softirq+0x37/0x4d
[  258.392208] 
[  258.392209] other info that might help us debug this:
[  258.392215] no locks held by X/3965.
[  258.392219] 
[  258.392220] stack backtrace:
[  258.392226] Pid: 3965, comm: X Not tainted 2.6.28-rc5 #15
[  258.392231] Call Trace:
[  258.392241]  [<c0139175>] print_usage_bug+0x13d/0x146
[  258.392249]  [<c013a2ff>] mark_lock+0x4b1/0x7c7
[  258.392257]  [<c013bc7e>] __lock_acquire+0x507/0x6bc
[  258.392266]  [<c013be8d>] lock_acquire+0x5a/0x74
[  258.392275]  [<c0148c60>] try_one_irq+0x15/0xe8
[  258.392283]  [<c03c4842>] _spin_lock+0x1c/0x45
[  258.392291]  [<c0148c60>] try_one_irq+0x15/0xe8
[  258.392300]  [<c0148c60>] try_one_irq+0x15/0xe8
[  258.392308]  [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
[  258.392317]  [<c0148d33>] poll_spurious_irqs+0x0/0x43
[  258.392326]  [<c0148d55>] poll_spurious_irqs+0x22/0x43
[  258.392338]  [<c012874a>] run_timer_softirq+0x101/0x156
[  258.392346]  [<c0125321>] __do_softirq+0x82/0x130
[  258.392354]  [<c0125406>] do_softirq+0x37/0x4d
[  258.392362]  [<c0105653>] do_IRQ+0x8e/0x9f
[  258.392370]  [<c0103ea8>] common_interrupt+0x28/0x30
[  260.311944] wlan0: No ProbeResp from current AP 00:22:3f:18:89:5e - assume out of range
[  304.082520] ------------[ cut here ]------------
[  304.082531] WARNING: at drivers/net/wireless/b43/phy_common.c:135 b43_radio_lock+0x29/0x7c [b43]()
[  304.082538] Modules linked in: rfkill_input b43 ssb led_class input_polldev via drm rtc hci_usb snd_h
da_intel snd_pcm snd_timer snd_page_alloc snd_hwdep snd soundcore ehci_hcd uhci_hcd usbcore sg via_agp a
gpgart
[  304.082593] Pid: 5913, comm: b43 Not tainted 2.6.28-rc5 #15
[  304.082599] Call Trace:
[  304.082618]  [<c012171f>] warn_on_slowpath+0x40/0x59
[  304.082643]  [<f7901c94>] b43_shm_read16+0x20/0x42 [b43]
[  304.082666]  [<f7b9e4dc>] ssb_pci_read32+0x12/0x3b [ssb]
[  304.082686]  [<f7906ded>] b43_radio_lock+0x29/0x7c [b43]
[  304.082706]  [<f790b030>] b43_gphy_op_adjust_txpower+0x112/0x139 [b43]
[  304.082727]  [<f7906ba0>] b43_phy_txpower_adjust_work+0x32/0x3b [b43]
[  304.082740]  [<c012de6d>] run_workqueue+0xbf/0x192
[  304.082748]  [<c012de2f>] run_workqueue+0x81/0x192
[  304.082767]  [<f7906b6e>] b43_phy_txpower_adjust_work+0x0/0x3b [b43]
[  304.082778]  [<c012e72a>] worker_thread+0x0/0xbd
[  304.082786]  [<c012e7dd>] worker_thread+0xb3/0xbd
[  304.082796]  [<c0130bcc>] autoremove_wake_function+0x0/0x2d
[  304.082803]  [<c0130b10>] kthread+0x38/0x60
[  304.082810]  [<c0130ad8>] kthread+0x0/0x60
[  304.082820]  [<c01041c7>] kernel_thread_helper+0x7/0x10
[  304.082826] ---[ end trace 6ecefdf7cfe131b0 ]---
[  304.082832] ****** b43: B43_MMIO_MACCTL 0xFFFFFFFF
[  304.082837] ****** b43: SSB_TMSLOW 0xFFFFFFFF

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081123/79343d4c/attachment.pgp>

From mb at bu3sch.de  Sun Nov 23 13:20:30 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sun, 23 Nov 2008 13:20:30 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811231350.00207.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221654.09399.mb@bu3sch.de>
	<200811231350.00207.yuval@avramzon.net>
Message-ID: <200811231320.30289.mb@bu3sch.de>

On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
> [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
> [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
> [  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)


Does the kernel disable the PCI device, if it ignores the IRQ?


> [  258.299038] Pid: 0, comm: swapper Not tainted 2.6.28-rc5 #15
> [  258.299043] Call Trace:
> [  258.299062]  [<c0148d9a>] __report_bad_irq+0x24/0x69
> [  258.299071]  [<c0148da1>] __report_bad_irq+0x2b/0x69
> [  258.299080]  [<c0148ec8>] note_interrupt+0xe9/0x12d
> [  258.299090]  [<c014976d>] handle_level_irq+0x87/0xba
> [  258.299101]  [<c010564e>] do_IRQ+0x89/0x9f
> [  258.299109]  [<c0103ea8>] common_interrupt+0x28/0x30
> [  258.299119]  [<c0125406>] do_softirq+0x37/0x4d
> [  258.299127]  [<c0125301>] __do_softirq+0x62/0x130
> [  258.299135]  [<c0125406>] do_softirq+0x37/0x4d
> [  258.299142]  [<c0105653>] do_IRQ+0x8e/0x9f
> [  258.299150]  [<c0103ea8>] common_interrupt+0x28/0x30
> [  258.299161]  [<c0108682>] default_idle+0x2f/0x4c
> [  258.299168]  [<c0101a20>] cpu_idle+0x63/0x77
> [  258.299173] handlers:
> [  258.299176] [<f7906455>] (b43_interrupt_handler+0x0/0x1b7 [b43])
> [  258.299212] Disabling IRQ #10
> [  258.315148] b43-phy0: Radio hardware status changed to DISABLED
> [  258.315160] b43-phy0: ******** B43_B43_MMIO_RADIO_HWENABLED_HI 0xFFFFFFFF
> [  258.342341] kobject: 'rfkill0' (f43b7d78): kobject_uevent_env
> [  258.342367] kobject: 'rfkill0' (f43b7d78): fill_kobj_path: path = '/class/rfkill/rfkill0'
> [  258.342418] kobject: 'ssb0:0' (f40dfcd8): fill_kobj_path: path = '/devices/pci0000:00/0000:00:02.0/0000:02:00.0/ssb0:0'
> [  258.391951] 
> [  258.391956] =================================
> [  258.391964] [ INFO: inconsistent lock state ]
> [  258.391971] 2.6.28-rc5 #15
> [  258.391975] ---------------------------------
> [  258.391980] inconsistent {in-hardirq-W} -> {hardirq-on-W} usage.
> [  258.391987] X/3965 [HC0[0]:SC1[1]:HE1:SE0] takes:
> [  258.391993]  (&irq_desc_lock_class){++..}, at: [<c0148c60>] try_one_irq+0x15/0xe8
> [  258.392016] {in-hardirq-W} state was registered at:
> [  258.392021]   [<c013bc07>] __lock_acquire+0x490/0x6bc
> [  258.392034]   [<c013be8d>] lock_acquire+0x5a/0x74
> [  258.392043]   [<c01496f8>] handle_level_irq+0x12/0xba
> [  258.392053]   [<c03c4842>] _spin_lock+0x1c/0x45
> [  258.392066]   [<c01496f8>] handle_level_irq+0x12/0xba
> [  258.392076]   [<c01496f8>] handle_level_irq+0x12/0xba
> [  258.392085]   [<c010564e>] do_IRQ+0x89/0x9f
> [  258.392096]   [<c0103ea8>] common_interrupt+0x28/0x30
> [  258.392105]   [<c03c4cc2>] _spin_unlock_irqrestore+0x37/0x39
> [  258.392115]   [<c01487e6>] __setup_irq+0x17a/0x1f3
> [  258.392124]   [<c05ce79d>] start_kernel+0x285/0x2f1
> [  258.392140]   [<ffffffff>] 0xffffffff
> [  258.392159] irq event stamp: 1844456
> [  258.392164] hardirqs last  enabled at (1844456): [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
> [  258.392175] hardirqs last disabled at (1844455): [<c03c4ac3>] _spin_lock_irq+0xa/0x4b
> [  258.392186] softirqs last  enabled at (1844310): [<c0125406>] do_softirq+0x37/0x4d
> [  258.392198] softirqs last disabled at (1844447): [<c0125406>] do_softirq+0x37/0x4d


That's a bit weird. Looks like another bug in the IRQ layer.


> [  258.392208] 
> [  258.392209] other info that might help us debug this:
> [  258.392215] no locks held by X/3965.
> [  258.392219] 
> [  258.392220] stack backtrace:
> [  258.392226] Pid: 3965, comm: X Not tainted 2.6.28-rc5 #15
> [  258.392231] Call Trace:
> [  258.392241]  [<c0139175>] print_usage_bug+0x13d/0x146
> [  258.392249]  [<c013a2ff>] mark_lock+0x4b1/0x7c7
> [  258.392257]  [<c013bc7e>] __lock_acquire+0x507/0x6bc
> [  258.392266]  [<c013be8d>] lock_acquire+0x5a/0x74
> [  258.392275]  [<c0148c60>] try_one_irq+0x15/0xe8
> [  258.392283]  [<c03c4842>] _spin_lock+0x1c/0x45
> [  258.392291]  [<c0148c60>] try_one_irq+0x15/0xe8
> [  258.392300]  [<c0148c60>] try_one_irq+0x15/0xe8
> [  258.392308]  [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
> [  258.392317]  [<c0148d33>] poll_spurious_irqs+0x0/0x43
> [  258.392326]  [<c0148d55>] poll_spurious_irqs+0x22/0x43
> [  258.392338]  [<c012874a>] run_timer_softirq+0x101/0x156
> [  258.392346]  [<c0125321>] __do_softirq+0x82/0x130
> [  258.392354]  [<c0125406>] do_softirq+0x37/0x4d
> [  258.392362]  [<c0105653>] do_IRQ+0x8e/0x9f
> [  258.392370]  [<c0103ea8>] common_interrupt+0x28/0x30

-- 
Greetings Michael.


From Larry.Finger at lwfinger.net  Sun Nov 23 16:42:28 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sun, 23 Nov 2008 09:42:28 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811231320.30289.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221654.09399.mb@bu3sch.de>
	<200811231350.00207.yuval@avramzon.net>
	<200811231320.30289.mb@bu3sch.de>
Message-ID: <492979E4.1070606@lwfinger.net>

Michael Buesch wrote:
> On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
>> [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
>> [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
>> [  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)
> 
> 
> Does the kernel disable the PCI device, if it ignores the IRQ?

According to /proc/interrupts that Yuval posted earlier, IRQ 10 is not used.

# cat /proc/interrupts

           CPU0
  0:     271998   IO-APIC-edge      timer
  1:          8   IO-APIC-edge      i8042
  8:          2   IO-APIC-edge      rtc
  9:       2796   IO-APIC-fasteoi   acpi
 12:        132   IO-APIC-edge      i8042
 14:          0   IO-APIC-edge      ide0
 15:          0   IO-APIC-edge      ide1
 16:      29161   IO-APIC-fasteoi   eth0
 17:        503   IO-APIC-fasteoi   HDA Intel
 20:          0   IO-APIC-fasteoi   uhci_hcd:usb2
 21:      11085   IO-APIC-fasteoi   sata_via, ehci_hcd:usb1, uhci_hcd:usb3
 23:          0   IO-APIC-fasteoi   uhci_hcd:usb4
 24:      28003   IO-APIC-fasteoi   b43
NMI:          0   Non-maskable interrupts
LOC:       2098   Local timer interrupts
RES:          0   Rescheduling interrupts
CAL:          0   function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
SPU:          0   Spurious interrupts
ERR:          0
MIS:          0

After the failure occurs, b43 has disappeared from the IRQ 24 list:

 24:      34154   IO-APIC-fasteoi


Larry


From mb at bu3sch.de  Sun Nov 23 18:42:46 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sun, 23 Nov 2008 18:42:46 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <492979E4.1070606@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811231320.30289.mb@bu3sch.de> <492979E4.1070606@lwfinger.net>
Message-ID: <200811231842.46775.mb@bu3sch.de>

On Sunday 23 November 2008 16:42:28 Larry Finger wrote:
> Michael Buesch wrote:
> > On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
> >> [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
> >> [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
> >> [  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)
> > 
> > 
> > Does the kernel disable the PCI device, if it ignores the IRQ?
> 
> According to /proc/interrupts that Yuval posted earlier, IRQ 10 is not used.

Can you try booting with kernel parameters "noapic" and "noacpi"
and reproduce?

-- 
Greetings Michael.


From mb at bu3sch.de  Sun Nov 23 19:08:17 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Sun, 23 Nov 2008 19:08:17 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811231955.41722.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811231842.46775.mb@bu3sch.de>
	<200811231955.41722.yuval@avramzon.net>
Message-ID: <200811231908.17856.mb@bu3sch.de>

On Sunday 23 November 2008 18:55:36 Yuval Hager wrote:
> On Sunday 23 November 2008, you wrote:
> > On Sunday 23 November 2008 16:42:28 Larry Finger wrote:
> > > Michael Buesch wrote:
> > > > On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
> > > >> [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
> > > >> [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
> > > >> [  258.299027] irq 10: nobody cared (try booting with the "irqpoll"
> > > >> option)
> > > >
> > > > Does the kernel disable the PCI device, if it ignores the IRQ?
> > >
> > > According to /proc/interrupts that Yuval posted earlier, IRQ 10 is not
> > > used.
> >
> > Can you try booting with kernel parameters "noapic" and "noacpi"
> > and reproduce?
> 
> The dump above was generated with "acpi=off noapic nolapic pci=noacpi" boot 
> parameters (see my last email). The /proc/interrupts output was from an 
> earlier occurence, without any of these parameters.
> Did you mean to reproduce and provide logs as well as the content 
> of /proc/interrupts before and after the failure?

No thanks.
Anyway, I cannot really help you with the issue.
I don't think this is a b43 bug, but either a hardware bug or a bug
in some code that controls the PCI bus.

-- 
Greetings Michael.


From peter at stuge.se  Sun Nov 23 21:46:31 2008
From: peter at stuge.se (Peter Stuge)
Date: Sun, 23 Nov 2008 21:46:31 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811231320.30289.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221654.09399.mb@bu3sch.de>
	<200811231350.00207.yuval@avramzon.net>
	<200811231320.30289.mb@bu3sch.de>
Message-ID: <20081123204631.21061.qmail@stuge.se>

Michael Buesch wrote:
> On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
> > [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
> > [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
> > [  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)
> 
> Does the kernel disable the PCI device, if it ignores the IRQ?

The kernel disables the IRQ at least internally, maybe also by
deconfiguring the interrupt register in any devices using it, which
would explain the change in config register 0x3c (but not the changes
in all the other bytes, could that be a freak chain reaction inside
the hardware?) but I haven't heard/seen the kernel disable the PCI
device itself. I don't know if it can.

Why doesn't b43 care about this interrupt? Without APIC interrupt 10
is what both device and driver should be using (according to earlier
lspci -x output).


> > [  258.299173] handlers:
> > [  258.299176] [<f7906455>] (b43_interrupt_handler+0x0/0x1b7 [b43])
> > [  258.299212] Disabling IRQ #10
> > [  258.315148] b43-phy0: Radio hardware status changed to DISABLED
> > [  258.315160] b43-phy0: ******** B43_B43_MMIO_RADIO_HWENABLED_HI 0xFFFFFFFF
> > [  258.342341] kobject: 'rfkill0' (f43b7d78): kobject_uevent_env
> > [  258.342367] kobject: 'rfkill0' (f43b7d78): fill_kobj_path: path = '/class/rfkill/rfkill0'
> > [  258.342418] kobject: 'ssb0:0' (f40dfcd8): fill_kobj_path: path = '/devices/pci0000:00/0000:00:02.0/0000:02:00.0/ssb0:0'

Why does the radio hw status changes here?
How is the change notified to the driver?


> > [  258.391951] 
> > [  258.391956] =================================
> > [  258.391964] [ INFO: inconsistent lock state ]
> > [  258.391971] 2.6.28-rc5 #15
> > [  258.391975] ---------------------------------
> > [  258.391980] inconsistent {in-hardirq-W} -> {hardirq-on-W} usage.
> > [  258.391987] X/3965 [HC0[0]:SC1[1]:HE1:SE0] takes:
> > [  258.391993]  (&irq_desc_lock_class){++..}, at: [<c0148c60>] try_one_irq+0x15/0xe8
> > [  258.392016] {in-hardirq-W} state was registered at:
> > [  258.392021]   [<c013bc07>] __lock_acquire+0x490/0x6bc
> > [  258.392034]   [<c013be8d>] lock_acquire+0x5a/0x74
> > [  258.392043]   [<c01496f8>] handle_level_irq+0x12/0xba
> > [  258.392053]   [<c03c4842>] _spin_lock+0x1c/0x45
> > [  258.392066]   [<c01496f8>] handle_level_irq+0x12/0xba
> > [  258.392076]   [<c01496f8>] handle_level_irq+0x12/0xba
> > [  258.392085]   [<c010564e>] do_IRQ+0x89/0x9f
> > [  258.392096]   [<c0103ea8>] common_interrupt+0x28/0x30
> > [  258.392105]   [<c03c4cc2>] _spin_unlock_irqrestore+0x37/0x39
> > [  258.392115]   [<c01487e6>] __setup_irq+0x17a/0x1f3
> > [  258.392124]   [<c05ce79d>] start_kernel+0x285/0x2f1
> > [  258.392140]   [<ffffffff>] 0xffffffff
> > [  258.392159] irq event stamp: 1844456
> > [  258.392164] hardirqs last  enabled at (1844456): [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
> > [  258.392175] hardirqs last disabled at (1844455): [<c03c4ac3>] _spin_lock_irq+0xa/0x4b
> > [  258.392186] softirqs last  enabled at (1844310): [<c0125406>] do_softirq+0x37/0x4d
> > [  258.392198] softirqs last disabled at (1844447): [<c0125406>] do_softirq+0x37/0x4d
> 
> 
> That's a bit weird. Looks like another bug in the IRQ layer.

Something happens with the hardware that confuses the kernel. It's
triggered by software but I don't know where.. Like Michael, I'm
not too convinced that it is in b43. :\


//Peter


From Larry.Finger at lwfinger.net  Sun Nov 23 22:09:34 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Sun, 23 Nov 2008 15:09:34 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <20081123204631.21061.qmail@stuge.se>
References: <200811151801.02369.yuval@avramzon.net>
	<200811221654.09399.mb@bu3sch.de>
	<200811231350.00207.yuval@avramzon.net>
	<200811231320.30289.mb@bu3sch.de>
	<20081123204631.21061.qmail@stuge.se>
Message-ID: <4929C68E.6080401@lwfinger.net>

Peter Stuge wrote:
> Michael Buesch wrote:
>> On Sunday 23 November 2008 12:49:55 Yuval Hager wrote:
>>> [  182.891400] ****** b43: B43_MMIO_MACCTL 0x840A0503
>>> [  182.891409] ****** b43: SSB_TMSLOW 0x20150000
>>> [  258.299027] irq 10: nobody cared (try booting with the "irqpoll" option)
>> Does the kernel disable the PCI device, if it ignores the IRQ?
> 
> The kernel disables the IRQ at least internally, maybe also by
> deconfiguring the interrupt register in any devices using it, which
> would explain the change in config register 0x3c (but not the changes
> in all the other bytes, could that be a freak chain reaction inside
> the hardware?) but I haven't heard/seen the kernel disable the PCI
> device itself. I don't know if it can.
> 
> Why doesn't b43 care about this interrupt? Without APIC interrupt 10
> is what both device and driver should be using (according to earlier
> lspci -x output).

I think by this point the BCM43xx hardware is disabled.

>>> [  258.299173] handlers:
>>> [  258.299176] [<f7906455>] (b43_interrupt_handler+0x0/0x1b7 [b43])
>>> [  258.299212] Disabling IRQ #10
>>> [  258.315148] b43-phy0: Radio hardware status changed to DISABLED
>>> [  258.315160] b43-phy0: ******** B43_B43_MMIO_RADIO_HWENABLED_HI 0xFFFFFFFF
>>> [  258.342341] kobject: 'rfkill0' (f43b7d78): kobject_uevent_env
>>> [  258.342367] kobject: 'rfkill0' (f43b7d78): fill_kobj_path: path = '/class/rfkill/rfkill0'
>>> [  258.342418] kobject: 'ssb0:0' (f40dfcd8): fill_kobj_path: path = '/devices/pci0000:00/0000:00:02.0/0000:02:00.0/ssb0:0'
> 
> Why does the radio hw status changes here?
> How is the change notified to the driver?

By setting a bit in the appropriate register; however, device is disabled and
all bits are set. This is a false indication.

>>> [  258.391951] 
>>> [  258.391956] =================================
>>> [  258.391964] [ INFO: inconsistent lock state ]
>>> [  258.391971] 2.6.28-rc5 #15
>>> [  258.391975] ---------------------------------
>>> [  258.391980] inconsistent {in-hardirq-W} -> {hardirq-on-W} usage.
>>> [  258.391987] X/3965 [HC0[0]:SC1[1]:HE1:SE0] takes:
>>> [  258.391993]  (&irq_desc_lock_class){++..}, at: [<c0148c60>] try_one_irq+0x15/0xe8
>>> [  258.392016] {in-hardirq-W} state was registered at:
>>> [  258.392021]   [<c013bc07>] __lock_acquire+0x490/0x6bc
>>> [  258.392034]   [<c013be8d>] lock_acquire+0x5a/0x74
>>> [  258.392043]   [<c01496f8>] handle_level_irq+0x12/0xba
>>> [  258.392053]   [<c03c4842>] _spin_lock+0x1c/0x45
>>> [  258.392066]   [<c01496f8>] handle_level_irq+0x12/0xba
>>> [  258.392076]   [<c01496f8>] handle_level_irq+0x12/0xba
>>> [  258.392085]   [<c010564e>] do_IRQ+0x89/0x9f
>>> [  258.392096]   [<c0103ea8>] common_interrupt+0x28/0x30
>>> [  258.392105]   [<c03c4cc2>] _spin_unlock_irqrestore+0x37/0x39
>>> [  258.392115]   [<c01487e6>] __setup_irq+0x17a/0x1f3
>>> [  258.392124]   [<c05ce79d>] start_kernel+0x285/0x2f1
>>> [  258.392140]   [<ffffffff>] 0xffffffff
>>> [  258.392159] irq event stamp: 1844456
>>> [  258.392164] hardirqs last  enabled at (1844456): [<c03c4b6f>] _spin_unlock_irq+0x20/0x23
>>> [  258.392175] hardirqs last disabled at (1844455): [<c03c4ac3>] _spin_lock_irq+0xa/0x4b
>>> [  258.392186] softirqs last  enabled at (1844310): [<c0125406>] do_softirq+0x37/0x4d
>>> [  258.392198] softirqs last disabled at (1844447): [<c0125406>] do_softirq+0x37/0x4d
>>
>> That's a bit weird. Looks like another bug in the IRQ layer.
> 
> Something happens with the hardware that confuses the kernel. It's
> triggered by software but I don't know where.. Like Michael, I'm
> not too convinced that it is in b43. :\


From yuval at avramzon.net  Mon Nov 24 09:49:38 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Mon, 24 Nov 2008 10:49:38 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <4929C68E.6080401@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<20081123204631.21061.qmail@stuge.se>
	<4929C68E.6080401@lwfinger.net>
Message-ID: <200811241049.45734.yuval@avramzon.net>

On Sunday 23 November 2008, Larry Finger wrote:
> From a config file posted earlier, the OP is using SLAB. Is there any point
> in trying SLUB?

Another try, not sure what it means:

* Added CONFIG_SLUB and CONFIG_SLUB_DEBUG

* boot parameters: root=/dev/sda3 debug memory_corruption_check=1 devres.log=1 debug_objects debugpat 
acpi.debug_layer=0x00410002 acpi.debug_level=0xffffffff acpi=off apic=debug nolapic irqpoll pci=noacpi slub_debug=FZPU

* cat /proc/interrupts is
           CPU0       
  0:      16658    XT-PIC-XT        timer
  1:        289    XT-PIC-XT        i8042
  2:          0    XT-PIC-XT        cascade
  3:         60    XT-PIC-XT        uhci_hcd:usb2, ehci_hcd:usb4
  5:       9163    XT-PIC-XT        sata_via, HDA Intel
  7:          0    XT-PIC-XT        uhci_hcd:usb3
  8:          2    XT-PIC-XT        rtc
 10:       1712    XT-PIC-XT        b43
 11:        131    XT-PIC-XT        uhci_hcd:usb1
 12:        706    XT-PIC-XT        i8042
 14:          0    XT-PIC-XT        ide0
 15:          0    XT-PIC-XT        ide1
NMI:          0   Non-maskable interrupts
LOC:          0   Local timer interrupts
RES:          0   Rescheduling interrupts
CAL:          0   Function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
SPU:          0   Spurious interrupts
ERR:          0
MIS:          0

* lspci -d 14e4:4312 -x
02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00

* xset dpms force standby
* wake up
* dmesg is virtually the same as before, complaining about nobody handling irq 10 and disabling it.
* /proc/interrupts now is
  0:      80987    XT-PIC-XT        timer
  1:       1027    XT-PIC-XT        i8042
  2:          0    XT-PIC-XT        cascade
  3:         60    XT-PIC-XT        uhci_hcd:usb2, ehci_hcd:usb4
  5:      10400    XT-PIC-XT        sata_via, HDA Intel
  7:          0    XT-PIC-XT        uhci_hcd:usb3
  8:          2    XT-PIC-XT        rtc
 10:     200000    XT-PIC-XT        b43
 11:        131    XT-PIC-XT        uhci_hcd:usb1
 12:       3059    XT-PIC-XT        i8042
 14:          0    XT-PIC-XT        ide0
 15:          0    XT-PIC-XT        ide1
NMI:          0   Non-maskable interrupts
LOC:          0   Local timer interrupts
RES:          0   Rescheduling interrupts
CAL:          0   Function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
SPU:          0   Spurious interrupts
ERR:          0
MIS:          0

* Now check this out - the output of lspci -d 14e4:4312 -x
02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev ff)
00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
10: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
20: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
30: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff

(I double checked this)

huh?

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081124/43e41315/attachment.pgp>

From mb at bu3sch.de  Mon Nov 24 11:55:45 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Mon, 24 Nov 2008 11:55:45 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811241049.45734.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<4929C68E.6080401@lwfinger.net>
	<200811241049.45734.yuval@avramzon.net>
Message-ID: <200811241155.47079.mb@bu3sch.de>

On Monday 24 November 2008 09:49:38 Yuval Hager wrote:
> On Sunday 23 November 2008, Larry Finger wrote:
> > From a config file posted earlier, the OP is using SLAB. Is there any point
> > in trying SLUB?
> 
> Another try, not sure what it means:
> 
> * Added CONFIG_SLUB and CONFIG_SLUB_DEBUG
> 
> * boot parameters: root=/dev/sda3 debug memory_corruption_check=1 devres.log=1 debug_objects debugpat 
> acpi.debug_layer=0x00410002 acpi.debug_level=0xffffffff acpi=off apic=debug nolapic irqpoll pci=noacpi slub_debug=FZPU
> 
> * cat /proc/interrupts is
>            CPU0       
>   0:      16658    XT-PIC-XT        timer
>   1:        289    XT-PIC-XT        i8042
>   2:          0    XT-PIC-XT        cascade
>   3:         60    XT-PIC-XT        uhci_hcd:usb2, ehci_hcd:usb4
>   5:       9163    XT-PIC-XT        sata_via, HDA Intel
>   7:          0    XT-PIC-XT        uhci_hcd:usb3
>   8:          2    XT-PIC-XT        rtc
>  10:       1712    XT-PIC-XT        b43
>  11:        131    XT-PIC-XT        uhci_hcd:usb1
>  12:        706    XT-PIC-XT        i8042
>  14:          0    XT-PIC-XT        ide0
>  15:          0    XT-PIC-XT        ide1
> NMI:          0   Non-maskable interrupts
> LOC:          0   Local timer interrupts
> RES:          0   Rescheduling interrupts
> CAL:          0   Function call interrupts
> TLB:          0   TLB shootdowns
> TRM:          0   Thermal event interrupts
> SPU:          0   Spurious interrupts
> ERR:          0
> MIS:          0
> 
> * lspci -d 14e4:4312 -x
> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev 02)
> 00: e4 14 12 43 06 01 10 00 02 00 80 02 08 00 00 00
> 10: 04 c0 ff fd 00 00 00 00 00 00 00 00 00 00 00 00
> 20: 00 00 00 00 00 00 00 00 00 00 00 00 3c 10 71 13
> 30: 00 00 00 00 40 00 00 00 00 00 00 00 0a 01 00 00
> 
> * xset dpms force standby
> * wake up
> * dmesg is virtually the same as before, complaining about nobody handling irq 10 and disabling it.

Actually, b43 _does_ use IRQ10 now.
I guess the card dies such a horrible death, that it also asserts the IRQ line forever.

> * /proc/interrupts now is
>   0:      80987    XT-PIC-XT        timer
>   1:       1027    XT-PIC-XT        i8042
>   2:          0    XT-PIC-XT        cascade
>   3:         60    XT-PIC-XT        uhci_hcd:usb2, ehci_hcd:usb4
>   5:      10400    XT-PIC-XT        sata_via, HDA Intel
>   7:          0    XT-PIC-XT        uhci_hcd:usb3
>   8:          2    XT-PIC-XT        rtc
>  10:     200000    XT-PIC-XT        b43
>  11:        131    XT-PIC-XT        uhci_hcd:usb1
>  12:       3059    XT-PIC-XT        i8042
>  14:          0    XT-PIC-XT        ide0
>  15:          0    XT-PIC-XT        ide1
> NMI:          0   Non-maskable interrupts
> LOC:          0   Local timer interrupts
> RES:          0   Rescheduling interrupts
> CAL:          0   Function call interrupts
> TLB:          0   TLB shootdowns
> TRM:          0   Thermal event interrupts
> SPU:          0   Spurious interrupts
> ERR:          0
> MIS:          0
> 
> * Now check this out - the output of lspci -d 14e4:4312 -x
> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev ff)
> 00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> 10: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> 20: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> 30: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> 
> (I double checked this)
> 
> huh?

Hah, interesting. I think your hardware may be faulty, in fact.
To me it really seems like the mainboard has power failures on the PCI bus.

This is a laptop, so you can't pull random hardware? Can you run some
hardware burn-in tests like mprime (http://mersenne.org/freesoft/) or memtest?
If that doesn't help, can you try with another operating system?

-- 
Greetings Michael.


From Larry.Finger at lwfinger.net  Mon Nov 24 17:11:53 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Mon, 24 Nov 2008 10:11:53 -0600
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811241155.47079.mb@bu3sch.de>
References: <200811151801.02369.yuval@avramzon.net>
	<4929C68E.6080401@lwfinger.net>
	<200811241049.45734.yuval@avramzon.net>
	<200811241155.47079.mb@bu3sch.de>
Message-ID: <492AD249.3020309@lwfinger.net>

Michael Buesch wrote:
> On Monday 24 November 2008 09:49:38 Yuval Hager wrote:
>> * Now check this out - the output of lspci -d 14e4:4312 -x
>> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g (rev ff)
>> 00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>> 10: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>> 20: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>> 30: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>>
>> (I double checked this)
>>
>> huh?
> 
> Hah, interesting. I think your hardware may be faulty, in fact.
> To me it really seems like the mainboard has power failures on the PCI bus.
> 
> This is a laptop, so you can't pull random hardware? Can you run some
> hardware burn-in tests like mprime (http://mersenne.org/freesoft/) or memtest?
> If that doesn't help, can you try with another operating system?
> 

I also think you are seeing a hardware failure. Another test to try is
http://freshmeat.net/projects/cpuburn/?topic_id=146, which will exercise the system.

Larry


From yuval at avramzon.net  Tue Nov 25 06:43:22 2008
From: yuval at avramzon.net (Yuval Hager)
Date: Tue, 25 Nov 2008 07:43:22 +0200
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <492AD249.3020309@lwfinger.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811241155.47079.mb@bu3sch.de> <492AD249.3020309@lwfinger.net>
Message-ID: <200811250745.22487.yuval@avramzon.net>

On Monday 24 November 2008, Larry Finger wrote:
> Michael Buesch wrote:
> > On Monday 24 November 2008 09:49:38 Yuval Hager wrote:
> >> * Now check this out - the output of lspci -d 14e4:4312 -x
> >> 02:00.0 Network controller: Broadcom Corporation BCM4312 802.11a/b/g
> >> (rev ff) 00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> >> 10: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> >> 20: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> >> 30: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
> >>
> >> (I double checked this)
> >>
> >> huh?
> >
> > Hah, interesting. I think your hardware may be faulty, in fact.
> > To me it really seems like the mainboard has power failures on the PCI
> > bus.
> >
> > This is a laptop, so you can't pull random hardware? Can you run some
> > hardware burn-in tests like mprime (http://mersenne.org/freesoft/) or
> > memtest? If that doesn't help, can you try with another operating system?
>
> I also think you are seeing a hardware failure. Another test to try is
> http://freshmeat.net/projects/cpuburn/?topic_id=146, which will exercise
> the system.
>
> Larry

I can't argue with what the bits mean, but I must say it doesn't "feel" like a 
hardware problem. It is very consistent and deterministic. 

I've been running mprime & burnBX & burnMMX for over 6 hours and it is all 
fine (memtest not ran yet).

However, I have some few interesting findings. 
First, this is totally unrelated to b43, but to the PCI. I get the flawed 1's 
read from lspci even without loading b43.

I played around with different video drivers and the results are:
* If using the 'via' driver, I lose the PCIe card immediately upon 
initialization
* Using the 'openchrome' (trunk version), It works well in the beginning. 
After first blanking the register reads are all 1's, and then when the screen 
is blank I get a different read (some registers are correct, some are wrong), 
and when the screen is unblanked, I get 0xff's again. Very consistent and 
predictabe (same read every time).
* Using the 'vesa' driver I could not recreate the problem. I could not get 
the screen to blank for some reason, but closing the lid, going on 
standby/hibernate, restarting X - all didn't matter much to the PCI and the 
wireless card kept on working.

--yuval
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081125/ebb151b9/attachment.pgp>

From ml at jvh.net  Tue Nov 25 06:53:02 2008
From: ml at jvh.net (Jorge Van Hemelryck)
Date: Tue, 25 Nov 2008 06:53:02 +0100
Subject: repeated rfkill events on ASUS L5800C bcm4303 without rfkill
	switch
In-Reply-To: <20081101205913.28258800.ml@jvh.net>
References: <20081101205913.28258800.ml@jvh.net>
Message-ID: <20081125065302.0afee460.ml@jvh.net>

Doesn't anyone have any idea at all ?

Or maybe I should have trimmed down the logs a little bit...

I can also add that lshal --monitor gives this :

21:55:06.036: computer_logicaldev_input_4 condition ButtonPressed = wlan
21:55:07.032: computer_logicaldev_input_4 condition ButtonPressed = wlan
21:55:08.031: computer_logicaldev_input_4 condition ButtonPressed = wlan
21:55:09.030: computer_logicaldev_input_4 condition ButtonPressed = wlan

and so on... It might just be a consequence of the initial problem. But
I'm not sure how the inexistent rfkill button is translated into a
keypress of an additional event device.

How should I investigate further ? What additional information is
needed ?

-- 
Jorge Van Hemelryck


From peter at stuge.se  Tue Nov 25 08:18:18 2008
From: peter at stuge.se (Peter Stuge)
Date: Tue, 25 Nov 2008 08:18:18 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811250745.22487.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<200811241155.47079.mb@bu3sch.de> <492AD249.3020309@lwfinger.net>
	<200811250745.22487.yuval@avramzon.net>
Message-ID: <20081125071818.9256.qmail@stuge.se>

Yuval Hager wrote:
> I played around with different video drivers and the results are:
> * If using the 'via' driver, I lose the PCIe card immediately upon 
>   initialization
> * Using the 'openchrome' (trunk version), It works well in the
>   beginning.
>   After first blanking the register reads are all 1's, and then
>   when the screen is blank I get a different read (some registers
>   are correct, some are wrong), and when the screen is unblanked, I
>   get 0xff's again. Very consistent and predictabe (same read every
>   time).
> * Using the 'vesa' driver I could not recreate the problem. I could
>   not get the screen to blank for some reason, but closing the lid,
>   going on standby/hibernate, restarting X - all didn't matter much
>   to the PCI and the wireless card kept on working.

Good work! You have beyond any doubt established that the X graphics
driver can cause this problem.

Were you using a kernel framebuffer driver when you saw the problem
also without running X at all? If not, the cause of trouble then is
still unidentified.


//Peter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081125/35a1104b/attachment.pgp>

From mb at bu3sch.de  Tue Nov 25 12:05:49 2008
From: mb at bu3sch.de (Michael Buesch)
Date: Tue, 25 Nov 2008 12:05:49 +0100
Subject: BCM4312 Fails when xdm is started
In-Reply-To: <200811250745.22487.yuval@avramzon.net>
References: <200811151801.02369.yuval@avramzon.net>
	<492AD249.3020309@lwfinger.net>
	<200811250745.22487.yuval@avramzon.net>
Message-ID: <200811251205.49929.mb@bu3sch.de>

On Tuesday 25 November 2008 06:43:22 Yuval Hager wrote:
> However, I have some few interesting findings. 
> First, this is totally unrelated to b43, but to the PCI. I get the flawed 1's 
> read from lspci even without loading b43.
> 
> I played around with different video drivers and the results are:
> * If using the 'via' driver, I lose the PCIe card immediately upon 
> initialization
> * Using the 'openchrome' (trunk version), It works well in the beginning. 
> After first blanking the register reads are all 1's, and then when the screen 
> is blank I get a different read (some registers are correct, some are wrong), 
> and when the screen is unblanked, I get 0xff's again. Very consistent and 
> predictabe (same read every time).
> * Using the 'vesa' driver I could not recreate the problem. I could not get 
> the screen to blank for some reason, but closing the lid, going on 
> standby/hibernate, restarting X - all didn't matter much to the PCI and the 
> wireless card kept on working.

Ok, then you should report the stuff to the X guys. This is not a b43 problem
and I also don't think it's a kernel problem.

-- 
Greetings Michael.


From kevyn.alexandre.pare at gmail.com  Tue Nov 25 19:58:22 2008
From: kevyn.alexandre.pare at gmail.com (=?ISO-8859-1?Q?Kevyn-Alexandre_Par=E9?=)
Date: Tue, 25 Nov 2008 13:58:22 -0500
Subject: BCM4310 unsupported
Message-ID: <dc1d0f40811251058l207d28f2ie368ed1e4a831a0@mail.gmail.com>

Hi,

I would like to help for the BCM4310 by test with my dell vostro 1310. I
would like also to help in implementation but I must said that this will be
my first steps.

I'm reading HOWTO do Linux kernel development (kernel doc) and I have
piratically finish the Embeddded Linux kernel and driver
developmenttraining from

http://free-electrons.com/docs/kernel/

Any suggestion will be welcome (waiting for task description)

What I know right now is from http://linuxwireless.org/en/users/Drivers/b43

BCM 4310 - This device has an LP PHY. We think that means low power. In any
case, previous code does not work. The reverse engineers have translated a
great deal of the code and are currently generating specs for the code
writers.

I'm reading everything about BCM4310 in the archive mailing list!

Thx

kap


/**
 * Ask not what your Linux kernel can do for you - ask what you can do for
your Linux kernel
 * Inspiration come from
http://www.linuxfoundation.org/en/Kernel_Driver_Statement
 */
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/bcm43xx-dev/attachments/20081125/02d8c695/attachment.html>

From Larry.Finger at lwfinger.net  Tue Nov 25 20:29:29 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Tue, 25 Nov 2008 13:29:29 -0600
Subject: BCM4310 unsupported
In-Reply-To: <dc1d0f40811251058l207d28f2ie368ed1e4a831a0@mail.gmail.com>
References: <dc1d0f40811251058l207d28f2ie368ed1e4a831a0@mail.gmail.com>
Message-ID: <492C5219.30201@lwfinger.net>

Kevyn-Alexandre Par? wrote:
> Hi,
> 
> I would like to help for the BCM4310 by test with my dell vostro 1310. I
> would like also to help in implementation but I must said that this will
> be my first steps.

Thanks for the offer of help. At the moment, the easy routines for the LP PHY
have been translated, and only the trickier ones need to be converted into
specifications. If you have experience with the assembly language for the MIPS
processor, then we would welcome your help. If not, then I think it best you
wait until test code is presented here. Of course, I have no idea when that will
happen.

Larry



From a.babich at rez.ru  Wed Nov 26 05:41:03 2008
From: a.babich at rez.ru (Alexei Babich)
Date: Wed, 26 Nov 2008 09:41:03 +0500
Subject: bcm4312 does not work
Message-ID: <200811260941.04090.a.babich@rez.ru>

Hello, all.
I have 'Dell Vostro 1000' with bcm4312 (802.11 b\g) card ('lspci' and 'lspci -n' outputs attached) .
ArchLinux with kernel-2.6.27 (x86_64) installed.
Firmware installed as described at http://linuxwireless.org/en/users/Drivers/b43#fw-b43-new. Listing of /lib/firmware/b43 attached.
So, when I insert module b43, nothing happens. iwconfig shows nothing, dmesg shows only "Broadcom 43xx driver loaded [ Features: PMLR, Firmware-ID: FW13 ]". All looks like driver not support this hardware.

Can anybody tell me, what is going on ? :)

Thank you.

PS: on winXP this hardware work fine with 2.4 GHz access-points.
-- 
Regards,
Alexei Babich, circuit engineer, OOO NPP "Rezonans", Chelyabinsk, Russia
http://www.rez.ru
Jabber ID: impatt at jabber.ru
-------------- next part --------------
00:00.0 Host bridge: ATI Technologies Inc RS480 Host Bridge (rev 10)
00:01.0 PCI bridge: ATI Technologies Inc RS480 PCI Bridge
00:05.0 PCI bridge: ATI Technologies Inc RS480 PCI Bridge
00:06.0 PCI bridge: ATI Technologies Inc RS480 PCI Bridge
00:12.0 SATA controller: ATI Technologies Inc SB600 Non-Raid-5 SATA
00:13.0 USB Controller: ATI Technologies Inc SB600 USB (OHCI0)
00:13.1 USB Controller: ATI Technologies Inc SB600 USB (OHCI1)
00:13.2 USB Controller: ATI Technologies Inc SB600 USB (OHCI2)
00:13.3 USB Controller: ATI Technologies Inc SB600 USB (OHCI3)
00:13.4 USB Controller: ATI Technologies Inc SB600 USB (OHCI4)
00:13.5 USB Controller: ATI Technologies Inc SB600 USB Controller (EHCI)
00:14.0 SMBus: ATI Technologies Inc SBx00 SMBus Controller (rev 14)
00:14.1 IDE interface: ATI Technologies Inc SB600 IDE
00:14.2 Audio device: ATI Technologies Inc SBx00 Azalia (Intel HDA)
00:14.3 ISA bridge: ATI Technologies Inc SB600 PCI to LPC Bridge
00:14.4 PCI bridge: ATI Technologies Inc SBx00 PCI to PCI Bridge
00:18.0 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] HyperTransport Technology Configuration
00:18.1 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] Address Map
00:18.2 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] DRAM Controller
00:18.3 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] Miscellaneous Control
01:05.0 VGA compatible controller: ATI Technologies Inc RS482 [Radeon Xpress 200]
05:00.0 Network controller: Broadcom Corporation BCM4312 802.11b/g (rev 01)
08:00.0 Ethernet controller: Broadcom Corporation BCM4401-B0 100Base-TX (rev 02)
08:01.0 SD Host controller: Ricoh Co Ltd R5C822 SD/SDIO/MMC/MS/MSPro Host Adapter (rev 19)
08:01.1 System peripheral: Ricoh Co Ltd R5C843 MMC Host Controller (rev 01)
-------------- next part --------------
00:00.0 0600: 1002:5950 (rev 10)
00:01.0 0604: 1002:5a3f
00:05.0 0604: 1002:5a37
00:06.0 0604: 1002:5a38
00:12.0 0106: 1002:4380
00:13.0 0c03: 1002:4387
00:13.1 0c03: 1002:4388
00:13.2 0c03: 1002:4389
00:13.3 0c03: 1002:438a
00:13.4 0c03: 1002:438b
00:13.5 0c03: 1002:4386
00:14.0 0c05: 1002:4385 (rev 14)
00:14.1 0101: 1002:438c
00:14.2 0403: 1002:4383
00:14.3 0601: 1002:438d
00:14.4 0604: 1002:4384
00:18.0 0600: 1022:1100
00:18.1 0600: 1022:1101
00:18.2 0600: 1022:1102
00:18.3 0600: 1022:1103
01:05.0 0300: 1002:5974
05:00.0 0280: 14e4:4315 (rev 01)
08:00.0 0200: 14e4:170c (rev 02)
08:01.0 0805: 1180:0822 (rev 19)
08:01.1 0880: 1180:0843 (rev 01)
-------------- next part --------------
/lib/firmware/b43/
/lib/firmware/b43/pcm5.fw
/lib/firmware/b43/pcm4.fw
/lib/firmware/b43/ucode15.fw
/lib/firmware/b43/ucode14.fw
/lib/firmware/b43/ucode13.fw
/lib/firmware/b43/ucode11.fw
/lib/firmware/b43/ucode9.fw
/lib/firmware/b43/ucode5.fw
/lib/firmware/b43/ucode4.fw
/lib/firmware/b43/lp0bsinitvals15.fw
/lib/firmware/b43/lp0initvals15.fw
/lib/firmware/b43/lp0bsinitvals14.fw
/lib/firmware/b43/lp0initvals14.fw
/lib/firmware/b43/a0g1bsinitvals13.fw
/lib/firmware/b43/a0g1initvals13.fw
/lib/firmware/b43/b0g0bsinitvals13.fw
/lib/firmware/b43/b0g0initvals13.fw
/lib/firmware/b43/lp0bsinitvals13.fw
/lib/firmware/b43/lp0initvals13.fw
/lib/firmware/b43/n0absinitvals11.fw
/lib/firmware/b43/n0bsinitvals11.fw
/lib/firmware/b43/n0initvals11.fw
/lib/firmware/b43/a0g1bsinitvals9.fw
/lib/firmware/b43/a0g0bsinitvals9.fw
/lib/firmware/b43/a0g1initvals9.fw
/lib/firmware/b43/a0g0initvals9.fw
/lib/firmware/b43/b0g0bsinitvals9.fw
/lib/firmware/b43/b0g0initvals9.fw
/lib/firmware/b43/a0g1bsinitvals5.fw
/lib/firmware/b43/a0g0bsinitvals5.fw
/lib/firmware/b43/a0g1initvals5.fw
/lib/firmware/b43/a0g0initvals5.fw
/lib/firmware/b43/b0g0bsinitvals5.fw
/lib/firmware/b43/b0g0initvals5.fw
/lib/firmware/b43/a0g0bsinitvals4.fw
/lib/firmware/b43/a0g0initvals4.fw
/lib/firmware/b43/b0g0bsinitvals4.fw
/lib/firmware/b43/b0g0initvals4.fw

From Larry.Finger at lwfinger.net  Wed Nov 26 06:06:23 2008
From: Larry.Finger at lwfinger.net (Larry Finger)
Date: Tue, 25 Nov 2008 23:06:23 -0600
Subject: bcm4312 does not work
In-Reply-To: <200811260941.04090.a.babich@rez.ru>
References: <200811260941.04090.a.babich@rez.ru>
Message-ID: <492CD94F.5030302@lwfinger.net>

Alexei Babich wrote:
> Hello, all.
> I have 'Dell Vostro 1000' with bcm4312 (802.11 b\g) card ('lspci' and 'lspci -n' outputs attached) .
> ArchLinux with kernel-2.6.27 (x86_64) installed.
> Firmware installed as described at http://linuxwireless.org/en/users/Drivers/b43#fw-b43-new. Listing of /lib/firmware/b43 attached.
> So, when I insert module b43, nothing happens. iwconfig shows nothing, dmesg shows only "Broadcom 43xx driver loaded [ Features: PMLR, Firmware-ID: FW13 ]". All looks like driver not support this hardware.
> 
> Can anybody tell me, what is going on ? :)

The driver does not support devices with a PCI ID of 0x4315. We are working on
the reverse engineering for them, but it is not ready yet.

Larry



From a.babich at rez.ru  Wed Nov 26 06:24:57 2008
From: a.babich at rez.ru (Alexei Babich)
Date: Wed, 26 Nov 2008 10:24:57 +0500
Subject: bcm4312 does not work
In-Reply-To: <492CD94F.5030302@lwfinger.net>
References: <200811260941.04090.a.babich@rez.ru>
	<492CD94F.5030302@lwfinger.net>
Message-ID: <200811261024.57864.a.babich@rez.ru>

> The driver does not support devices with a PCI ID of 0x4315. We are working on
> the reverse engineering for them, but it is not ready yet.

Thank you for your reply.
-- 
Regards,
Alexei Babich, circuit engineer, OOO NPP "Rezonans", Chelyabinsk, Russia
http://www.rez.ru
Jabber ID: impatt at jabber.ru


From peterskurt at msn.com  Sun Nov 30 01:44:11 2008
From: peterskurt at msn.com (KURT PETERS)
Date: Sat, 29 Nov 2008 17:44:11 -0700
Subject: Former problems with 4306 and disconnects
In-Reply-To: <mailman.41.1225710085.4713.bcm43xx-dev@lists.berlios.de>
Message-ID: <BAY103-F35AA43C20F655BEE87A026D8060@phx.gbl>

I'm not sure what the solution was, but with regards to my previous problems 
with disconnects:
I just installed 2.6.27-7 and the latest wicd: 1.5.4 and I no longer have 
the disconnect problem.
Unfortunately, I did them at essentially the same time, so I'm not too sure 
what fixed the problem.
Kurt




From mmazur at kernel.pl  Sun Nov 30 13:54:28 2008
From: mmazur at kernel.pl (Mariusz Mazur)
Date: Sun, 30 Nov 2008 13:54:28 +0100
Subject: 4311 drops outgoing traffic
Message-ID: <200811301354.28679.mmazur@kernel.pl>

(Sent this a few days ago before getting subscribed to the list. Probably 
stuck at moderation.)

The b43 driver repeatedly (once very half-hour maybe) breaks the wifi 
connection. It doesn't drop the whole connection -- traffic is still being 
received correctly (tcpdump shows that eg. arp traffic from the router is 
visible), but any sent packets never reach their destination. Having 
network-manager reconnect fixes the problem without having to resort to any 
drastic measures (like reloading the driver). Curiously -- while poking 
around a hung connection (tcpdump, etc.), after about 15 minutes it started 
working again. Haven't noticed gnome-manager reconnecting and didn't think of 
checking dmesg, but it looked like it fixed itself somehow.

I'm unable to pinpoint any traffic patterns that can reproduce the problem. It 
just happens. Often enough as to render the laptop allmost useless. Never 
experienced similar problems under vista, will most likely check ndiswrapper 
soonish to see how that works.

The system is an hp pavilion dv6000 with a 4311 rev 02 running ubuntu intrepid 
ibex:
Linux lena 2.6.27-7-generic #1 SMP Tue Nov 4 19:33:20 UTC 2008 i686 GNU/Linux

It's connected to a wrt54gl running openwrt ("drunken russian" or something 
like that). The bug occurred both with wpa1 and wpa2 encryption.

Attached are dmesg and lspci dumps.

What I'd be really interested in is how such bugs can be debugged. Assuming I 
have a hung connection, what can I do with it to gather some useful debugging 
data?


-- 
Judge others by their intentions and yourself by your results.
                                                                 Guy Kawasaki
Education is an admirable thing, but it is well to remember from
time to time that nothing that is worth knowing can be taught.
                                                                  Oscar Wilde
-------------- next part --------------
00:01.3 0b40: 10de:0543 (rev a2)
	Subsystem: 103c:30cf
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
	Status: Cap- 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx-
	Latency: 0 (750ns min, 250ns max)
	Interrupt: pin B routed to IRQ 11
	Region 0: Memory at f6200000 (32-bit, non-prefetchable) [size=512K]

--
02:05.2 0880: 1180:0843 (rev 12)
	Subsystem: 103c:30cf
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx-
	Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx-
	Latency: 64, Cache Line Size: 64 bytes
	Interrupt: pin B routed to IRQ 11
	Region 0: Memory at f6100c00 (32-bit, non-prefetchable) [size=256]
	Capabilities: [80] Power Management version 2
--
03:00.0 0280: 14e4:4311 (rev 02)
	Subsystem: 103c:1375
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx-
	Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx-
	Latency: 0, Cache Line Size: 64 bytes
	Interrupt: pin A routed to IRQ 19
	Region 0: Memory at f6000000 (64-bit, non-prefetchable) [size=16K]
	Capabilities: [40] Power Management version 3
--
	Kernel driver in use: b43-pci-bridge
	Kernel modules: wl, ssb

-------------- next part --------------
[    0.000000] Initializing cgroup subsys cpuset
[    0.000000] Initializing cgroup subsys cpu
[    0.000000] Linux version 2.6.27-7-generic (buildd at palmer) (gcc version 4.3.2 (Ubuntu 4.3.2-1ubuntu11) ) #1 SMP Tue Nov 4 19:33:20 UTC 2008 (Ubuntu 2.6.27-7.16-generic)
[    0.000000] BIOS-provided physical RAM map:
[    0.000000]  BIOS-e820: 0000000000000000 - 000000000009e000 (usable)
[    0.000000]  BIOS-e820: 000000000009e000 - 00000000000a0000 (reserved)
[    0.000000]  BIOS-e820: 00000000000d2000 - 0000000000100000 (reserved)
[    0.000000]  BIOS-e820: 0000000000100000 - 000000003bf50000 (usable)
[    0.000000]  BIOS-e820: 000000003bf50000 - 000000003bf65000 (ACPI data)
[    0.000000]  BIOS-e820: 000000003bf65000 - 000000003bf66000 (ACPI NVS)
[    0.000000]  BIOS-e820: 000000003bf66000 - 0000000040000000 (reserved)
[    0.000000]  BIOS-e820: 00000000e0000000 - 00000000f0000000 (reserved)
[    0.000000]  BIOS-e820: 00000000fec00000 - 00000000fec10000 (reserved)
[    0.000000]  BIOS-e820: 00000000fee00000 - 00000000fee01000 (reserved)
[    0.000000]  BIOS-e820: 00000000fff80000 - 0000000100000000 (reserved)
[    0.000000] last_pfn = 0x3bf50 max_arch_pfn = 0x100000
[    0.000000] kernel direct mapping tables up to 38000000 @ 7000-c000
[    0.000000] RAMDISK: 37823000 - 37feffd1
[    0.000000] DMI present.
[    0.000000] ACPI: RSDP 000F8250, 0024 (r2 PTLTD )
[    0.000000] ACPI: XSDT 3BF5C61E, 006C (r1 HPQOEM SLIC-MPC  6040000  LTP        0)
[    0.000000] ACPI: FACP 3BF649FC, 00F4 (r3 NVIDIA MCP67-M   6040000 PTL_    F4240)
[    0.000000] ACPI: DSDT 3BF5C68A, 82FE (r1 NVIDIA    MCP67  6040000 MSFT  3000000)
[    0.000000] ACPI: FACS 3BF65FC0, 0040
[    0.000000] ACPI: TCPA 3BF64AF0, 0032 (r1 Phoeni  x        6040000  TL         0)
[    0.000000] ACPI: SRAT 3BF64B22, 00A0 (r1 AMD    HAMMER    6040000 AMD         1)
[    0.000000] ACPI: SSDT 3BF64BC2, 01C4 (r1 PTLTD  POWERNOW  6040000  LTP        1)
[    0.000000] ACPI: MCFG 3BF64D86, 003C (r1 PTLTD    MCFG    6040000  LTP        0)
[    0.000000] ACPI: HPET 3BF64DC2, 0038 (r1 PTLTD  HPETTBL   6040000  LTP        1)
[    0.000000] ACPI: APIC 3BF64DFA, 0068 (r1 PTLTD  	 APIC    6040000  LTP        0)
[    0.000000] ACPI: BOOT 3BF64E62, 0028 (r1 PTLTD  $SBFTBL$  6040000  LTP        1)
[    0.000000] ACPI: SLIC 3BF64E8A, 0176 (r1 HPQOEM SLIC-MPC  6040000  LTP        1)
[    0.000000] ACPI: DMI detected: Hewlett-Packard
[    0.000000] 63MB HIGHMEM available.
[    0.000000] 896MB LOWMEM available.
[    0.000000]   mapped low ram: 0 - 38000000
[    0.000000]   low ram: 00000000 - 38000000
[    0.000000]   bootmap 00008000 - 0000f000
[    0.000000] (9 early reservations) ==> bootmem [0000000000 - 0038000000]
[    0.000000]   #0 [0000000000 - 0000001000]   BIOS data page ==> [0000000000 - 0000001000]
[    0.000000]   #1 [0000001000 - 0000002000]    EX TRAMPOLINE ==> [0000001000 - 0000002000]
[    0.000000]   #2 [0000006000 - 0000007000]       TRAMPOLINE ==> [0000006000 - 0000007000]
[    0.000000]   #3 [0000100000 - 00005c0a20]    TEXT DATA BSS ==> [0000100000 - 00005c0a20]
[    0.000000]   #4 [0037823000 - 0037feffd1]          RAMDISK ==> [0037823000 - 0037feffd1]
[    0.000000]   #5 [00005c1000 - 00005c4000]    INIT_PG_TABLE ==> [00005c1000 - 00005c4000]
[    0.000000]   #6 [000009e000 - 0000100000]    BIOS reserved ==> [000009e000 - 0000100000]
[    0.000000]   #7 [0000007000 - 0000008000]          PGTABLE ==> [0000007000 - 0000008000]
[    0.000000]   #8 [0000008000 - 000000f000]          BOOTMAP ==> [0000008000 - 000000f000]
[    0.000000] found SMP MP-table at [c00f8220] 000f8220
[    0.000000] Zone PFN ranges:
[    0.000000]   DMA      0x00000000 -> 0x00001000
[    0.000000]   Normal   0x00001000 -> 0x00038000
[    0.000000]   HighMem  0x00038000 -> 0x0003bf50
[    0.000000] Movable zone start PFN for each node
[    0.000000] early_node_map[2] active PFN ranges
[    0.000000]     0: 0x00000000 -> 0x0000009e
[    0.000000]     0: 0x00000100 -> 0x0003bf50
[    0.000000] On node 0 totalpages: 245486
[    0.000000] free_area_init_node: node 0, pgdat c048a500, node_mem_map c1000000
[    0.000000]   DMA zone: 3962 pages, LIFO batch:0
[    0.000000]   Normal zone: 223300 pages, LIFO batch:31
[    0.000000]   HighMem zone: 16065 pages, LIFO batch:3
[    0.000000] Detected use of extended apic ids on hypertransport bus
[    0.000000] ACPI: PM-Timer IO Port: 0x1008
[    0.000000] ACPI: Local APIC address 0xfee00000
[    0.000000] ACPI: LAPIC (acpi_id[0x00] lapic_id[0x00] enabled)
[    0.000000] ACPI: LAPIC (acpi_id[0x01] lapic_id[0x01] enabled)
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x00] high edge lint[0x1])
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x01] high edge lint[0x1])
[    0.000000] ACPI: IOAPIC (id[0x02] address[0xfec00000] gsi_base[0])
[    0.000000] IOAPIC[0]: apic_id 2, version 17, address 0xfec00000, GSI 0-23
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 low level)
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)
[    0.000000] ACPI: IRQ0 used by override.
[    0.000000] ACPI: IRQ2 used by override.
[    0.000000] ACPI: IRQ9 used by override.
[    0.000000] Enabling APIC mode:  Flat.  Using 1 I/O APICs
[    0.000000] ACPI: HPET id: 0x10de8201 base: 0xfed00000
[    0.000000] Using ACPI (MADT) for SMP configuration information
[    0.000000] SMP: Allowing 2 CPUs, 0 hotplug CPUs
[    0.000000] mapped APIC to ffffb000 (fee00000)
[    0.000000] mapped IOAPIC to ffffa000 (fec00000)
[    0.000000] PM: Registered nosave memory: 000000000009e000 - 00000000000a0000
[    0.000000] PM: Registered nosave memory: 00000000000a0000 - 00000000000d2000
[    0.000000] PM: Registered nosave memory: 00000000000d2000 - 0000000000100000
[    0.000000] Allocating PCI resources starting at 50000000 (gap: 40000000:a0000000)
[    0.000000] PERCPU: Allocating 41628 bytes of per cpu data
[    0.000000] NR_CPUS: 64, nr_cpu_ids: 2, nr_node_ids 1
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 243327
[    0.000000] Kernel command line: resume=/dev/sda2 root=UUID=7d0a6fbb-504e-4fec-a351-bea2b1fd437c ro quiet splash 
[    0.000000] Enabling fast FPU save and restore... done.
[    0.000000] Enabling unmasked SIMD FPU exception support... done.
[    0.000000] Initializing CPU#0
[    0.000000] PID hash table entries: 4096 (order: 12, 16384 bytes)
[    0.000000] Extended CMOS year: 2000
[    0.000000] TSC: PIT calibration confirmed by PMTIMER.
[    0.000000] TSC: using PIT calibration value
[    0.000000] Detected 1700.118 MHz processor.
[    0.004000] spurious 8259A interrupt: IRQ7.
[    0.004000] Console: colour VGA+ 80x25
[    0.004000] console [tty0] enabled
[    0.004000] Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)
[    0.004000] Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)
[    0.004000] Memory: 959296k/982336k available (2572k kernel code, 22432k reserved, 1160k data, 424k init, 64832k highmem)
[    0.004000] virtual kernel memory layout:
[    0.004000]     fixmap  : 0xffc77000 - 0xfffff000   (3616 kB)
[    0.004000]     pkmap   : 0xff400000 - 0xff800000   (4096 kB)
[    0.004000]     vmalloc : 0xf8800000 - 0xff3fe000   ( 107 MB)
[    0.004000]     lowmem  : 0xc0000000 - 0xf8000000   ( 896 MB)
[    0.004000]       .init : 0xc04ab000 - 0xc0515000   ( 424 kB)
[    0.004000]       .data : 0xc03832aa - 0xc04a5680   (1160 kB)
[    0.004000]       .text : 0xc0100000 - 0xc03832aa   (2572 kB)
[    0.004000] Checking if this processor honours the WP bit even in supervisor mode...Ok.
[    0.004000] CPA: page pool initialized 1 of 1 pages preallocated
[    0.004000] SLUB: Genslabs=12, HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1
[    0.004000] hpet clockevent registered
[    0.004000] Calibrating delay loop (skipped), value calculated using timer frequency.. 3400.23 BogoMIPS (lpj=6800472)
[    0.004000] Security Framework initialized
[    0.004000] SELinux:  Disabled at boot.
[    0.004000] AppArmor: AppArmor initialized
[    0.004000] Mount-cache hash table entries: 512
[    0.004000] Initializing cgroup subsys ns
[    0.004000] Initializing cgroup subsys cpuacct
[    0.004000] Initializing cgroup subsys memory
[    0.004000] CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (64 bytes/line)
[    0.004000] CPU: L2 Cache: 256K (64 bytes/line)
[    0.004000] CPU 0(2) -> Core 0
[    0.004000] using C1E aware idle routine
[    0.004000] Checking 'hlt' instruction... OK.
[    0.017755] ACPI: Core revision 20080609
[    0.020699] ACPI: Checking initramfs for custom DSDT
[    0.420326] ENABLING IO-APIC IRQs
[    0.420562] ..TIMER: vector=0x31 apic1=0 pin1=2 apic2=-1 pin2=-1
[    0.462918] CPU0: AMD Athlon(tm) 64 X2 Dual-Core Processor TK-53 stepping 01
[    0.464029] Booting processor 1/1 ip 6000
[    0.004000] Initializing CPU#1
[    0.004000] Calibrating delay using timer specific routine.. 3400.33 BogoMIPS (lpj=6800668)
[    0.004000] CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (64 bytes/line)
[    0.004000] CPU: L2 Cache: 256K (64 bytes/line)
[    0.004000] CPU 1(2) -> Core 1
[    0.548211] CPU1: AMD Athlon(tm) 64 X2 Dual-Core Processor TK-53 stepping 01
[    0.548243] Brought up 2 CPUs
[    0.548246] Total of 2 processors activated (6800.57 BogoMIPS).
[    0.548058] System has AMD C1E enabled
[    0.548072] Switch to broadcast mode on CPU1
[    0.548292] CPU0 attaching sched-domain:
[    0.548296]  domain 0: span 0-1 level CPU
[    0.548300]   groups: 0 1
[    0.548307] CPU1 attaching sched-domain:
[    0.548310]  domain 0: span 0-1 level CPU
[    0.548313]   groups: 1 0
[    0.548398] Switch to broadcast mode on CPU0
[    0.548398] net_namespace: 840 bytes
[    0.548398] Booting paravirtualized kernel on bare hardware
[    0.548398] Time: 23:49:14  Date: 11/27/08
[    0.548398] NET: Registered protocol family 16
[    0.548398] EISA bus registered
[    0.548398] ACPI: bus type pci registered
[    0.548398] PCI: MCFG configuration 0: base e0000000 segment 0 buses 0 - 4
[    0.548398] PCI: MCFG area at e0000000 reserved in E820
[    0.548398] PCI: Using MMCONFIG for extended config space
[    0.548398] PCI: Using configuration type 1 for base access
[    0.548932] ACPI: EC: Look up EC in DSDT
[    0.554913] ACPI: BIOS _OSI(Linux) query ignored via DMI
[    0.555897] ACPI: Interpreter enabled
[    0.555901] ACPI: (supports S0 S3 S4 S5)
[    0.555920] ACPI: Using IOAPIC for interrupt routing
[    0.556241] ACPI: EC: non-query interrupt received, switching to interrupt mode
[    0.580216] ACPI: EC: GPE = 0x10, I/O: command/status = 0x66, data = 0x62
[    0.580216] ACPI: EC: driver started in interrupt mode
[    0.580216] ACPI: PCI Root Bridge [PCI0] (0000:00)
[    0.580216] PCI: 0000:00:01.1 reg 10 io port: [3080, 30bf]
[    0.580220] PCI: 0000:00:01.1 reg 20 io port: [3040, 307f]
[    0.580225] PCI: 0000:00:01.1 reg 24 io port: [3000, 303f]
[    0.580242] pci 0000:00:01.1: PME# supported from D3hot D3cold
[    0.580248] pci 0000:00:01.1: PME# disabled
[    0.580299] PCI: 0000:00:01.3 reg 10 32bit mmio: [f6200000, f627ffff]
[    0.580376] PCI: 0000:00:02.0 reg 10 32bit mmio: [f6486000, f6486fff]
[    0.580399] pci 0000:00:02.0: supports D1
[    0.580401] pci 0000:00:02.0: supports D2
[    0.580404] pci 0000:00:02.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580408] pci 0000:00:02.0: PME# disabled
[    0.580429] PCI: 0000:00:02.1 reg 10 32bit mmio: [f6489000, f64890ff]
[    0.580455] pci 0000:00:02.1: supports D1
[    0.580457] pci 0000:00:02.1: supports D2
[    0.580460] pci 0000:00:02.1: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580464] pci 0000:00:02.1: PME# disabled
[    0.580488] PCI: 0000:00:04.0 reg 10 32bit mmio: [f6487000, f6487fff]
[    0.580511] pci 0000:00:04.0: supports D1
[    0.580513] pci 0000:00:04.0: supports D2
[    0.580515] pci 0000:00:04.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580519] pci 0000:00:04.0: PME# disabled
[    0.580541] PCI: 0000:00:04.1 reg 10 32bit mmio: [f6489400, f64894ff]
[    0.580567] pci 0000:00:04.1: supports D1
[    0.580569] pci 0000:00:04.1: supports D2
[    0.580572] pci 0000:00:04.1: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580576] pci 0000:00:04.1: PME# disabled
[    0.580611] PCI: 0000:00:06.0 reg 20 io port: [30c0, 30cf]
[    0.580648] PCI: 0000:00:07.0 reg 10 32bit mmio: [f6480000, f6483fff]
[    0.580675] pci 0000:00:07.0: PME# supported from D3hot D3cold
[    0.580679] pci 0000:00:07.0: PME# disabled
[    0.580736] PCI: 0000:00:09.0 reg 10 io port: [30f0, 30f7]
[    0.580741] PCI: 0000:00:09.0 reg 14 io port: [30e4, 30e7]
[    0.580746] PCI: 0000:00:09.0 reg 18 io port: [30e8, 30ef]
[    0.580750] PCI: 0000:00:09.0 reg 1c io port: [30e0, 30e3]
[    0.580755] PCI: 0000:00:09.0 reg 20 io port: [30d0, 30df]
[    0.580760] PCI: 0000:00:09.0 reg 24 32bit mmio: [f6484000, f6485fff]
[    0.580804] PCI: 0000:00:0a.0 reg 10 32bit mmio: [f6488000, f6488fff]
[    0.580809] PCI: 0000:00:0a.0 reg 14 io port: [30f8, 30ff]
[    0.580813] PCI: 0000:00:0a.0 reg 18 32bit mmio: [f6489c00, f6489cff]
[    0.580818] PCI: 0000:00:0a.0 reg 1c 32bit mmio: [f6489800, f648980f]
[    0.580838] pci 0000:00:0a.0: supports D1
[    0.580840] pci 0000:00:0a.0: supports D2
[    0.580843] pci 0000:00:0a.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580848] pci 0000:00:0a.0: PME# disabled
[    0.580881] pci 0000:00:0c.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580884] pci 0000:00:0c.0: PME# disabled
[    0.580914] pci 0000:00:0d.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.580917] pci 0000:00:0d.0: PME# disabled
[    0.580937] PCI: 0000:00:12.0 reg 10 32bit mmio: [f5000000, f5ffffff]
[    0.580942] PCI: 0000:00:12.0 reg 14 32bit mmio: [d0000000, dfffffff]
[    0.580950] PCI: 0000:00:12.0 reg 1c 64bit mmio: [f4000000, f4ffffff]
[    0.580957] PCI: 0000:00:12.0 reg 30 32bit mmio: [0, 1ffff]
[    0.581003] PCI: 0000:02:05.0 reg 10 32bit mmio: [f6100000, f61007ff]
[    0.581003] pci 0000:02:05.0: supports D1
[    0.581003] pci 0000:02:05.0: supports D2
[    0.581003] pci 0000:02:05.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.581003] pci 0000:02:05.0: PME# disabled
[    0.581003] PCI: 0000:02:05.1 reg 10 32bit mmio: [f6100800, f61008ff]
[    0.581003] pci 0000:02:05.1: supports D1
[    0.581003] pci 0000:02:05.1: supports D2
[    0.581003] pci 0000:02:05.1: PME# supported from D0 D1 D2 D3hot D3cold
[    0.581003] pci 0000:02:05.1: PME# disabled
[    0.581003] PCI: 0000:02:05.2 reg 10 32bit mmio: [f6100c00, f6100cff]
[    0.581003] pci 0000:02:05.2: supports D1
[    0.581003] pci 0000:02:05.2: supports D2
[    0.581003] pci 0000:02:05.2: PME# supported from D0 D1 D2 D3hot D3cold
[    0.581003] pci 0000:02:05.2: PME# disabled
[    0.581003] PCI: 0000:02:05.3 reg 10 32bit mmio: [f6101000, f61010ff]
[    0.581003] pci 0000:02:05.3: supports D1
[    0.581003] pci 0000:02:05.3: supports D2
[    0.581003] pci 0000:02:05.3: PME# supported from D0 D1 D2 D3hot D3cold
[    0.581003] pci 0000:02:05.3: PME# disabled
[    0.581003] PCI: 0000:02:05.4 reg 10 32bit mmio: [f6101400, f61014ff]
[    0.581003] pci 0000:02:05.4: supports D1
[    0.581003] pci 0000:02:05.4: supports D2
[    0.581003] pci 0000:02:05.4: PME# supported from D0 D1 D2 D3hot D3cold
[    0.581003] pci 0000:02:05.4: PME# disabled
[    0.581003] pci 0000:00:08.0: transparent bridge
[    0.581003] PCI: bridge 0000:00:08.0 32bit mmio: [f6100000, f61fffff]
[    0.581003] PCI: bridge 0000:00:0c.0 io port: [4000, 4fff]
[    0.581003] PCI: bridge 0000:00:0c.0 32bit mmio: [f2000000, f3ffffff]
[    0.581003] PCI: bridge 0000:00:0c.0 64bit mmio pref: [f0000000, f1ffffff]
[    0.581003] PCI: 0000:03:00.0 reg 10 64bit mmio: [f6000000, f6003fff]
[    0.581003] pci 0000:03:00.0: supports D1
[    0.581003] pci 0000:03:00.0: supports D2
[    0.581003] PCI: bridge 0000:00:0d.0 32bit mmio: [f6000000, f60fffff]
[    0.581003] bus 00 -> node 0
[    0.581003] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0._PRT]
[    0.581003] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P2P0._PRT]
[    0.581003] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.XVR1._PRT]
[    0.581003] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.XVR2._PRT]
[    0.632359] ACPI: PCI Interrupt Link [LNK1] (IRQs 5) *10
[    0.632673] ACPI: PCI Interrupt Link [LNK2] (IRQs 7) *11
[    0.632982] ACPI: PCI Interrupt Link [LNK3] (IRQs 10) *0, disabled.
[    0.633290] ACPI: PCI Interrupt Link [LNK4] (IRQs 11) *0, disabled.
[    0.633598] ACPI: PCI Interrupt Link [LK1E] (IRQs 16) *0, disabled.
[    0.633906] ACPI: PCI Interrupt Link [LK2E] (IRQs 17) *0, disabled.
[    0.634214] ACPI: PCI Interrupt Link [LK3E] (IRQs 18) *0, disabled.
[    0.634523] ACPI: PCI Interrupt Link [LK4E] (IRQs 19) *10
[    0.634830] ACPI: PCI Interrupt Link [LSMB] (IRQs *10)
[    0.635137] ACPI: PCI Interrupt Link [LUS0] (IRQs 18) *11
[    0.635445] ACPI: PCI Interrupt Link [LUS2] (IRQs 22) *7
[    0.635760] ACPI: PCI Interrupt Link [LMAC] (IRQs 20) *11
[    0.636009] ACPI: PCI Interrupt Link [LAZA] (IRQs 21) *10
[    0.636009] ACPI: PCI Interrupt Link [LGPU] (IRQs 16) *10
[    0.636009] ACPI: PCI Interrupt Link [LPID] (IRQs 22) *0, disabled.
[    0.636009] ACPI: PCI Interrupt Link [LSI0] (IRQs 23) *11
[    0.636009] ACPI: PCI Interrupt Link [Z015] (IRQs 18) *5
[    0.636009] ACPI: PCI Interrupt Link [Z016] (IRQs 22) *10
[    0.636009] ACPI: PCI Interrupt Link [LPMU] (IRQs *11)
[    0.636170] Linux Plug and Play Support v0.97 (c) Adam Belay
[    0.636197] pnp: PnP ACPI init
[    0.636197] ACPI: bus type pnp registered
[    0.641483] pnp: PnP ACPI: found 12 devices
[    0.641483] ACPI: ACPI bus type pnp unregistered
[    0.641483] PnPBIOS: Disabled by ACPI PNP
[    0.641483] PCI: Using ACPI for IRQ routing
[    0.644045] NET: Registered protocol family 8
[    0.644048] NET: Registered protocol family 20
[    0.648041] NetLabel: Initializing
[    0.648041] NetLabel:  domain hash size = 128
[    0.648042] NetLabel:  protocols = UNLABELED CIPSOv4
[    0.648057] NetLabel:  unlabeled traffic allowed by default
[    0.648067] hpet0: at MMIO 0xfed00000, IRQs 2, 8, 31
[    0.648073] hpet0: 3 32-bit timers, 25000000 Hz
[    0.649775] tracer: 772 pages allocated for 65536 entries of 48 bytes
[    0.649778]    actual entries 65620
[    0.649923] AppArmor: AppArmor Filesystem Enabled
[    0.649955] ACPI: RTC can wake from S4
[    0.652054] Switched to high resolution mode on CPU 0
[    0.652065] Switched to high resolution mode on CPU 1
[    0.652104] system 00:02: iomem range 0xe0000000-0xefffffff could not be reserved
[    0.652113] system 00:03: ioport range 0x1000-0x107f has been reserved
[    0.652117] system 00:03: ioport range 0x1080-0x10ff has been reserved
[    0.652121] system 00:03: ioport range 0x1400-0x147f has been reserved
[    0.652124] system 00:03: ioport range 0x1480-0x14ff has been reserved
[    0.652128] system 00:03: ioport range 0x1800-0x187f has been reserved
[    0.652132] system 00:03: ioport range 0x1880-0x18ff has been reserved
[    0.652140] system 00:04: ioport range 0x360-0x361 has been reserved
[    0.652144] system 00:04: ioport range 0x4d0-0x4d1 has been reserved
[    0.652158] system 00:0b: iomem range 0xffc00000-0xffffffff could not be reserved
[    0.652162] system 00:0b: iomem range 0xfec00000-0xfec00fff could not be reserved
[    0.652166] system 00:0b: iomem range 0xfee00000-0xfeefffff could not be reserved
[    0.652170] system 00:0b: iomem range 0xfed00000-0xfed00fff has been reserved
[    0.652174] system 00:0b: iomem range 0xfef00000-0xfef00fff has been reserved
[    0.687614] pci 0000:00:08.0: PCI bridge, secondary bus 0000:02
[    0.687617] pci 0000:00:08.0:   IO window: disabled
[    0.687623] pci 0000:00:08.0:   MEM window: 0xf6100000-0xf61fffff
[    0.687627] pci 0000:00:08.0:   PREFETCH window: disabled
[    0.687632] pci 0000:00:0c.0: PCI bridge, secondary bus 0000:04
[    0.687635] pci 0000:00:0c.0:   IO window: 0x4000-0x4fff
[    0.687639] pci 0000:00:0c.0:   MEM window: 0xf2000000-0xf3ffffff
[    0.687643] pci 0000:00:0c.0:   PREFETCH window: 0x000000f0000000-0x000000f1ffffff
[    0.687648] pci 0000:00:0d.0: PCI bridge, secondary bus 0000:03
[    0.687651] pci 0000:00:0d.0:   IO window: disabled
[    0.687655] pci 0000:00:0d.0:   MEM window: 0xf6000000-0xf60fffff
[    0.687658] pci 0000:00:0d.0:   PREFETCH window: disabled
[    0.687670] pci 0000:00:08.0: setting latency timer to 64
[    0.687676] pci 0000:00:0c.0: setting latency timer to 64
[    0.687682] pci 0000:00:0d.0: setting latency timer to 64
[    0.687686] bus: 00 index 0 io port: [0, ffff]
[    0.687689] bus: 00 index 1 mmio: [0, ffffffff]
[    0.687692] bus: 02 index 0 mmio: [0, 0]
[    0.687694] bus: 02 index 1 mmio: [f6100000, f61fffff]
[    0.687697] bus: 02 index 2 mmio: [0, 0]
[    0.687699] bus: 02 index 3 io port: [0, ffff]
[    0.687702] bus: 02 index 4 mmio: [0, ffffffff]
[    0.687705] bus: 04 index 0 io port: [4000, 4fff]
[    0.687708] bus: 04 index 1 mmio: [f2000000, f3ffffff]
[    0.687711] bus: 04 index 2 mmio: [f0000000, f1ffffff]
[    0.687714] bus: 04 index 3 mmio: [0, 0]
[    0.687716] bus: 03 index 0 mmio: [0, 0]
[    0.687719] bus: 03 index 1 mmio: [f6000000, f60fffff]
[    0.687721] bus: 03 index 2 mmio: [0, 0]
[    0.687724] bus: 03 index 3 mmio: [0, 0]
[    0.687738] NET: Registered protocol family 2
[    0.697084] IP route cache hash table entries: 32768 (order: 5, 131072 bytes)
[    0.697408] TCP established hash table entries: 131072 (order: 8, 1048576 bytes)
[    0.698001] TCP bind hash table entries: 65536 (order: 7, 524288 bytes)
[    0.698298] TCP: Hash tables configured (established 131072 bind 65536)
[    0.698302] TCP reno registered
[    0.701124] NET: Registered protocol family 1
[    0.701264] checking if image is initramfs... it is
[    1.521228] Freeing initrd memory: 7987k freed
[    1.521403] Simple Boot Flag at 0x36 set to 0x1
[    1.522836] audit: initializing netlink socket (disabled)
[    1.522851] type=2000 audit(1227829753.520:1): initialized
[    1.529941] highmem bounce pool size: 64 pages
[    1.529948] HugeTLB registered 4 MB page size, pre-allocated 0 pages
[    1.533239] VFS: Disk quotas dquot_6.5.1
[    1.533359] Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
[    1.533504] msgmni has been set to 1763
[    1.533662] io scheduler noop registered
[    1.533666] io scheduler anticipatory registered
[    1.533669] io scheduler deadline registered
[    1.533683] io scheduler cfq registered (default)
[    1.533719] pci 0000:00:00.0: Enabling HT MSI Mapping
[    1.533890] pci 0000:00:07.0: Enabling HT MSI Mapping
[    1.533906] pci 0000:00:08.0: Enabling HT MSI Mapping
[    1.533924] pci 0000:00:09.0: Enabling HT MSI Mapping
[    1.533942] pci 0000:00:0a.0: Enabling HT MSI Mapping
[    1.533959] pci 0000:00:0c.0: Enabling HT MSI Mapping
[    1.533977] pci 0000:00:0d.0: Enabling HT MSI Mapping
[    1.533993] pci 0000:00:12.0: Boot video device
[    1.534153] pcieport-driver 0000:00:0c.0: setting latency timer to 64
[    1.534184] pcieport-driver 0000:00:0c.0: found MSI capability
[    1.534210] pci_express 0000:00:0c.0:pcie00: allocate port service
[    1.534277] pci_express 0000:00:0c.0:pcie03: allocate port service
[    1.534377] pcieport-driver 0000:00:0d.0: setting latency timer to 64
[    1.534406] pcieport-driver 0000:00:0d.0: found MSI capability
[    1.534427] pci_express 0000:00:0d.0:pcie00: allocate port service
[    1.534490] pci_express 0000:00:0d.0:pcie03: allocate port service
[    1.534953] isapnp: Scanning for PnP cards...
[    1.887563] isapnp: No Plug & Play device found
[    1.941567] hpet_resources: 0xfed00000 is busy
[    1.941692] Serial: 8250/16550 driver4 ports, IRQ sharing enabled
[    1.944940] brd: module loaded
[    1.945049] input: Macintosh mouse button emulation as /devices/virtual/input/input0
[    1.945223] PNP: PS/2 Controller [PNP0303:KBC0,PNP0f13:MSE0] at 0x60,0x64 irq 1,12
[    1.972586] serio: i8042 KBD port at 0x60,0x64 irq 1
[    1.972594] serio: i8042 AUX port at 0x60,0x64 irq 12
[    1.973065] mice: PS/2 mouse device common for all mice
[    1.973258] rtc_cmos 00:07: rtc core: registered rtc_cmos as rtc0
[    1.973297] rtc0: alarms up to one year, y3k, hpet irqs
[    1.973463] EISA: Probing bus 0 at eisa.0
[    1.973469] Cannot allocate resource for EISA slot 1
[    1.973475] Cannot allocate resource for EISA slot 3
[    1.973478] Cannot allocate resource for EISA slot 4
[    1.973492] EISA: Detected 0 cards.
[    1.973495] cpuidle: using governor ladder
[    1.973498] cpuidle: using governor menu
[    1.974074] TCP cubic registered
[    1.974106] Using IPI No-Shortcut mode
[    1.974425] PM: Resume from partition /dev/sda2
[    1.974428] PM: Checking hibernation image.
[    1.974446] PM: Error -6 checking image file
[    1.974448] PM: Resume from disk failed.
[    1.974464] registered taskstats version 1
[    1.974623]   Magic number: 0:290:859
[    1.974707] tty ptyse: hash matches
[    1.974800] rtc_cmos 00:07: setting system clock to 2008-11-27 23:49:15 UTC (1227829755)
[    1.974805] BIOS EDD facility v0.16 2004-Jun-25, 0 devices found
[    1.974807] EDD information not available.
[    1.975121] Freeing unused kernel memory: 424k freed
[    1.975198] Write protecting the kernel text: 2576k
[    1.975245] Write protecting the kernel read-only data: 936k
[    1.997057] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input1
[    2.166491] fuse init (API version 7.9)
[    2.243920] ACPI: processor limited to max C-state 1
[    2.244141] ACPI: CPU0 (power states: C1[C1] C2[C2] C3[C3])
[    2.244224] processor ACPI0007:00: registered as cooling_device0
[    2.244229] ACPI: Processor [CPU0] (supports 8 throttling states)
[    2.244329] processor ACPI0007:01: registered as cooling_device1
[    2.247569] ACPI Exception (thermal-0377): AE_OK, No or invalid critical threshold [20080609]
[    2.783565] usbcore: registered new interface driver usbfs
[    2.783594] usbcore: registered new interface driver hub
[    2.791518] usbcore: registered new device driver usb
[    2.818448] ohci_hcd: 2006 August 04 USB 1.1 'Open' Host Controller (OHCI) Driver
[    2.818984] ACPI: PCI Interrupt Link [LUS0] enabled at IRQ 18
[    2.818997] ohci_hcd 0000:00:02.0: PCI INT A -> Link[LUS0] -> GSI 18 (level, low) -> IRQ 18
[    2.819011] ohci_hcd 0000:00:02.0: setting latency timer to 64
[    2.819015] ohci_hcd 0000:00:02.0: OHCI Host Controller
[    2.819074] ohci_hcd 0000:00:02.0: new USB bus registered, assigned bus number 1
[    2.819109] ohci_hcd 0000:00:02.0: irq 18, io mem 0xf6486000
[    2.824544] No dock devices found.
[    2.841644] SCSI subsystem initialized
[    2.878191] usb usb1: configuration #1 chosen from 1 choice
[    2.878225] hub 1-0:1.0: USB hub found
[    2.878238] hub 1-0:1.0: 7 ports detected
[    2.883960] libata version 3.00 loaded.
[    2.984937] ACPI: PCI Interrupt Link [Z015] enabled at IRQ 18
[    2.984945] ohci_hcd 0000:00:04.0: PCI INT A -> Link[Z015] -> GSI 18 (level, low) -> IRQ 18
[    2.984961] ohci_hcd 0000:00:04.0: setting latency timer to 64
[    2.984965] ohci_hcd 0000:00:04.0: OHCI Host Controller
[    2.984998] ohci_hcd 0000:00:04.0: new USB bus registered, assigned bus number 2
[    2.985015] ohci_hcd 0000:00:04.0: irq 18, io mem 0xf6487000
[    3.046221] usb usb2: configuration #1 chosen from 1 choice
[    3.046256] hub 2-0:1.0: USB hub found
[    3.046269] hub 2-0:1.0: 2 ports detected
[    3.257115] ACPI: PCI Interrupt Link [LUS2] enabled at IRQ 22
[    3.257130] ehci_hcd 0000:00:02.1: PCI INT B -> Link[LUS2] -> GSI 22 (level, low) -> IRQ 22
[    3.257145] ehci_hcd 0000:00:02.1: setting latency timer to 64
[    3.257150] ehci_hcd 0000:00:02.1: EHCI Host Controller
[    3.257204] ehci_hcd 0000:00:02.1: new USB bus registered, assigned bus number 3
[    3.257237] ehci_hcd 0000:00:02.1: debug port 1
[    3.257242] ehci_hcd 0000:00:02.1: cache line size of 64 is not supported
[    3.257262] ehci_hcd 0000:00:02.1: irq 22, io mem 0xf6489000
[    3.432059] usb 2-2: new full speed USB device using ohci_hcd and address 2
[    3.441033] ehci_hcd 0000:00:02.1: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004
[    3.441223] usb usb3: configuration #1 chosen from 1 choice
[    3.441256] hub 3-0:1.0: USB hub found
[    3.441267] hub 3-0:1.0: 7 ports detected
[    3.544862] ACPI: PCI Interrupt Link [Z016] enabled at IRQ 22
[    3.544870] ehci_hcd 0000:00:04.1: PCI INT B -> Link[Z016] -> GSI 22 (level, low) -> IRQ 22
[    3.544885] ehci_hcd 0000:00:04.1: setting latency timer to 64
[    3.544889] ehci_hcd 0000:00:04.1: EHCI Host Controller
[    3.544925] ehci_hcd 0000:00:04.1: new USB bus registered, assigned bus number 4
[    3.544955] ehci_hcd 0000:00:04.1: debug port 1
[    3.544961] ehci_hcd 0000:00:04.1: cache line size of 64 is not supported
[    3.544970] ehci_hcd 0000:00:04.1: irq 22, io mem 0xf6489400
[    3.680026] ehci_hcd 0000:00:04.1: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004
[    3.680203] usb usb4: configuration #1 chosen from 1 choice
[    3.680236] hub 4-0:1.0: USB hub found
[    3.680248] hub 4-0:1.0: 2 ports detected
[    3.889339] pata_amd 0000:00:06.0: version 0.3.10
[    3.889391] pata_amd 0000:00:06.0: setting latency timer to 64
[    3.889501] scsi0 : pata_amd
[    3.889626] scsi1 : pata_amd
[    3.890089] ata1: PATA max UDMA/133 cmd 0x1f0 ctl 0x3f6 bmdma 0x30c0 irq 14
[    3.890093] ata2: PATA max UDMA/133 cmd 0x170 ctl 0x376 bmdma 0x30c8 irq 15
[    4.080032] usb 2-2: device not accepting address 2, error -62
[    4.080451] ata1.00: ATAPI: MATSHITADVD-RAM UJ-851S, 1.50, max MWDMA2
[    4.080468] ata1: nv_mode_filter: 0x39f&0x39f->0x39f, BIOS=0x0 (0xc600) ACPI=0x39f (120:600:0x12)
[    4.117391] ata1.00: configured for MWDMA2
[    4.117444] ata2: port disabled. ignoring.
[    4.119278] scsi 0:0:0:0: CD-ROM            MATSHITA DVD-RAM UJ-851S  1.50 PQ: 0 ANSI: 5
[    4.119518] ahci 0000:00:09.0: version 3.0
[    4.120009] ACPI: PCI Interrupt Link [LSI0] enabled at IRQ 23
[    4.120021] ahci 0000:00:09.0: PCI INT A -> Link[LSI0] -> GSI 23 (level, low) -> IRQ 23
[    4.120131] ahci 0000:00:09.0: AHCI 0001.0100 32 slots 4 ports 3 Gbps 0xf impl IDE mode
[    4.120136] ahci 0000:00:09.0: flags: 64bit sntf led clo pmp pio slum part 
[    4.120141] ahci 0000:00:09.0: setting latency timer to 64
[    4.120562] scsi2 : ahci
[    4.120689] scsi3 : ahci
[    4.120788] scsi4 : ahci
[    4.120883] scsi5 : ahci
[    4.121044] ata3: SATA max UDMA/133 abar m8192 at 0xf6484000 port 0xf6484100 irq 221
[    4.121049] ata4: SATA max UDMA/133 abar m8192 at 0xf6484000 port 0xf6484180 irq 221
[    4.121053] ata5: SATA max UDMA/133 abar m8192 at 0xf6484000 port 0xf6484200 irq 221
[    4.121056] ata6: SATA max UDMA/133 abar m8192 at 0xf6484000 port 0xf6484280 irq 221
[    4.136048] hub 2-0:1.0: unable to enumerate USB device on port 2
[    4.376027] usb 4-2: new high speed USB device using ehci_hcd and address 2
[    4.522149] usb 4-2: configuration #1 chosen from 1 choice
[    4.670407] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 300)
[    4.670871] ata3.00: ATA-7: TOSHIBA MK8037GSX, DL232C, max UDMA/100
[    4.670875] ata3.00: 156301488 sectors, multi 16: LBA48 
[    4.671418] ata3.00: configured for UDMA/100
[    5.070398] ata4: SATA link down (SStatus 0 SControl 300)
[    5.470400] ata5: SATA link down (SStatus 0 SControl 300)
[    5.830399] ata6: SATA link down (SStatus 0 SControl 300)
[    5.830533] scsi 2:0:0:0: Direct-Access     ATA      TOSHIBA MK8037GS DL23 PQ: 0 ANSI: 5
[    5.830685] forcedeth: Reverse Engineered nForce ethernet driver. Version 0.61.
[    5.831180] ACPI: PCI Interrupt Link [LMAC] enabled at IRQ 20
[    5.831192] forcedeth 0000:00:0a.0: PCI INT A -> Link[LMAC] -> GSI 20 (level, low) -> IRQ 20
[    5.831197] forcedeth 0000:00:0a.0: setting latency timer to 64
[    6.348821] forcedeth 0000:00:0a.0: ifname eth0, PHY OUI 0x732 @ 1, addr 00:1b:24:58:85:c9
[    6.348827] forcedeth 0000:00:0a.0: highdma pwrctl mgmt timirq lnktim msi desc-v3
[    6.350461] ACPI: PCI Interrupt Link [LNK1] enabled at IRQ 5
[    6.350477] ohci1394 0000:02:05.0: PCI INT A -> Link[LNK1] -> GSI 5 (level, low) -> IRQ 5
[    6.402230] ohci1394: fw-host0: OHCI-1394 1.1 (PCI): IRQ=[5]  MMIO=[f6100000-f61007ff]  Max Packet=[2048]  IR/IT contexts=[4/4]
[    6.409355] ACPI: PCI Interrupt Link [LK4E] enabled at IRQ 19
[    6.409371] b43-pci-bridge 0000:03:00.0: PCI INT A -> Link[LK4E] -> GSI 19 (level, low) -> IRQ 19
[    6.409381] b43-pci-bridge 0000:03:00.0: setting latency timer to 64
[    6.477113] ssb: Sonics Silicon Backplane found on PCI device 0000:03:00.0
[    6.489826] scsi 0:0:0:0: Attached scsi generic sg0 type 5
[    6.489875] scsi 2:0:0:0: Attached scsi generic sg1 type 0
[    6.517242] Driver 'sr' needs updating - please use bus_type methods
[    6.522439] sr0: scsi3-mmc drive: 24x/24x writer dvd-ram cd/rw xa/form2 cdda tray
[    6.522446] Uniform CD-ROM driver Revision: 3.20
[    6.522558] sr 0:0:0:0: Attached scsi CD-ROM sr0
[    6.539202] Driver 'sd' needs updating - please use bus_type methods
[    6.539353] sd 2:0:0:0: [sda] 156301488 512-byte hardware sectors (80026 MB)
[    6.539378] sd 2:0:0:0: [sda] Write Protect is off
[    6.539382] sd 2:0:0:0: [sda] Mode Sense: 00 3a 00 00
[    6.539420] sd 2:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA
[    6.539510] sd 2:0:0:0: [sda] 156301488 512-byte hardware sectors (80026 MB)
[    6.539532] sd 2:0:0:0: [sda] Write Protect is off
[    6.539535] sd 2:0:0:0: [sda] Mode Sense: 00 3a 00 00
[    6.539573] sd 2:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA
[    6.539579]  sda: sda1 sda2
[    6.622337] sd 2:0:0:0: [sda] Attached SCSI disk
[    6.894603] PM: Starting manual resume from disk
[    6.894609] PM: Resume from partition 8:2
[    6.894611] PM: Checking hibernation image.
[    6.894805] PM: Resume from disk failed.
[    6.959334] kjournald starting.  Commit interval 5 seconds
[    6.959359] EXT3-fs: mounted filesystem with ordered data mode.
[    7.693287] ieee1394: Host added: ID:BUS[0-00:1023]  GUID[00241b003e832b00]
[   13.498422] udevd version 124 started
[   14.223606] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
[   14.274394] shpchp: Standard Hot Plug PCI Controller Driver version: 0.4
[   14.504759] ACPI: AC Adapter [ACAD] (on-line)
[   14.532500] input: Power Button (FF) as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input2
[   14.553056] ACPI: Power Button (FF) [PWRF]
[   14.553169] input: Sleep Button (CM) as /devices/LNXSYSTM:00/device:00/PNP0C0E:00/input/input3
[   14.585024] ACPI: Sleep Button (CM) [SLPB]
[   14.585125] input: Lid Switch as /devices/LNXSYSTM:00/device:00/PNP0C0D:00/input/input4
[   14.585602] ACPI: Lid Switch [LID]
[   14.585714] input: Power Button (CM) as /devices/LNXSYSTM:00/device:00/PNP0C0C:00/input/input5
[   14.623543] ACPI: Power Button (CM) [PWRB]
[   14.742577] Linux agpgart interface v0.103
[   14.945643] ACPI: Battery Slot [BAT0] (battery present)
[   14.945961] ACPI: WMI: Mapper loaded
[   15.062284] nvidia: module license 'NVIDIA' taints kernel.
[   15.496829] ACPI: PCI Interrupt Link [LGPU] enabled at IRQ 16
[   15.496845] nvidia 0000:00:12.0: PCI INT A -> Link[LGPU] -> GSI 16 (level, low) -> IRQ 16
[   15.496854] nvidia 0000:00:12.0: setting latency timer to 64
[   15.497222] NVRM: loading NVIDIA UNIX x86 Kernel Module  177.80  Wed Oct  1 14:38:10 PDT 2008
[   15.528295] acpi device:25: registered as cooling_device2
[   15.528600] input: Video Bus as /devices/LNXSYSTM:00/device:00/PNP0A08:00/device:23/input/input6
[   15.557044] ACPI: Video Device [UVGA] (multi-head: yes  rom: no  post: no)
[   15.626753] ricoh-mmc: Ricoh MMC Controller disabling driver
[   15.626757] ricoh-mmc: Copyright(c) Philip Langdale
[   15.629083] ricoh-mmc: Ricoh MMC controller found at 0000:02:05.2 [1180:0843] (rev 12)
[   15.629100] ricoh-mmc: Controller is now disabled.
[   15.686348] sdhci: Secure Digital Host Controller Interface driver
[   15.686353] sdhci: Copyright(c) Pierre Ossman
[   15.725457] sdhci-pci 0000:02:05.1: SDHCI controller found [1180:0822] (rev 22)
[   15.725949] ACPI: PCI Interrupt Link [LNK2] enabled at IRQ 7
[   15.725963] sdhci-pci 0000:02:05.1: PCI INT B -> Link[LNK2] -> GSI 7 (level, low) -> IRQ 7
[   15.731593] mmc0: SDHCI controller on PCI [0000:02:05.1] using PIO
[   15.973127] Linux video capture interface: v2.00
[   16.027340] ieee80211_crypt: registered algorithm 'NULL'
[   16.073516] input: PC Speaker as /devices/platform/pcspkr/input/input7
[   16.448817] uvcvideo: Found UVC 1.00 device HP Webcam (04f2:b015)
[   16.451022] input: HP Webcam as /devices/pci0000:00/0000:00:04.1/usb4/4-2/4-2:1.0/input/input8
[   16.596096] ACPI: PCI Interrupt Link [LAZA] enabled at IRQ 21
[   16.596111] HDA Intel 0000:00:07.0: PCI INT A -> Link[LAZA] -> GSI 21 (level, low) -> IRQ 21
[   16.596148] HDA Intel 0000:00:07.0: setting latency timer to 64
[   16.633056] usbcore: registered new interface driver uvcvideo
[   16.633062] USB Video Class driver (v0.1.0)
[   16.686712] b43-phy0: Broadcom 4311 WLAN found
[   16.755038] phy0: Selected rate control algorithm 'pid'
[   16.904372] Broadcom 43xx driver loaded [ Features: PLR, Firmware-ID: FW13 ]
[   17.034903] Synaptics Touchpad, model: 1, fw: 6.3, id: 0x1a0b1, caps: 0xa04713/0x200000
[   17.111424] input: SynPS/2 Synaptics TouchPad as /devices/platform/i8042/serio1/input/input9
[   18.541074] lp: driver loaded but no devices found
[   18.727715] Adding 1028152k swap on /dev/sda2.  Priority:-1 extents:1 across:1028152k
[   19.281315] EXT3 FS on sda1, internal journal
[   20.519023] type=1505 audit(1227829774.185:2): operation="profile_load" name="/usr/share/gdm/guest-session/Xsession" name2="default" pid=4385
[   20.760102] type=1505 audit(1227829774.428:3): operation="profile_load" name="/usr/lib/cups/backend/cups-pdf" name2="default" pid=4390
[   20.760374] type=1505 audit(1227829774.428:4): operation="profile_load" name="/usr/sbin/cupsd" name2="default" pid=4390
[   20.947133] ip_tables: (C) 2000-2006 Netfilter Core Team
[   21.921984] powernow-k8: Found 1 AMD Athlon(tm) 64 X2 Dual-Core Processor TK-53 processors (2 cpu cores) (version 2.20.00)
[   21.922055] powernow-k8:    0 : fid 0x9 (1700 MHz), vid 0x13
[   21.922060] powernow-k8:    1 : fid 0x8 (1600 MHz), vid 0x14
[   21.922064] powernow-k8:    2 : fid 0x0 (800 MHz), vid 0x1a
[   22.719436] warning: `avahi-daemon' uses 32-bit capabilities (legacy support in use)
[   22.805289] apm: BIOS not found.
[   22.980393] ppdev: user-space parallel port driver
[   25.439058] Bluetooth: Core ver 2.13
[   25.440449] NET: Registered protocol family 31
[   25.440460] Bluetooth: HCI device and connection manager initialized
[   25.440471] Bluetooth: HCI socket layer initialized
[   25.492392] Bluetooth: L2CAP ver 2.11
[   25.492419] Bluetooth: L2CAP socket layer initialized
[   25.501047] Clocksource tsc unstable (delta = -238482515 ns)
[   25.558357] Bluetooth: BNEP (Ethernet Emulation) ver 1.3
[   25.558384] Bluetooth: BNEP filters: protocol multicast
[   25.615618] Bridge firewalling registered
[   25.616041] pan0: Dropping NETIF_F_UFO since no NETIF_F_HW_CSUM feature.
[   25.634853] Bluetooth: RFCOMM socket layer initialized
[   25.636497] Bluetooth: RFCOMM TTY layer initialized
[   25.636509] Bluetooth: RFCOMM ver 1.10
[   25.662497] Bluetooth: SCO (Voice Link) ver 0.6
[   25.662514] Bluetooth: SCO socket layer initialized
[   29.817028] eth0: no link during initialization.
[   30.160604] input: b43-phy0 as /devices/virtual/input/input10
[   30.277068] firmware: requesting b43/ucode13.fw
[   30.381214] firmware: requesting b43/b0g0initvals13.fw
[   30.552046] b43-phy0: Loading firmware version 410.2160 (2007-05-26 15:32:10)
[   30.736777] Registered led device: b43-phy0::tx
[   30.737352] Registered led device: b43-phy0::rx
[   30.737382] Registered led device: b43-phy0::radio
[   30.905398] NET: Registered protocol family 17
[   55.251864] NET: Registered protocol family 10
[   55.253199] lo: Disabled Privacy Extensions
[   55.255043] ADDRCONF(NETDEV_UP): eth0: link is not ready
[   55.256824] ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   57.496418] wlan0: authenticate with AP 00:16:b6:da:36:6b
[   57.509855] wlan0: authenticated
[   57.509879] wlan0: associate with AP 00:16:b6:da:36:6b
[   57.512138] wlan0: RX AssocResp from 00:16:b6:da:36:6b (capab=0x411 status=0 aid=2)
[   57.512154] wlan0: associated
[   57.513036] ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   57.824631] padlock: VIA PadLock not detected.
[   57.883489] CPU0 attaching NULL sched-domain.
[   57.883531] CPU1 attaching NULL sched-domain.
[   57.886306] CPU0 attaching sched-domain:
[   57.886319]  domain 0: span 0-1 level CPU
[   57.886327]   groups: 0 1
[   57.886342] CPU1 attaching sched-domain:
[   57.886347]  domain 0: span 0-1 level CPU
[   57.886353]   groups: 1 0
[   68.333023] wlan0: no IPv6 routers present

