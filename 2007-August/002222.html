<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Updated Status on b43 driver and Fedora 7
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bcm43xx-dev/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20Updated%20Status%20on%20b43%20driver%20and%20Fedora%207&In-Reply-To=%3C46D2F8D2.4080405%40lwfinger.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002217.html">
   <LINK REL="Next"  HREF="002218.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Updated Status on b43 driver and Fedora 7</H1>
    <B>Larry Finger</B> 
    <A HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20Updated%20Status%20on%20b43%20driver%20and%20Fedora%207&In-Reply-To=%3C46D2F8D2.4080405%40lwfinger.net%3E"
       TITLE="Updated Status on b43 driver and Fedora 7">larry.finger at lwfinger.net
       </A><BR>
    <I>Mon Aug 27 18:16:18 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002217.html">Updated Status on b43 driver and Fedora 7
</A></li>
        <LI>Next message: <A HREF="002218.html">Updated Status on b43 driver and Fedora 7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2222">[ date ]</a>
              <a href="thread.html#2222">[ thread ]</a>
              <a href="subject.html#2222">[ subject ]</a>
              <a href="author.html#2222">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ioannis Nousias wrote:
&gt;<i> Larry Finger wrote:
</I>&gt;&gt;<i> Andrig T. Miller wrote:
</I>&gt;&gt;<i>  
</I>&gt;&gt;&gt;<i> I booted a new Fedora kernel this morning, and it loaded the new b43 
</I>&gt;&gt;&gt;<i> driver, and I still had the v4 firmware in /lib/firmware.  The first 
</I>&gt;&gt;&gt;<i> time I connected it connected at 2 Mb/s, versus the 1 Mb/s that it 
</I>&gt;&gt;&gt;<i> used to connect at.  I had needed to reboot a second time for an 
</I>&gt;&gt;&gt;<i> unrelated reason, and when it connected the next time I connected at 
</I>&gt;&gt;&gt;<i> 5 Mb/s, and I have been happily using my internal Broadcom 4318 
</I>&gt;&gt;&gt;<i> wireless networking all day, without issue.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks for all the hard work, it is really paying off!
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It is connecting at 1 Mbs every time, the increases are the natural 
</I>&gt;&gt;<i> ramp-up of the rates. Why it differed from boot to boot is probably a 
</I>&gt;&gt;<i> matter of when you happened to check and how many transmissions 
</I>&gt;&gt;<i> happened before you looked.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If your V4 firmware is still in /lib/firmware, then the Fedora kernel 
</I>&gt;&gt;<i> is a little behind the wireless-dev tree. Once the code that uses the 
</I>&gt;&gt;<i> new naming scheme hits their kernel, your wireless will probably stop 
</I>&gt;&gt;<i> working. Be prepared.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, the new driver is very solid.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Larry
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Bcm43xx-dev mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">Bcm43xx-dev at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">https://lists.berlios.de/mailman/listinfo/bcm43xx-dev</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;<i> It's not that 'solid' on my chipset, at least not the one present in the 
</I>&gt;<i> Fedora kernel. I have a BCM4309 14e4:4324 (rev 02) chipset and it drops 
</I>&gt;<i> connection from time to time with this driver.
</I>&gt;<i> 
</I>&gt;<i> It connects fine at 1Mbps, really quick link establishment, but maybe 
</I>&gt;<i> half an hour later it drops and reconnects again. There are lots of 
</I>&gt;<i> messages in the kernel log, I'm including here what I think is useful:
</I>&gt;<i> 
</I>&gt;<i> this is what I get when it first initialises:
</I>&gt;<i> 
</I>&gt;<i> b43-phy1: Broadcom 4306 WLAN found
</I>&gt;<i> b43-phy1 debug: Found PHY: Analog 1, Type 2, Revision 1
</I>&gt;<i> b43-phy1 debug: Found Radio: Manuf 0x17F, Version 0x2050, Revision 2
</I>&gt;<i> b43-phy1 debug: Radio turned off
</I>&gt;<i> wmaster0: Selected rate control algorithm 'simple'
</I>&gt;<i> b43-phy1 debug: Ignoring unconnected 802.11 core
</I>&gt;<i> b43-phy1 debug: Adding Interface type 2
</I>&gt;<i> b43-phy1 debug: Loading firmware version 351.126 (2006-07-29 05:54:02)
</I>&gt;<i> b43-phy1 debug: Radio turned on
</I>&gt;<i> b43-phy1 debug: Radio enabled by hardware
</I>&gt;<i> b43-phy1 ERROR: bbatt(11) &gt;= size of LO array
</I>&gt;<i> b43-phy1 debug: Chip initialized
</I>&gt;<i> b43-phy1 debug: 30-bit DMA initialized
</I>&gt;<i> b43-wlan: TODO: Incomplete code in keymac_write() at 
</I>&gt;<i> drivers/net/wireless/b43/main
</I>&gt;<i> .c:753 *&lt;---- repeated several times*
</I>&gt;<i> b43-phy1 debug: Wireless interface started
</I>&gt;<i> ADDRCONF(NETDEV_UP): wlan0: link is not ready
</I>&gt;<i> wlan0: Initial auth_alg=0
</I>&gt;<i> wlan0: authenticate with AP 00:30:bd:fe:23:83
</I>&gt;<i> wlan0: RX authentication from 00:30:bd:fe:23:83 (alg=0 transaction=2 
</I>&gt;<i> status=0)
</I>&gt;<i> wlan0: authenticated
</I>&gt;<i> wlan0: associate with AP 00:30:bd:fe:23:83
</I>&gt;<i> wlan0: RX AssocResp from 00:30:bd:fe:23:83 (capab=0x411 status=0 aid=10)
</I>&gt;<i> wlan0: associated
</I>&gt;<i> wlan0: switched to short barker preamble (BSSID=00:30:bd:fe:23:83)
</I>&gt;<i> ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
</I>&gt;<i> 
</I>&gt;<i> when it drops connection I get the following messages in dmesg:
</I>&gt;<i> 
</I>&gt;<i> wlan0: No ProbeResp from current AP 00:30:bd:fe:23:83 - assume out of range
</I>&gt;<i> b43-phy1 debug: Using software based encryption for keyidx: 0, mac: 
</I>&gt;<i> 00:30:bd:fe:23
</I>&gt;<i> :83
</I>&gt;<i> wlan0: No STA entry for own AP 00:30:bd:fe:23:83
</I>&gt;<i> wlan0: No STA entry for own AP 00:30:bd:fe:23:83
</I>&gt;<i> wlan0: No STA entry for own AP 00:30:bd:fe:23:83
</I>&gt;<i> ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
</I>&gt;<i> b43-phy1 debug: Removing Interface type 2
</I>&gt;<i> b43-phy1 ERROR: MAC suspend failed
</I>&gt;<i> b43-phy1 debug: Wireless interface stopped
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0260 (RX) max used slots: 1/64
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0200 (RX) max used slots: 2/64
</I>&gt;<i> b43-phy1 debug: DMA-32 0x02A0 (TX) max used slots: 0/128
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0280 (TX) max used slots: 0/128
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0260 (TX) max used slots: 0/128
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0240 (TX) max used slots: 0/128
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0220 (TX) max used slots: 92/128
</I>&gt;<i> b43-phy1 debug: DMA-32 0x0200 (TX) max used slots: 0/128
</I>&gt;<i> b43-phy1 debug: Radio turned off
</I>&gt;<i> b43-phy1 debug: Radio turned off
</I>&gt;<i> b43-phy1 debug: Adding Interface type 2
</I>&gt;<i> 
</I>&gt;<i> this is the link quality info:
</I>&gt;<i> Bit Rate=1 Mb/s
</I>&gt;<i> Retry min limit:7 RTS thr:off Fragment thr=2346 B
</I>&gt;<i> Link Quality=73/100 Signal level=-56 dBm Noise level=-41 dBm
</I>&gt;<i> Rx invalid nwid:0 Rx invalid crypt:0 Rx invalid frag:0
</I>&gt;<i> Tx excessive retries:0 Invalid misc:0 Missed beacon:0
</I>&gt;<i> 
</I>&gt;<i> is the SNR low? Is that why it drops the connection ? The router sits 3 
</I>&gt;<i> meters away from my laptop, direct sight.
</I>
I'm a little surprised that that device works with b43. From the revisions that are in your mail, I 
would have expected it to use b43legacy. Please send the extract from the dmesg output that looks like

ssb: Core 0 found: ChipCommon (cc 0x800, rev 0x11, vendor 0x4243)
ssb: Core 1 found: IEEE 802.11 (cc 0x812, rev 0x0A, vendor 0x4243)
ssb: Core 2 found: USB 1.1 Host (cc 0x817, rev 0x03, vendor 0x4243)
ssb: Core 3 found: PCI-E (cc 0x820, rev 0x01, vendor 0x4243)

Your noise level is very high and the signal is low. At two meters from the AP, i get Signal 
level=-45 dBm  Noise level=-70 dBm.

The code for the Rev 1 PHY's has the most problems of all the chips. They require more setup by the 
host than do later revisions, and obviously something is wrong. I'm working with my BCM4306/2 to see 
what can be done.

Larry

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002217.html">Updated Status on b43 driver and Fedora 7
</A></li>
	<LI>Next message: <A HREF="002218.html">Updated Status on b43 driver and Fedora 7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2222">[ date ]</a>
              <a href="thread.html#2222">[ thread ]</a>
              <a href="subject.html#2222">[ subject ]</a>
              <a href="author.html#2222">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">More information about the Bcm43xx-dev
mailing list</a><br>
</body></html>
