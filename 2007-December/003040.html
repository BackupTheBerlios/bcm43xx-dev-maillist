<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore to	mutex
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bcm43xx-dev/2007-December/index.html" >
   <LINK REL="made" HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%203/3%5D%20net%3A%20wireless%3A%20bcm43xx%3A%20big_buffer_sem%20semaphore%20to%0A%09mutex&In-Reply-To=%3C20071214110430.983813fd.celejar%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003030.html">
   <LINK REL="Next"  HREF="003048.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore to	mutex</H1>
    <B>Celejar</B> 
    <A HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%203/3%5D%20net%3A%20wireless%3A%20bcm43xx%3A%20big_buffer_sem%20semaphore%20to%0A%09mutex&In-Reply-To=%3C20071214110430.983813fd.celejar%40gmail.com%3E"
       TITLE="[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore to	mutex">celejar at gmail.com
       </A><BR>
    <I>Fri Dec 14 17:04:30 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003030.html">[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore	to	mutex
</A></li>
        <LI>Next message: <A HREF="003048.html">[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore	to	mutex
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3040">[ date ]</a>
              <a href="thread.html#3040">[ thread ]</a>
              <a href="subject.html#3040">[ subject ]</a>
              <a href="author.html#3040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 13 Dec 2007 18:09:26 -0800
Larry Finger &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">larry.finger at lwfinger.net</A>&gt; wrote:

&gt;<i> Michael Buesch wrote:
</I>&gt;<i> &gt; On Friday 14 December 2007 01:05:00 Ray Lee wrote:
</I>&gt;<i> &gt;&gt; Okay, I had to modprobe rfkill-input and rfkill by hand, didn't
</I>&gt;<i> &gt;&gt; realize that. Hopefully that'll be automatic soon. Regardless, upon
</I>&gt;<i> &gt;&gt; doing so, and loading ssb and b43, it sees my card, but is still not
</I>&gt;<i> &gt;&gt; fully functional. iwconfig sees:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; lo        no wireless extensions.
</I>&gt;<i> &gt;&gt; eth0      no wireless extensions.
</I>&gt;<i> &gt;&gt; tun0      no wireless extensions.
</I>&gt;<i> &gt;&gt; eth1      no wireless extensions.
</I>&gt;<i> &gt;&gt; wlan0_rename  IEEE 802.11g  ESSID:&quot;&quot;
</I>&gt;<i> &gt;&gt;           Mode:Managed  Channel:0  Access Point: Not-Associated
</I>&gt;<i> &gt;&gt;           Tx-Power=0 dBm
</I>&gt;<i> &gt;&gt;           Retry min limit:7   RTS thr:off   Fragment thr=2346 B
</I>&gt;<i> &gt;&gt;           Link Quality:0  Signal level:0  Noise level:0
</I>&gt;<i> &gt;&gt;           Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
</I>&gt;<i> &gt;&gt;           Tx excessive retries:0  Invalid misc:0   Missed beacon:0
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; (eth0 is ethernet, eth1 doesn't exist -- usually it's the wireless.)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; `ifconfig` doesn't see eth1 or wlan0_rename.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; What else might I be doing wrong?
</I>&gt;<i> 
</I>&gt;<i> Your udev rules are screwed up. In /etc/udev/rules.d/70-persistent-net.rules, you should have a line 
</I>&gt;<i> that looks like
</I>&gt;<i> 
</I>&gt;<i> SUBSYSTEM==&quot;net&quot;, DRIVERS==&quot;?*&quot;, ATTR{address}==&quot;00:1a:73:6b:28:5a&quot;, ATTR{type}==&quot;1&quot;, NAME=&quot;eth1&quot;
</I>&gt;<i> 
</I>&gt;<i> with the MAC address for your device. You probably have the ATTR{type}==&quot;1&quot; clause missing.
</I>
I have a 4318, which I've been using for some time with ndiswrapper
(bcm43xx doesn't work very well with it, you know and as I've reported
on this list).  I finally decided to take the plunge and try b43, so I
installed 2.6.24-rc4 (vanilla from kernel.org), and began getting
chaos, similar to the OP's.  I pretty much gave up, when I saw your
suggestion that the problem is broken udev rules.  Sure enough, here is
(was) my persistent-net.rules:

# This file was automatically generated by the /lib/udev/write_net_rules
# program, probably run by the persistent-net-generator.rules rules file.
#
# You can modify it, as long as you keep each rule on a single line.
# MAC addresses must be written in lowercase.

# PCI device 0x14e4:0x4318 (bcm43xx)
SUBSYSTEM==&quot;net&quot;, DRIVERS==&quot;?*&quot;, ATTRS{address}==&quot;00:19:7d:06:a5:44&quot;,
NAME=&quot;eth0&quot;

# PCI device 0x14e4:0x170c (b44)
SUBSYSTEM==&quot;net&quot;, DRIVERS==&quot;?*&quot;, ATTRS{address}==&quot;00:16:d4:5e:1e:9c&quot;,
NAME=&quot;eth1&quot;

# PCI device 0x168c:0x0013 (ath_pci)
SUBSYSTEM==&quot;net&quot;, DRIVERS==&quot;?*&quot;, ATTRS{address}==&quot;00:40:f4:e5:07:7e&quot;,
ATTRS{type}==&quot;1&quot;, NAME=&quot;ath0&quot;

The two Broadcom lines (wired and wireless cards builtin to my Acer
Aspire 3690-2672 laptop) don't contain the 'ATTRS{type}==&quot;1&quot;' clause,
while the Atheros line (for a PCMCIA card) does.  Adding the clause to
the Broadcom wireless line fixed the problem, and it now seems to be
working perfectly (no screen flicker, which I had seen with bcm43xx),
so thanks.

My questions:

A)  I have only a very basic understanding of udev; what does that
clause mean?  I couldn't figure it out by googling or looking in the
basic udev docs.

B)  I'm running Debian Sid; I assume the installer wrote the builtin
cards' lines and the running system the subsequently inserted PCMCIA
line.  Is this a bug?  Do you know where I should report it?  I have
never (until my addition of your clause) touched the ruls file.

C)  I wasn't seeing this device naming problem with my old kernels
(2.6.18 - 2.6.22) and bcm43xx / ndiswrapper.  Is this a 2.6.24 thing,
or a b43 thing, or some combination thereof, or something else entirely?

Thanks to you and all the devs for all your Broadcom work!

&gt;<i> Larry
</I>
Celejar
--
mailmin.sourceforge.net - remote access via secure (OpenPGP) email
ssuds.sourceforge.net - A Simple Sudoku Solver and Generator


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003030.html">[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore	to	mutex
</A></li>
	<LI>Next message: <A HREF="003048.html">[PATCH 3/3] net: wireless: bcm43xx: big_buffer_sem semaphore	to	mutex
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3040">[ date ]</a>
              <a href="thread.html#3040">[ thread ]</a>
              <a href="subject.html#3040">[ subject ]</a>
              <a href="author.html#3040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">More information about the Bcm43xx-dev
mailing list</a><br>
</body></html>
