<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> BCM4308 rev 3 owner,	willing to help (want to make an access point)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bcm43xx-dev/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20BCM4308%20rev%203%20owner%2C%0A%09willing%20to%20help%20%28want%20to%20make%20an%20access%20point%29&In-Reply-To=%3Cac542ca00805010436r39003330ge566261568016769%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004008.html">
   <LINK REL="Next"  HREF="004025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>BCM4308 rev 3 owner,	willing to help (want to make an access point)</H1>
    <B>Francis Galiegue</B> 
    <A HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20BCM4308%20rev%203%20owner%2C%0A%09willing%20to%20help%20%28want%20to%20make%20an%20access%20point%29&In-Reply-To=%3Cac542ca00805010436r39003330ge566261568016769%40mail.gmail.com%3E"
       TITLE="BCM4308 rev 3 owner,	willing to help (want to make an access point)">fgaliegue at gmail.com
       </A><BR>
    <I>Thu May  1 13:36:20 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="004008.html">BCM4308 rev 3 owner, willing to help (want to make an access	point)
</A></li>
        <LI>Next message: <A HREF="004025.html">BCM4308 rev 3 owner,	willing to help (want to make an access point)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4011">[ date ]</a>
              <a href="thread.html#4011">[ thread ]</a>
              <a href="subject.html#4011">[ subject ]</a>
              <a href="author.html#4011">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/5/1 Johannes Berg &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">johannes at sipsolutions.net</A>&gt;:

&gt;<i>  &gt;
</I>&gt;<i>  &gt; unencrypted AP --&gt; success;
</I>&gt;<i>  &gt; [WPA] --&gt; segfault
</I>&gt;<i>
</I>&gt;<i>  <A HREF="http://johannes.sipsolutions.net/patches/kernel/all/2008-05-01-00:32/023-mac80211-fix-debugfs-key.patch">http://johannes.sipsolutions.net/patches/kernel/all/2008-05-01-00:32/023-mac80211-fix-debugfs-key.patch</A>
</I>&gt;<i>
</I>
Better, but not there yet... At least now it doesn't segfault.

I ran again hostapd with -d this time. Here is what I get...

----
WPA: group state machine entering state SETKEYSDONE (VLAN-ID 0)
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
wlan0: Setup of interface done.
Wireless event: cmd=0x8b04 len=12
Wireless event: cmd=0x8b1a len=15
&lt;NOTE: all mgmt::proberesp and &quot;MGMT (TX&quot; messages DROPPED from what follows&gt;
&lt;START&gt;
mgmt::auth
authentication: STA=00:15:00:35:12:e0 auth_alg=0 auth_transaction=1
status_code=0 wep=0
  New STA
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: authentication OK (open system)
wlan0: STA 00:15:00:35:12:e0 MLME:
MLME-AUTHENTICATE.indication(00:15:00:35:12:e0, OPEN_SYSTEM)
wlan0: STA 00:15:00:35:12:e0 MLME: MLME-DELETEKEYS.request(00:15:00:35:12:e0)
authentication reply: STA=00:15:00:35:12:e0 auth_alg=0
auth_transaction=2 resp=0 (IE len=0)
mgmt::auth cb
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: authenticated
mgmt::assoc_req
association request: STA=00:15:00:35:12:e0 capab_info=0x411 listen_interval=10
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
  new AID 1
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: association OK (aid 1)
mgmt::assoc_resp cb
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: associated (aid 1,
accounting session 4819A816-00000000)
wlan0: STA 00:15:00:35:12:e0 MLME: MLME-ASSOCIATE.indication(00:15:00:35:12:e0)
wlan0: STA 00:15:00:35:12:e0 MLME: MLME-DELETEKEYS.request(00:15:00:35:12:e0)
wlan0: STA 00:15:00:35:12:e0 WPA: event 1 notification
wlan0: STA 00:15:00:35:12:e0 WPA: start authentication
WPA: 00:15:00:35:12:e0 WPA_PTK entering state INITIALIZE
wlan0: STA 00:15:00:35:12:e0 IEEE 802.1X: unauthorizing port
Could not set station 00:15:00:35:12:e0 flags for kernel driver (errno=22).
WPA: 00:15:00:35:12:e0 WPA_PTK_GROUP entering state IDLE
WPA: 00:15:00:35:12:e0 WPA_PTK entering state AUTHENTICATION
WPA: 00:15:00:35:12:e0 WPA_PTK entering state AUTHENTICATION2
WPA: 00:15:00:35:12:e0 WPA_PTK entering state INITPSK
WPA: 00:15:00:35:12:e0 WPA_PTK entering state PTKSTART
wlan0: STA 00:15:00:35:12:e0 WPA: sending 1/4 msg of 4-Way Handshake
WPA: Send EAPOL(version=1 secure=0 mic=0 ack=1 install=0 pairwise=8
kde_len=0 keyidx=0 encr=0)
IEEE 802.1X: 123 bytes from 00:15:00:35:12:e0
   IEEE 802.1X: version=1 type=3 length=119
wlan0: STA 00:15:00:35:12:e0 WPA: received EAPOL-Key frame (2/4 Pairwise)
WPA: 00:15:00:35:12:e0 WPA_PTK entering state PTKCALCNEGOTIATING
WPA: PTK derivation - A1=00:0c:41:63:9f:a3 A2=00:15:00:35:12:e0
WPA: PMK - hexdump(len=32): 95 5f af d8 0c bf e2 e1 02 7e 13 2a 7b 08
bd ea 52 84 2d a0 d0 ef 10 86 91 d4 e5 8e a4 0e 7e 78
WPA: PTK - hexdump(len=64): 8a 51 b4 9b 0c 1e 4a c7 b6 c1 5d 27 c8 b3
c8 8c 82 0d 1e 97 24 d7 1b 7b 27 8b 4e 4e 3c 30 77 81 04 21 a3 0b 8e
d8 5b 7e 60 be a9 da 78 40 04 e6 17 92 34 e8 c0 5f fd c0 d7 f8 5e 4c
28 b6 e4 47
WPA: 00:15:00:35:12:e0 WPA_PTK entering state PTKCALCNEGOTIATING2
WPA: 00:15:00:35:12:e0 WPA_PTK entering state PTKINITNEGOTIATING
wlan0: STA 00:15:00:35:12:e0 WPA: sending 3/4 msg of 4-Way Handshake
WPA: Send EAPOL(version=1 secure=0 mic=1 ack=1 install=1 pairwise=8
kde_len=24 keyidx=0 encr=0)
IEEE 802.1X: 99 bytes from 00:15:00:35:12:e0
   IEEE 802.1X: version=1 type=3 length=95
wlan0: STA 00:15:00:35:12:e0 WPA: received EAPOL-Key frame (4/4 Pairwise)
WPA: 00:15:00:35:12:e0 WPA_PTK entering state PTKINITDONE
wlan0: STA 00:15:00:35:12:e0 IEEE 802.1X: authorizing port
wlan0: STA 00:15:00:35:12:e0 WPA: pairwise key handshake completed (WPA)
WPA: 00:15:00:35:12:e0 WPA_PTK_GROUP entering state REKEYNEGOTIATING
wlan0: STA 00:15:00:35:12:e0 WPA: sending 1/2 msg of Group Key Handshake
WPA: Send EAPOL(version=1 secure=1 mic=1 ack=1 install=0 pairwise=0
kde_len=32 keyidx=1 encr=1)
Plaintext EAPOL-Key Key Data - hexdump(len=32): 30 96 19 8d ca 89 da
62 6b f2 a5 c1 a6 e6 da a9 42 05 b0 ef f3 92 b7 ae 75 14 e7 1e b7 e6
37 29
IEEE 802.1X: 99 bytes from 00:15:00:35:12:e0
   IEEE 802.1X: version=1 type=3 length=95
wlan0: STA 00:15:00:35:12:e0 WPA: received EAPOL-Key frame (2/2 Group)
WPA: 00:15:00:35:12:e0 WPA_PTK_GROUP entering state REKEYESTABLISHED
wlan0: STA 00:15:00:35:12:e0 WPA: group key handshake completed (WPA)
WPA: 00:15:00:35:12:e0 WPA_PTK_GROUP entering state IDLE
mgmt::disassoc
disassocation: STA=00:15:00:35:12:e0 reason_code=1
wlan0: STA 00:15:00:35:12:e0 WPA: event 2 notification
WPA: 00:15:00:35:12:e0 WPA_PTK entering state DISCONNECTED
WPA: 00:15:00:35:12:e0 WPA_PTK entering state INITIALIZE
wlan0: STA 00:15:00:35:12:e0 IEEE 802.1X: unauthorizing port
Could not set station 00:15:00:35:12:e0 flags for kernel driver (errno=22).
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: disassociated
wlan0: STA 00:15:00:35:12:e0 MLME:
MLME-DISASSOCIATE.indication(00:15:00:35:12:e0, 1)
wlan0: STA 00:15:00:35:12:e0 MLME: MLME-DELETEKEYS.request(00:15:00:35:12:e0)
Sending deauthentication info to STA 00:15:00:35:12:e0
wlan0: STA 00:15:00:35:12:e0 IEEE 802.11: deauthenticated due to inactivity
wlan0: STA 00:15:00:35:12:e0 MLME:
MLME-DEAUTHENTICATE.indication(00:15:00:35:12:e0, 2)
wlan0: STA 00:15:00:35:12:e0 MLME: MLME-DELETEKEYS.request(00:15:00:35:12:e0)
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
&lt;goto START&gt;
----

The WPA negotiation is a success but then the association suddenly
drops, for whatever reason :/


-- 
Francis Galiegue, <A HREF="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">fgaliegue at gmail.com</A>
&quot;It seems obvious [...] that at least some 'business intelligence'
tools invest so much intelligence on the business side that they have
nothing left for generating SQL queries&quot; (St&#233;phane Faroult, in &quot;The
Art of SQL&quot;, ISBN 0-596-00894-5)

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004008.html">BCM4308 rev 3 owner, willing to help (want to make an access	point)
</A></li>
	<LI>Next message: <A HREF="004025.html">BCM4308 rev 3 owner,	willing to help (want to make an access point)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4011">[ date ]</a>
              <a href="thread.html#4011">[ thread ]</a>
              <a href="subject.html#4011">[ subject ]</a>
              <a href="author.html#4011">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">More information about the Bcm43xx-dev
mailing list</a><br>
</body></html>
