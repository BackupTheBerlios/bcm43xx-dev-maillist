<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> opensource firmware now accept version 410 frames
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bcm43xx-dev/2009-February/index.html" >
   <LINK REL="made" HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20opensource%20firmware%20now%20accept%20version%20410%20frames&In-Reply-To=%3C55609C65-F0FE-4793-98E0-615141FE8A39%40ing.unibs.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="005162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>opensource firmware now accept version 410 frames</H1>
    <B>Francesco Gringoli</B> 
    <A HREF="mailto:bcm43xx-dev%40lists.berlios.de?Subject=Re%3A%20opensource%20firmware%20now%20accept%20version%20410%20frames&In-Reply-To=%3C55609C65-F0FE-4793-98E0-615141FE8A39%40ing.unibs.it%3E"
       TITLE="opensource firmware now accept version 410 frames">francesco.gringoli at ing.unibs.it
       </A><BR>
    <I>Sun Feb  1 00:35:01 CET 2009</I>
    <P><UL>
        
        <LI>Next message: <A HREF="005162.html">opensource firmware now accept version 410 frames
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5161">[ date ]</a>
              <a href="thread.html#5161">[ thread ]</a>
              <a href="subject.html#5161">[ subject ]</a>
              <a href="author.html#5161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 30, 2009, at 10:59 PM, Michael Buesch wrote:

&gt;<i> On Friday 30 January 2009 14:22:35 Lorenzo Nava wrote:
</I>&gt;&gt;&gt;<i> I think that's rather unlikely, however. The DMA code is basically  
</I>&gt;&gt;&gt;<i> unchanged
</I>&gt;&gt;&gt;<i> for months and especially the slot handling hasn't changed in years.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, but I didn't mean that the code has some bug. Let's say, for
</I>&gt;&gt;<i> example, that all the DMA slots were filled; when the firmware will
</I>&gt;&gt;<i> try to report a tx status it will send the informations to the DMA.
</I>&gt;&gt;<i> The DMA won't have enough space to store it and so it will drop the
</I>&gt;&gt;<i> message. In your opinion is it possible that something like that
</I>&gt;&gt;<i> happened?
</I>&gt;<i>
</I>&gt;<i> No. TX status isn't passed through DMA in &gt;=rev5 cores.
</I>&gt;<i> It's passed through MMIO registers which access an internal hardware  
</I>&gt;<i> queue.
</I>Michael,

sorry, I have a question, there is a piece of code I do not  
understand. I see from specs that this queue (that is filled by the  
firmware to report status to host) _seems_ to be 16 positions long. I  
would say that this value should be taken as an upper limit in the  
number of frames sent on the dma and still not acked (positively or  
not, depending on tx success) by the firmware. Is this correct? I did  
some tests and I saw that the number of frames sent through   
op32_poke_tx before corresponding status being reported greatly  
exceeds 16.

What am I missing?

Many thanks,
Cheers,
-FG

&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> What looks strange to me is that, if the error is somewhere in the
</I>&gt;&gt;<i> tx_header definition, every transmission will result in an error from
</I>&gt;&gt;<i> the b43_dma_handle_txstatus. If a field is not in the correct
</I>&gt;&gt;<i> position, it is always wrong: it can't be sometimes right and
</I>&gt;&gt;<i> sometimes wrong, don't you agree?
</I>&gt;&gt;<i> I had similar problem beacause of the wrong header offsets
</I>&gt;&gt;<i> definitions, but that made every transmission generate a BUG  
</I>&gt;&gt;<i> report...
</I>&gt;&gt;<i> I don't understand how it is possible that almost always things went
</I>&gt;&gt;<i> fine and sometimes report status was not correct...
</I>&gt;<i>
</I>&gt;<i> Well, you should probably patch the driver to print the cookie when  
</I>&gt;<i> the WARN_ON happens
</I>&gt;<i> and reproduce.
</I>&gt;<i>
</I>&gt;&gt;<i> Please Michael, if you can, can you please check shm.inc header  
</I>&gt;&gt;<i> definition?
</I>&gt;<i>
</I>&gt;<i> Not yet. Maybe later.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> Greetings, Michael.
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="005162.html">opensource firmware now accept version 410 frames
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5161">[ date ]</a>
              <a href="thread.html#5161">[ thread ]</a>
              <a href="subject.html#5161">[ subject ]</a>
              <a href="author.html#5161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bcm43xx-dev">More information about the Bcm43xx-dev
mailing list</a><br>
</body></html>
